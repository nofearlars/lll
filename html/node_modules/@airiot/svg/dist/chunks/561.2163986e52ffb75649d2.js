/*! For license information please see 561.2163986e52ffb75649d2.js.LICENSE.txt */
"use strict";(this.webpackChunk_airiot_svg=this.webpackChunk_airiot_svg||[]).push([[561],{1561:(e,t,n)=>{n.r(t),n.d(t,{default:()=>nn});var r=n(7462),i=n(4942),a=n(885),o=n(7363),s=n.n(o),l=n(2611),u=n.n(l),c=(n(7686),n(3278),n(3078)),d=n(5907),h=n(1002),f=n(2982),m=n(5861),g=n(3144),p=n(5671),v=n(4687),y=n.n(v),A=(n(4645),n(6084)),x=n(603),b=n(7062),S=n(3591),C=n(7865),w=n(6969),E=n(7213),k=n(1176),N=(0,A.Z)(jQuery),_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",M="a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use".split(","),I=null,G=null,B=null,L=null,T=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")};function P(e){if(e=V(e),window.btoa)return window.btoa(e);var t=new Array(4*Math.floor((e.length+2)/3)),n=0,r=0;do{var i=e.charCodeAt(n++),a=e.charCodeAt(n++),o=e.charCodeAt(n++),s=i>>2,l=(3&i)<<4|a>>4,u=(15&a)<<2|o>>6,c=63&o;isNaN(a)?(u=64,c=64):isNaN(o)&&(c=64),t[r++]=_.charAt(s),t[r++]=_.charAt(l),t[r++]=_.charAt(u),t[r++]=_.charAt(c)}while(n<e.length);return t.join("")}function D(e){if(window.atob)return O(window.atob(e));e=e.replace(/[^A-Za-z0-9+/=]/g,"");var t="",n=0;do{var r=_.indexOf(e.charAt(n++)),i=_.indexOf(e.charAt(n++)),a=_.indexOf(e.charAt(n++)),o=_.indexOf(e.charAt(n++)),s=r<<2|i>>4,l=(15&i)<<4|a>>2,u=(3&a)<<6|o;t+=String.fromCharCode(s),64!==a&&(t+=String.fromCharCode(l)),64!==o&&(t+=String.fromCharCode(u))}while(n<e.length);return O(t)}function O(e){return decodeURIComponent(escape(e))}var V=function(e){return unescape(encodeURIComponent(e))},R=function(e){if("undefined"==typeof Uint8Array||"undefined"==typeof Blob||"undefined"==typeof URL||!URL.createObjectURL)return"";for(var t=e.split(","),n=t[0].match(/:(.*?);/)[1],r=atob(t[1]),i=r.length,a=new Uint8Array(i);i--;)a[i]=r.charCodeAt(i);var o=new Blob([a],{type:n});return URL.createObjectURL(o)},j=function(e){return e&&"undefined"!=typeof URL&&URL.createObjectURL?URL.createObjectURL(e):""},F=(function(){if("undefined"==typeof Blob)return"";var e=new Blob(["<html><head><title>SVG-edit</title></head><body>&nbsp;</body></html>"],{type:"text/html"});j(e)}(),function(e){var t,n;e.includes("<svg:svg")&&(e=e.replace(/<(\/?)svg:/g,"<$1").replace("xmlns:svg","xmlns"));try{(n=window.DOMParser?new DOMParser:new window.ActiveXObject("Microsoft.XMLDOM")).async=!1}catch(e){throw new Error("XML Parser could not be instantiated")}try{t=n.loadXML?!!n.loadXML(e)&&n:n.parseFromString(e,"text/xml")}catch(e){throw new Error("Error parsing XML string")}return t}),U=function e(t,n){if(t&&1===t.nodeType){n(t);for(var r=t.childNodes.length;r--;)e(t.childNodes.item(r),n)}},z=function(e){if(e){if(e.startsWith('url("'))return e.substring(5,e.indexOf('"',6));if(e.startsWith("url('"))return e.substring(5,e.indexOf("'",6));if(e.startsWith("url("))return e.substring(4,e.indexOf(")"))}return null},Z=function(e){return e.getAttributeNS(b.NS.XLINK,"href")},W=function(e,t){e.setAttributeNS(b.NS.XLINK,"xlink:href",t)},q=function(){var e=I.getSVGContent(),t=e.getElementsByTagNameNS(b.NS.SVG,"defs");return t.length>0?t=t[0]:(t=e.ownerDocument.createElementNS(b.NS.SVG,"defs"),e.firstChild?e.insertBefore(t,e.firstChild.nextSibling):e.append(t)),t},H=function(e){for(var t=e.pathSegList,n=t.numberOfItems,r=[[],[]],i=t.getItem(0),a=[i.x,i.y],o=function(e,t,n,r){return function(i){return 1-Math.pow(i,3)*a[e]+3-Math.pow(i,2)*i*t[e]+3*(1-i)*Math.pow(i,2)*n[e]+Math.pow(i,3)*r[e]}},s=0;s<n;s++){var l=t.getItem(s);if(void 0!==l.x)if(r[0].push(a[0]),r[1].push(a[1]),l.x1){for(var u=[l.x1,l.y1],c=[l.x2,l.y2],d=[l.x,l.y],h=0;h<2;h++){var f=o(h,u,c,d),m=6*a[h]-12*u[h]+6*c[h],g=-3*a[h]+9*u[h]-9*c[h]+3*d[h],p=3*u[h]-3*a[h];if(0!==g){var v=Math.pow(m,2)-4*p*g;if(!(v<0)){var y=(-m+Math.sqrt(v))/(2*g);y>0&&y<1&&r[h].push(f(y));var A=(-m-Math.sqrt(v))/(2*g);A>0&&A<1&&r[h].push(f(A))}}else{if(0===m)continue;var x=-p/m;x>0&&x<1&&r[h].push(f(x))}}a=d}else r[0].push(l.x),r[1].push(l.y)}var b=Math.min.apply(null,r[0]),S=Math.max.apply(null,r[0])-b,C=Math.min.apply(null,r[1]);return{x:b,y:C,width:S,height:Math.max.apply(null,r[1])-C}};function X(e){if((0,k.bS)())try{return e.getBBox()}catch(e){}var t,n,r=N.data(e,"ref"),i=null;r?(n=N(r).children().clone().attr("visibility","hidden"),N(L).append(n),i=n.filter("line, path")):i=N(e).find("line, path");var a=!1;if(i.length)if(i.each((function(){var e=this.getBBox();e.width&&e.height||(a=!0)})),a){var o=r?n:N(e).children();t=se(o)}else t=e.getBBox();else t=e.getBBox();return r&&n.remove(),t}var K=function(e){var t=e||I.geSelectedElements()[0];if(1!==e.nodeType)return null;var n,r=t.nodeName,i=null;switch(r){case"text":""===t.textContent?(t.textContent="a",i=t.getBBox(),t.textContent=""):t.getBBox&&(i=t.getBBox());break;case"path":(0,k.Hb)()?t.getBBox&&(i=t.getBBox()):i=H(t);break;case"g":case"a":i=X(t);break;default:if("use"===r&&(i=X(t)),"use"===r||"foreignObject"===r&&(0,k.VG)()){if(i||(i=t.getBBox()),!(0,k.VG)()){var a=i,o=a.x,s=a.y;i={width:a.width,height:a.height,x:o+parseFloat(t.getAttribute("x")||0),y:s+parseFloat(t.getAttribute("y")||0)}}}else if(M.includes(r))if(t)try{i=t.getBBox()}catch(e){var l=t.getExtentOfChar(0),u=t.getComputedTextLength();i={x:l.x,y:l.y,width:u,height:l.height}}else{var c=N(t).closest("foreignObject");c.length&&c[0].getBBox&&(i=c[0].getBBox())}}return i&&(i={x:(n=i).x,y:n.y,width:n.width,height:n.height}),i},Y=function(e){var t="";return N.each(e,(function(e,n){var r=(0,a.Z)(n,2),i=r[0],o=r[1];t+=i;for(var s=0;s<o.length;s+=2)t+=o[s]+","+o[s+1]+" "})),t},Q=function(e){var t,n,r,i,a=1.81;switch(e.tagName){case"ellipse":case"circle":var o=n=N(e).attr(["rx","ry","cx","cy"]),s=o.cx,l=o.cy,u=n;r=u.rx,i=u.ry,"circle"===e.tagName&&(r=i=N(e).attr("r")),t=Y([["M",[s-r,l]],["C",[s-r,l-i/a,s-r/a,l-i,s,l-i]],["C",[s+r/a,l-i,s+r,l-i/a,s+r,l]],["C",[s+r,l+i/a,s+r/a,l+i,s,l+i]],["C",[s-r/a,l+i,s-r,l+i/a,s-r,l]],["Z",[]]]);break;case"path":t=e.getAttribute("d");break;case"line":t="M"+(n=N(e).attr(["x1","y1","x2","y2"])).x1+","+n.y1+"L"+n.x2+","+n.y2;break;case"polyline":t="M"+e.getAttribute("points");break;case"polygon":t="M"+e.getAttribute("points")+" Z";break;case"rect":var c=N(e).attr(["rx","ry"]);r=c.rx,i=c.ry;var d=e.getBBox(),h=d.x,f=d.y,m=d.width,g=d.height;a=4-a,t=Y(r||i?[["M",[h,f+i]],["C",[h,f+i/a,h+r/a,f,h+r,f]],["L",[h+m-r,f]],["C",[h+m-r/a,f,h+m,f+i/a,h+m,f+i]],["L",[h+m,f+g-i]],["C",[h+m,f+g-i/a,h+m-r/a,f+g,h+m-r,f+g]],["L",[h+r,f+g]],["C",[h+r/a,f+g,h,f+g-i/a,h,f+g-i]],["L",[h,f+i]],["Z",[]]]:[["M",[h,f]],["L",[h+m,f]],["L",[h+m,f+g]],["L",[h,f+g]],["L",[h,f]],["Z",[]]])}return t},J=function(e){var t={};return N.each(["marker-start","marker-end","marker-mid","filter","clip-path"],(function(){var n=e.getAttribute(this);n&&(t[this]=n)})),t},$=function(e,t,n){var r=t({element:"path",attr:J(e)}),i=e.getAttribute("transform");i&&r.setAttribute("transform",i);var a=e.parentNode;e.nextSibling?e.before(r):a.append(r);var o=Q(e);o?r.setAttribute("d",o):r.remove(),n.resetOrientation(r);var s=!1;try{s=r.getBBox()}catch(e){}return r.remove(),s},ee=function(e,t,n){var r=K(e);if(!r)return null;var i=(0,S.D9)(e),a=ce(i),o=(0,E.Dy)(i);if(a||o){var s=!1;if(function(e,t){var n=e%90;return t||!(n>-.001&&n<.001||n<-89.99||n>89.99)}(a,o))if(["ellipse","path","line","polyline","polygon"].includes(e.tagName))r=s=$(e,t,n);else if("rect"===e.tagName){var l=e.getAttribute("rx"),u=e.getAttribute("ry");(l||u)&&(r=s=$(e,t,n))}if(!s){var c=(0,E.vm)(i).matrix;r=(0,E.D2)(r.x,r.y,r.width,r.height,c).aabox}}return r};function te(e){var t=e.getAttribute("stroke-width");return isNaN(t)||"none"===e.getAttribute("stroke")?0:t/2}var ne,re,ie,ae,oe,se=function(e,t,n){if(!e||!e.length)return!1;var r;if(N.each(e,(function(){r||this.parentNode&&(r=ee(this,t,n))})),void 0===r)return null;var i=r.x+r.width,a=r.y+r.height,o=r.x,s=r.y;if(1===e.length){var l=te(e[0]);o-=l,s-=l,i+=l,a+=l}else N.each(e,(function(e,r){var l=ee(r,t,n);if(l){var u=te(r);o=Math.min(o,l.x-u),s=Math.min(s,l.y-u),1===r.nodeType&&(i=Math.max(i,l.x+l.width+u),a=Math.max(a,l.y+l.height+u))}}));return r.x=o,r.y=s,r.width=i-o,r.height=a-s,r},le=function(e){e||(e=N(I.getSVGContent()).children());var t=[];return N(e).children().each((function(e,n){n.getBBox&&t.push(n)})),t.reverse()},ue=function(e){return e||(e=le()),se(e,I.addSVGElementFromJson,I.pathActions)},ce=function(e,t){if(!e)return 0;for(var n=e.numberOfItems,r=0;r<n;++r){var i=e.getItem(r);if(4===i.type)return t?i.angle*Math.PI/180:i.angle}return 0},de=function(e,t){var n=e||I.getSelectedElements()[0],r=(0,S.D9)(n);return ce(r,t)},he=function(e){return fe(z(e).substr(1))},fe=(0,k.kz)()?function(e){return L.querySelector("#"+e)}:(0,k.h_)()?function(e){return G.evaluate('svg:svg[@id="svgroot"]//svg:*[@id="'+e+'"]',B,(function(){return b.NS.SVG}),9,null).singleNodeValue}:function(e){return N(L).find("[id="+e+"]")[0]},me=function(e,t,n,r){for(var i=0,o=Object.entries(t);i<o.length;i++){var s=(0,a.Z)(o[i],2),l=s[0],u=s[1],c="xml:"===l.substr(0,4)?b.NS.XML:"xlink:"===l.substr(0,6)?b.NS.XLINK:null;c?e.setAttributeNS(c,l,u):r?(0,C.NK)(e,l,u):null==e||e.setAttribute(l,u)}},ge=function(e){var t={"fill-opacity":1,"stop-opacity":1,opacity:1,stroke:"none","stroke-dasharray":"none","stroke-linejoin":"miter","stroke-linecap":"butt","stroke-opacity":1,"stroke-width":1,rx:0,ry:0};"ellipse"===e.nodeName&&(delete t.rx,delete t.ry),Object.entries(t).forEach((function(t){var n=(0,a.Z)(t,2),r=n[0],i=n[1];e.getAttribute(r)===String(i)&&e.removeAttribute(r)}))},pe=function(e){var t=I.getBaseUnit(),n=I.getSnappingStep();return"px"!==t&&(n*=(0,C.X9)()[t]),Math.round(e/n)*n},ve=function(e){N(e).click((function(e){e.preventDefault()}))},ye=function e(t,n){var r=document.createElementNS(t.namespaceURI,t.nodeName);if(N.each(t.attributes,(function(e,t){"-moz-math-font-style"!==t.localName&&r.setAttributeNS(t.namespaceURI,t.nodeName,t.value)})),r.removeAttribute("id"),r.id=n(),(0,k.VG)()&&"path"===t.nodeName){var i=Ke(t);r.setAttribute("d",i)}if(N.each(t.childNodes,(function(t,i){1===i.nodeType&&r.append(e(i,n))})),N(t).data("gsvg"))N(r).data("gsvg",r.firstChild);else if(N(t).data("symbol")){var a=N(t).data("symbol");N(r).data("ref",a).data("symbol",a)}else"image"===r.tagName&&ve(r);return r},Ae=function(e){return null==e},xe=jQuery,be={2:["x","y"],4:["x","y"],6:["x","y","x1","y1","x2","y2"],8:["x","y","x1","y1"],10:["x","y","r1","r2","angle","largeArcFlag","sweepFlag"],12:["x"],14:["y"],16:["x","y","x2","y2"],18:["x","y"]},Se={},Ce=function(e){Object.assign(Se,e.ui)},we=[],Ee=!0,ke={},Ne=null,_e=null,Me=function(e){_e=e,we=[0,"ClosePath"],xe.each(["Moveto","Lineto","CurvetoCubic","CurvetoQuadratic","Arc","LinetoHorizontal","LinetoVertical","CurvetoCubicSmooth","CurvetoQuadraticSmooth"],(function(e,t){we.push(t+"Abs"),we.push(t+"Rel")}))},Ie=function(e,t,n){var r=e.pathSegList;if((0,k.DY)())r.insertItemBefore(t,n);else{for(var i=r.numberOfItems,a=[],o=0;o<i;o++){var s=r.getItem(o);a.push(s)}r.clear();for(var l=0;l<i;l++)l===n&&r.appendItem(t),r.appendItem(a[l])}},Ge=function(e,t){return be[e].map((function(e){return t[e]}))},Be=function(e,t){var n=e.path,r={x:t?t.x:e.item.x,y:t?t.y:e.item.y};n.matrix&&(r=(0,E.DC)(r.x,r.y,n.matrix));var i=_e.getCurrentZoom();return r.x*=i,r.y*=i,r},Le=function(e,t){var n={x:e.x,y:e.y};t.matrix&&(e=(0,E.DC)(n.x,n.y,t.imatrix),n.x=e.x,n.y=e.y);var r=_e.getCurrentZoom();return n.x/=r,n.y/=r,n},Te=function(e,t,n){var r=Pe(),i=fe("pathpointgrip_"+e);if(!i){i=document.createElementNS(b.NS.SVG,"circle");var a={id:"pathpointgrip_"+e,display:"none",r:4,fill:"#0FF",stroke:"#00F","stroke-width":2,cursor:"move",style:"pointer-events:all"};"pathNodeTooltip"in Se&&(a["xlink:title"]=Se.pathNodeTooltip),me(i,a),i=r.appendChild(i),xe("#pathpointgrip_"+e).dblclick((function(){Ne&&Ne.setSegType()}))}return t&&n&&me(i,{cx:t,cy:n,display:"inline"}),i},Pe=function(){var e=fe("pathpointgrip_container");return e||((e=fe("selectorParentGroup").appendChild(document.createElementNS(b.NS.SVG,"g"))).id="pathpointgrip_container"),e},De=function(e){var t=fe("ctrlpointgrip_"+e);if(t)return t;t=document.createElementNS(b.NS.SVG,"circle");var n={id:"ctrlpointgrip_"+e,display:"none",r:4,fill:"#0FF",stroke:"#55F","stroke-width":1,cursor:"move",style:"pointer-events:all"};return"pathCtrlPtTooltip"in Se&&(n["xlink:title"]=Se.pathCtrlPtTooltip),me(t,n),Pe().append(t),t},Oe=function(e){var t=fe("ctrlLine_"+e);return t||(t=document.createElementNS(b.NS.SVG,"line"),me(t,{id:"ctrlLine_"+e,stroke:"#555","stroke-width":1,style:"pointer-events:none"}),Pe().append(t),t)},Ve=function(e){var t=e.item,n=e.index;if(!("x1"in t)||!("x2"in t))return null;var r={};Pe();for(var i=[Ne.segs[n-1].item,t],a=1;a<3;a++){var o=n+"c"+a,s=r["c"+a+"_line"]=Oe(o),l=Be(e,{x:t["x"+a],y:t["y"+a]}),u=Be(e,{x:i[a-1].x,y:i[a-1].y});me(s,{x1:l.x,y1:l.y,x2:u.x,y2:u.y,display:"inline"}),r["c"+a+"_line"]=s;var c=r["c"+a]=De(o);me(c,{cx:l.x,cy:l.y,display:"inline"}),r["c"+a]=c}return r},Re=function(e,t,n,r){var i=r||Ne.elem,a=i["createSVGPathSeg"+we[e]].apply(i,(0,f.Z)(n));if((0,k.o3)())i.pathSegList.replaceItem(a,t);else{for(var o=i.pathSegList,s=o.numberOfItems,l=[],u=0;u<s;u++){var c=o.getItem(u);l.push(c)}o.clear();for(var d=0;d<s;d++)d===t?o.appendItem(a):o.appendItem(l[d])}},je=function(e,t){var n=e.index,r=fe("segline_"+n);if(!r){var i=Pe();r=document.createElementNS(b.NS.SVG,"path"),me(r,{id:"segline_"+n,display:"none",fill:"none",stroke:"#0FF","stroke-width":2,style:"pointer-events:none",d:"M0,0 0,0"}),i.append(r)}if(t){var a=e.prev;if(!a)return r.setAttribute("display","none"),r;var o=Be(a);Re(2,0,[o.x,o.y],r);for(var s=Ge(e.type,e.item),l=0;l<s.length;l+=2){var u=Be(e,{x:s[l],y:s[l+1]});s[l]=u.x,s[l+1]=u.y}Re(e.type,1,s,r)}return r},Fe=function(e,t,n){var r=e.x-n.x,i=e.y-n.y,a=t.x-n.x,o=t.y-n.y;if(!(0===r&&0===i||0===a&&0===o)){var s=Math.sqrt(r*r+i*i),l=Math.sqrt(a*a+o*o),u=_e.getSVGRoot().createSVGPoint(),c=_e.getSVGRoot().createSVGPoint(),d=Math.atan2(i,r),h=Math.atan2(o,a);d<0&&(d+=2*Math.PI),h<0&&(h+=2*Math.PI);var f,m,g=Math.abs(d-h),p=Math.abs(Math.PI-g)/2;return d-h>0?(f=g<Math.PI?d+p:d-p,m=g<Math.PI?h-p:h+p):(f=g<Math.PI?d-p:d+p,m=g<Math.PI?h+p:h-p),u.x=s*Math.cos(f)+n.x,u.y=s*Math.sin(f)+n.y,c.x=l*Math.cos(m)+n.x,c.y=l*Math.sin(m)+n.y,[u,c]}},Ue=function(){function e(t,n){(0,p.Z)(this,e),this.selected=!1,this.index=t,this.item=n,this.type=n.pathSegType,this.ctrlpts=[],this.ptgrip=null,this.segsel=null}return(0,g.Z)(e,[{key:"showCtrlPts",value:function(e){for(var t in this.ctrlpts)({}).hasOwnProperty.call(this.ctrlpts,t)&&this.ctrlpts[t].setAttribute("display",e?"inline":"none")}},{key:"selectCtrls",value:function(e){xe("#ctrlpointgrip_"+this.index+"c1, #ctrlpointgrip_"+this.index+"c2").attr("fill",e?"#0FF":"#EEE")}},{key:"show",value:function(e){this.ptgrip&&(this.ptgrip.setAttribute("display",e?"inline":"none"),this.segsel.setAttribute("display",e?"inline":"none"),this.showCtrlPts(e))}},{key:"select",value:function(e){this.ptgrip&&(this.ptgrip.setAttribute("stroke",e?"#0FF":"#00F"),this.segsel.setAttribute("display",e?"inline":"none"),this.ctrlpts&&this.selectCtrls(e),this.selected=e)}},{key:"addGrip",value:function(){var e,t,n,r;this.ptgrip=(t=(e=this).index,n=Te(t),r=Be(e),me(n,{cx:r.x,cy:r.y,display:"inline"}),n),this.ctrlpts=Ve(this),this.segsel=je(this,!0)}},{key:"update",value:function(e){if(this.ptgrip){var t=Be(this);me(this.ptgrip,{cx:t.x,cy:t.y}),je(this,!0),this.ctrlpts&&(e&&(this.item=Ne.elem.pathSegList.getItem(this.index),this.type=this.item.pathSegType),Ve(this))}}},{key:"move",value:function(e,t){var n=this.item,r=this.ctrlpts?[n.x+=e,n.y+=t,n.x1,n.y1,n.x2+=e,n.y2+=t]:[n.x+=e,n.y+=t];if(Re(this.type,this.index,10===this.type?Ge(this.type,n):r),this.next&&this.next.ctrlpts){var i=this.next.item,a=[i.x,i.y,i.x1+=e,i.y1+=t,i.x2,i.y2];Re(this.next.type,this.next.index,a)}if(this.mate){var o=this.mate.item,s=[o.x+=e,o.y+=t];Re(this.mate.type,this.mate.index,s)}this.update(!0),this.next&&this.next.update(!0)}},{key:"setLinked",value:function(e){var t,n,r;if(2===e){if(n=1,!(t=this.next))return;r=this.item}else{if(n=2,!(t=this.prev))return;r=t.item}var i=t.item;i["x"+n]=r.x+(r.x-this.item["x"+e]),i["y"+n]=r.y+(r.y-this.item["y"+e]);var a=[i.x,i.y,i.x1,i.y1,i.x2,i.y2];Re(t.type,t.index,a),t.update(!0)}},{key:"moveCtrl",value:function(e,t,n){var r=this.item;r["x"+e]+=t,r["y"+e]+=n;var i=[r.x,r.y,r.x1,r.y1,r.x2,r.y2];Re(this.type,this.index,i),this.update(!0)}},{key:"setType",value:function(e,t){Re(e,this.index,t),this.type=e,this.item=Ne.elem.pathSegList.getItem(this.index),this.showCtrlPts(6===e),this.ctrlpts=Ve(this),this.update(!0)}}]),e}(),ze=function(){function e(t){if((0,p.Z)(this,e),!t||"path"!==t.tagName)throw new Error("svgedit.path.Path constructed without a <path> element");this.elem=t,this.segs=[],this.selected_pts=[],Ne=this,this.init()}return(0,g.Z)(e,[{key:"init",value:function(){xe(Pe()).find("*").each((function(){xe(this).attr("display","none")}));var e=this.elem.pathSegList,t=e.numberOfItems;this.segs=[],this.selected_pts=[],this.first_seg=null;for(var n=0;n<t;n++){var r=e.getItem(n),i=new Ue(n,r);i.path=this,this.segs.push(i)}for(var a=this.segs,o=null,s=0;s<t;s++){var l=a[s],u=s+1>=t?null:a[s+1],c=s-1<0?null:a[s-1];if(2===l.type){if(c&&1!==c.type){var d=a[o];d.next=a[o+1],d.next.prev=d,d.addGrip()}o=s}else if(u&&1===u.type)l.next=a[o+1],l.next.prev=l,l.mate=a[o],l.addGrip(),Ae(this.first_seg)&&(this.first_seg=l);else if(u)1!==l.type&&(l.addGrip(),u&&2!==u.type&&(l.next=u,l.next.prev=l));else if(1!==l.type){var h=a[o];h.next=a[o+1],h.next.prev=h,h.addGrip(),l.addGrip(),this.first_seg||(this.first_seg=a[o])}}return this}},{key:"eachSeg",value:function(e){for(var t=this.segs.length,n=0;n<t&&!1!==e.call(this.segs[n],n);n++);}},{key:"addSeg",value:function(e){var t=this.segs[e];if(t.prev){var n,r,i,a=t.prev;switch(t.item.pathSegType){case 4:r=(t.item.x+a.item.x)/2,i=(t.item.y+a.item.y)/2,n=this.elem.createSVGPathSegLinetoAbs(r,i);break;case 6:var o=(a.item.x+t.item.x1)/2,s=(t.item.x1+t.item.x2)/2,l=(t.item.x2+t.item.x)/2,u=(o+s)/2,c=(s+l)/2;r=(u+c)/2;var d=(a.item.y+t.item.y1)/2,h=(t.item.y1+t.item.y2)/2,f=(t.item.y2+t.item.y)/2,m=(d+h)/2,g=(h+f)/2;i=(m+g)/2,n=this.elem.createSVGPathSegCurvetoCubicAbs(r,i,o,d,u,m);var p=[t.item.x,t.item.y,c,g,l,f];Re(t.type,e,p)}Ie(this.elem,n,e)}}},{key:"deleteSeg",value:function(e){var t=this.segs[e],n=this.elem.pathSegList;t.show(!1);var r=t.next;if(t.mate){var i=[r.item.x,r.item.y];Re(2,r.index,i),Re(4,t.index,i),n.removeItem(t.mate.index)}else if(t.prev)n.removeItem(e);else{var a=[r.item.x,r.item.y];Re(2,t.next.index,a),n.removeItem(e)}}},{key:"removePtFromSelection",value:function(e){var t=this.selected_pts.indexOf(e);-1!==t&&(this.segs[e].select(!1),this.selected_pts.splice(t,1))}},{key:"clearSelection",value:function(){this.eachSeg((function(){this.select(!1)})),this.selected_pts=[]}},{key:"storeD",value:function(){this.last_d=this.elem.getAttribute("d")}},{key:"show",value:function(e){return this.eachSeg((function(){this.show(e)})),e&&this.selectPt(this.first_seg.index),this}},{key:"movePts",value:function(e,t){for(var n=this.selected_pts.length;n--;)this.segs[this.selected_pts[n]].move(e,t)}},{key:"moveCtrl",value:function(e,t){var n=this.segs[this.selected_pts[0]];n.moveCtrl(this.dragctrl,e,t),Ee&&n.setLinked(this.dragctrl)}},{key:"setSegType",value:function(e){this.storeD();for(var t,n=this.selected_pts.length;n--;){var r=this.selected_pts[n],i=this.segs[r],a=i.prev;if(a){e||(t="Toggle Path Segment Type",e=6===i.type?4:6),e=Number(e);var o=i.item.x,s=i.item.y,l=a.item.x,u=a.item.y,c=void 0;switch(e){case 6:if(i.olditem){var d=i.olditem;c=[o,s,d.x1,d.y1,d.x2,d.y2]}else{var h=o-l,f=s-u;c=[o,s,l+h/3,u+f/3,o-h/3,s-f/3]}break;case 4:c=[o,s],i.olditem=i.item}i.setType(e,c)}}Ne.endChanges(t)}},{key:"selectPt",value:function(e,t){this.clearSelection(),Ae(e)&&this.eachSeg((function(t){this.prev&&(e=t)})),this.addPtsToSelection(e),t&&(this.dragctrl=t,Ee&&this.segs[e].setLinked(t))}},{key:"update",value:function(){var e=this.elem;return de(e)?(this.matrix=(0,E.Rb)(e),this.imatrix=this.matrix.inverse()):(this.matrix=null,this.imatrix=null),this.eachSeg((function(t){this.item=e.pathSegList.getItem(t),this.update()})),this}},{key:"endChanges",value:function(e){(0,k.VG)()&&_e.resetD(this.elem);var t=new w.ChangeElementCommand(this.elem,{d:this.last_d},e);_e.endChanges({cmd:t,elem:this.elem})}},{key:"addPtsToSelection",value:function(t){var n=this;Array.isArray(t)||(t=[t]),t.forEach((function(e){n.segs[e].ptgrip&&!n.selected_pts.includes(e)&&e>=0&&n.selected_pts.push(e)})),this.selected_pts.sort();var r=this.selected_pts.length,i=[];for(i.length=r;r--;){var a=this.selected_pts[r],o=this.segs[a];o.select(!0),i[r]=o.ptgrip}var s=e.subpathIsClosed(this.selected_pts[0]);_e.addPtsToSelection({grips:i,closedSubpath:s})}}],[{key:"subpathIsClosed",value:function(e){var t=!1;return Ne.eachSeg((function(n){return n<=e||2!==this.type&&(1!==this.type||(t=!0,!1))})),t}}]),e}(),Ze=function(e){var t=ke[e.id];return t||(t=ke[e.id]=new ze(e)),t},We=function(e){e in ke&&delete ke[e]},qe=function(e,t){var n=e-ie,r=t-ae,i=Math.sqrt(n*n+r*r),a=Math.atan2(r,n)+oe;return n=i*Math.cos(a)+ie,r=i*Math.sin(a)+ae,n-=ne,r-=re,i=Math.sqrt(n*n+r*r),a=Math.atan2(r,n)-oe,{x:i*Math.cos(a)+ne,y:i*Math.sin(a)+re}},He=function(){var e=Ne.elem;if(oe=de(e,!0)){var t=Ne.oldbbox;ie=t.x+t.width/2,ae=t.y+t.height/2;var n=K(e);ne=n.x+n.width/2,re=n.y+n.height/2;var r=ne-ie,i=re-ae,a=Math.sqrt(r*r+i*i),o=Math.atan2(i,r)+oe;ne=a*Math.cos(o)+ie,re=a*Math.sin(o)+ae;for(var s=e.pathSegList,l=s.numberOfItems;l;){l-=1;var u=s.getItem(l),c=u.pathSegType;if(1!==c){var d=qe(u.x,u.y),h=[d.x,d.y];if(!Ae(u.x1)&&!Ae(u.x2)){var f=qe(u.x1,u.y1),m=qe(u.x2,u.y2);h.splice(h.length,0,f.x,f.y,m.x,m.y)}Re(c,l,h)}}K(e);var g=_e.getSVGRoot().createSVGTransform(),p=(0,S.D9)(e);g.setRotate(180*oe/Math.PI,ne,re),p.replaceItem(g,0)}},Xe=[0,"z","M","m","L","l","C","c","Q","q","A","a","H","h","V","v","S","s","T","t"],Ke=function(e,t){for(var n=e.pathSegList,r=n.numberOfItems,i=0,a=0,o="",s=null,l=0;l<r;++l){var u=n.getItem(l),c=u.x||0,d=u.y||0,h=u.x1||0,f=u.y1||0,m=u.x2||0,g=u.y2||0,p=u.pathSegType,v=Xe[p]["to"+(t?"Lower":"Upper")+"Case"]();switch(p){case 1:o+="z",s&&!t&&(i=s[0],a=s[1]);break;case 12:c-=i;case 13:t?(i+=c,v="l"):(i=c+=i,v="L"),o+=Ye(v,[[c,a]]);break;case 14:d-=a;case 15:t?(a+=d,v="l"):(a=d+=a,v="L"),o+=Ye(v,[[i,d]]);break;case 2:case 4:case 18:c-=i,d-=a;case 5:case 3:case 19:t?(i+=c,a+=d):(i=c+=i,a=d+=a),2!==p&&3!==p||(s=[i,a]),o+=Ye(v,[[c,d]]);break;case 6:c-=i,h-=i,m-=i,d-=a,f-=a,g-=a;case 7:t?(i+=c,a+=d):(h+=i,m+=i,f+=a,g+=a,i=c+=i,a=d+=a),o+=Ye(v,[[h,f],[m,g],[c,d]]);break;case 8:c-=i,h-=i,d-=a,f-=a;case 9:t?(i+=c,a+=d):(h+=i,f+=a,i=c+=i,a=d+=a),o+=Ye(v,[[h,f],[c,d]]);break;case 10:c-=i,d-=a;case 11:t?(i+=c,a+=d):(i=c+=i,a=d+=a),o+=Ye(v,[[u.r1,u.r2]],[u.angle,u.largeArcFlag?1:0,u.sweepFlag?1:0],[c,d]);break;case 16:c-=i,m-=i,d-=a,g-=a;case 17:t?(i+=c,a+=d):(m+=i,g+=a,i=c+=i,a=d+=a),o+=Ye(v,[[m,g],[c,d]])}}return o};function Ye(e,t,n,r){xe.each(t,(function(e,n){t[e]=(0,C.LX)(n)}));var i=e+t.join(" ");return n&&(i+=" "+n.join(" ")),r&&(i+=" "+(0,C.LX)(r)),i}var Qe,Je,$e,et,tt,nt=($e=!1,et=null,tt=!1,{mouseDown:function(e,t,n,r){var i;if("path"!==_e.getCurrentMode()){if(Ne){var a;if(Ne.storeD(),"pathpointgrip_"===(i=e.target.id).substr(0,14)){a=Ne.cur_pt=parseInt(i.substr(14)),Ne.dragging=[n,r];var o=Ne.segs[a];e.shiftKey?o.selected?Ne.removePtFromSelection(a):Ne.addPtsToSelection(a):((Ne.selected_pts.length<=1||!o.selected)&&Ne.clearSelection(),Ne.addPtsToSelection(a))}else if(i.startsWith("ctrlpointgrip_")){Ne.dragging=[n,r];var s=i.split("_")[1].split("c");a=Number(s[0]);var l=Number(s[1]);Ne.selectPt(a,l)}if(!Ne.dragging){var u=_e.getRubberBox();Ae(u)&&(u=_e.setRubberBox(_e.selectorManager.getRubberBandBox()));var c=_e.getCurrentZoom();me(u,{x:n*c,y:r*c,width:0,height:0,display:"inline"})}}}else{var d=n,h=r,f=_e.getCurrentZoom(),m=d/f,g=h/f,p=fe("path_stretch_line");Qe=[m,g],_e.getGridSnapping()&&(m=pe(m),g=pe(g),d=pe(d),h=pe(h)),p||(p=document.createElementNS(b.NS.SVG,"path"),me(p,{id:"path_stretch_line",stroke:"#22C","stroke-width":"0.5",fill:"none"}),p=fe("selectorParentGroup").appendChild(p)),p.setAttribute("display","inline");var v,y=_e.getDrawnPath();if(y){for(var A=y.pathSegList,x=A.numberOfItems,S=6/f,C=!1;x;){x--;var w=A.getItem(x),k=w.x,N=w.y;if(m>=k-S&&m<=k+S&&g>=N-S&&g<=N+S){C=!0;break}}i=_e.getId(),We(i);var _,M,I=fe(i),G=A.numberOfItems;if(C){if(x<=1&&G>=2){var B=A.getItem(0).x,L=A.getItem(0).y;_=4===(M=p.pathSegList.getItem(1)).pathSegType?y.createSVGPathSegLinetoAbs(B,L):y.createSVGPathSegCurvetoCubicAbs(B,L,M.x1/f,M.y1/f,B,L);var T=y.createSVGPathSegClosePath();A.appendItem(_),A.appendItem(T)}else if(G<3)return!1;if(xe(p).remove(),_e.setDrawnPath(null),_e.setStarted(!1),$e){Ne.matrix&&_e.remapElement(I,{},Ne.matrix.inverse());var P=I.getAttribute("d"),D=xe(Ne.elem).attr("d");return xe(Ne.elem).attr("d",D+P),xe(I).remove(),Ne.matrix&&He(),Me(),nt.toEditMode(Ne.elem),Ne.selectPt(),!1}}else{if(!xe.contains(_e.getContainer(),_e.getMouseTarget(e)))return!1;var O=y.pathSegList.numberOfItems,V=y.pathSegList.getItem(O-1),R=V.x,j=V.y;if(e.shiftKey){var F=(0,E.lG)(R,j,m,g);m=F.x,g=F.y}_=4===(M=p.pathSegList.getItem(1)).pathSegType?y.createSVGPathSegLinetoAbs(_e.round(m),_e.round(g)):y.createSVGPathSegCurvetoCubicAbs(_e.round(m),_e.round(g),M.x1/f,M.y1/f,M.x2/f,M.y2/f),y.pathSegList.appendItem(_),m*=f,g*=f,p.setAttribute("d",["M",m,g,m,g].join(" ")),v=O,$e&&(v+=Ne.segs.length),Te(v,m,g)}}else{var U="M"+m+","+g+" ";_e.setDrawnPath(_e.addSVGElementFromJson({element:"path",curStyles:!0,attr:{d:U,id:_e.getNextId(),opacity:_e.getOpacity()}})),p.setAttribute("d",["M",d,h,d,h].join(" ")),v=$e?Ne.segs.length:0,Te(v,d,h)}}},mouseMove:function(e,t){var n=_e.getCurrentZoom();tt=!0;var r=_e.getDrawnPath();if("path"!==_e.getCurrentMode())if(Ne.dragging){var i=Le({x:Ne.dragging[0],y:Ne.dragging[1]},Ne),a=Le({x:e,y:t},Ne),o=a.x-i.x,s=a.y-i.y;Ne.dragging=[e,t],Ne.dragctrl?Ne.moveCtrl(o,s):Ne.movePts(o,s)}else Ne.selected_pts=[],Ne.eachSeg((function(e){var t=this;if(t.next||t.prev){var n=_e.getRubberBox().getBBox(),r=Be(t),i={x:r.x,y:r.y,width:0,height:0},a=(0,E.$D)(n,i);this.select(a),a&&Ne.selected_pts.push(t.index)}}));else{if(!r)return;var l=r.pathSegList,u=l.numberOfItems-1;if(Qe){var c=De("1c1"),d=De("0c2");c.setAttribute("cx",e),c.setAttribute("cy",t),c.setAttribute("display","inline");var h=Qe[0],f=Qe[1],m=h+(h-e/n),g=f+(f-t/n);d.setAttribute("cx",m*n),d.setAttribute("cy",g*n),d.setAttribute("display","inline");var p=Oe(1);if(me(p,{x1:e,y1:t,x2:m*n,y2:g*n,display:"inline"}),0===u)Je=[e,t];else{var v=l.getItem(u-1),y=v.x,A=v.y;6===v.pathSegType?(y+=y-v.x2,A+=A-v.y2):Je&&(y=Je[0]/n,A=Je[1]/n),Re(6,u,[h,f,y,A,m,g],r)}}else{var x=fe("path_stretch_line");if(x){var b=l.getItem(u);if(6===b.pathSegType){var S=b.x+(b.x-b.x2),C=b.y+(b.y-b.y2);Re(6,1,[e,t,S*n,C*n,e,t],x)}else Je?Re(6,1,[e,t,Je[0],Je[1],e,t],x):Re(4,1,[e,t],x)}}}},mouseUp:function(e,t,n,r){var i=_e.getDrawnPath();if("path"===_e.getCurrentMode())return Qe=null,i||(t=fe(_e.getId()),_e.setStarted(!1),Je=null),{keep:!0,element:t};var a=_e.getRubberBox();if(Ne.dragging){var o=Ne.cur_pt;Ne.dragging=!1,Ne.dragctrl=!1,Ne.update(),tt&&Ne.endChanges("Move path point(s)"),e.shiftKey||tt||Ne.selectPt(o)}else a&&"none"!==a.getAttribute("display")?(a.setAttribute("display","none"),a.getAttribute("width")<=2&&a.getAttribute("height")<=2&&nt.toSelectMode(e.target)):nt.toSelectMode(e.target);tt=!1},toEditMode:function(e){Ne=Ze(e),_e.setCurrentMode("pathedit"),_e.clearSelection(),Ne.show(!0).update(),Ne.oldbbox=K(Ne.elem),$e=!1},toSelectMode:function(e){var t=e===Ne.elem;_e.setCurrentMode("select"),Ne.show(!1),et=!1,_e.clearSelection(),Ne.matrix&&He(),t&&(_e.call("selected",[e]),_e.addToSelection([e],!0))},addSubPath:function(e){e?(_e.setCurrentMode("path"),$e=!0):(nt.clear(!0),nt.toEditMode(Ne.elem))},getCurrentPath:function(){return et},select:function(e,t){et===e||t?(nt.toEditMode(e),_e.setCurrentMode("pathedit")):et=e},reorient:function(){var e=_e.getSelectedElements()[0];if(e&&0!==de(e)){var t=new w.BatchCommand("Reorient path"),n={d:e.getAttribute("d"),transform:e.getAttribute("transform")};t.addSubCommand(new w.ChangeElementCommand(e,n)),_e.clearSelection(),this.resetOrientation(e),_e.addCommandToHistory(t),Ze(e).show(!1).matrix=null,this.clear(),_e.addToSelection([e],!0),_e.call("changed",_e.getSelectedElements())}},clear:function(e){var t=_e.getDrawnPath();if(et=null,t){var n=fe(_e.getId());xe(fe("path_stretch_line")).remove(),xe(n).remove(),xe(fe("pathpointgrip_container")).find("*").attr("display","none"),Je=null,_e.setDrawnPath(null),_e.setStarted(!1)}else"pathedit"===_e.getCurrentMode()&&this.toSelectMode();Ne&&Ne.init().show(!1)},resetOrientation:function(e){if(Ae(e)||"path"!==e.nodeName)return!1;var t=(0,S.D9)(e),n=(0,E.vm)(t).matrix;t.clear(),e.removeAttribute("transform");for(var r=e.pathSegList,i=r.numberOfItems,a=function(){var t=r.getItem(o),i=t.pathSegType;if(1===i)return"continue";var a=[];xe.each(["",1,2],(function(e,r){var i=t["x"+r],o=t["y"+r];if(void 0!==i&&void 0!==o){var s=(0,E.DC)(i,o,n);a.splice(a.length,0,s.x,s.y)}})),Re(i,o,a,e)},o=0;o<i;++o)a();!function(e,t){for(var n=K(e),r=0;r<2;r++){var i=0===r?"fill":"stroke",a=e.getAttribute(i);if(a&&a.startsWith("url(")){var o=he(a);if("linearGradient"===o.tagName){var s=o.getAttribute("x1")||0,l=o.getAttribute("y1")||0,u=o.getAttribute("x2")||1,c=o.getAttribute("y2")||0;s=n.width*s+n.x,l=n.height*l+n.y,u=n.width*u+n.x,c=n.height*c+n.y;var d=(0,E.DC)(s,l,t),h=(0,E.DC)(u,c,t),f={x1:(d.x-n.x)/n.width,y1:(d.y-n.y)/n.height,x2:(h.x-n.x)/n.width,y2:(h.y-n.y)/n.height},m=o.cloneNode(!0);xe(m).attr(f),m.id=_e.getNextId(),q().append(m),e.setAttribute(i,"url(#"+m.id+")")}}}}(e,n)},zoomChange:function(){"pathedit"===_e.getCurrentMode()&&Ne.update()},getNodePoint:function(){var e=Ne.selected_pts.length?Ne.selected_pts[0]:1,t=Ne.segs[e];return{x:t.item.x,y:t.item.y,type:t.type}},linkControlPoints:function(e){Ee=e},clonePathNode:function(){Ne.storeD();for(var e=Ne.selected_pts,t=e.length,n=[];t--;){var r=e[t];Ne.addSeg(r),n.push(r+t),n.push(r+t+1)}Ne.init().addPtsToSelection(n),Ne.endChanges("Clone path node(s)")},opencloseSubPath:function(){var e=Ne.selected_pts;if(1===e.length){var t,n,r=Ne.elem,i=r.pathSegList,a=e[0],o=null,s=null;if(Ne.eachSeg((function(e){return 2===this.type&&e<=a&&(s=this.item),e<=a||(2===this.type?(o=e,!1):1!==this.type||(o=!1,!1))})),Ae(o)&&(o=Ne.segs.length-1),!1!==o){var l=r.createSVGPathSegLinetoAbs(s.x,s.y),u=r.createSVGPathSegClosePath();return o===Ne.segs.length-1?(i.appendItem(l),i.appendItem(u)):(Ie(r,u,o),Ie(r,l,o)),void Ne.init().selectPt(o+1)}if(Ne.segs[a].mate)return i.removeItem(a),i.removeItem(a),void Ne.init().selectPt(a-1);for(var c=0;c<i.numberOfItems;c++){var d=i.getItem(c);if(2===d.pathSegType)t=c;else if(c===a)i.removeItem(t);else if(1===d.pathSegType&&a<c){n=c-1,i.removeItem(c);break}}for(var h=a-t-1;h--;)Ie(r,i.getItem(t),n);var f=i.getItem(t);Re(2,t,[f.x,f.y]),Ne.init().selectPt(0)}},deletePathNode:function(){if(nt.canDeleteNodes){Ne.storeD();for(var e=Ne.selected_pts,t=e.length;t--;){var n=e[t];Ne.deleteSeg(n)}if(function e(){var t=Ne.elem.pathSegList,n=t.numberOfItems,r=function(e,n){for(;n--;)t.removeItem(e)};if(n<=1)return!0;for(;n--;){var i=t.getItem(n);if(1===i.pathSegType){var a=t.getItem(n-1),o=t.getItem(n-2);if(2===a.pathSegType){r(n-1,2),e();break}if(2===o.pathSegType){r(n-2,3),e();break}}else if(2===i.pathSegType&&n>0){var s=t.getItem(n-1).pathSegType;if(2===s){r(n-1,1),e();break}if(1===s&&t.numberOfItems-1===n){r(n,1),e();break}}}return!1}(),Ne.elem.pathSegList.numberOfItems<=1)return nt.toSelectMode(Ne.elem),void _e.canvas.deleteSelectedElements();if(Ne.init(),Ne.clearSelection(),window.opera){var r=xe(Ne.elem);r.attr("d",r.attr("d"))}Ne.endChanges("Delete path node(s)")}},smoothPolylineIntoPath:function(e){var t,n=e.points,r=n.numberOfItems;if(r>=4){var i=n.getItem(0),a=null,o=[];for(o.push(["M",i.x,",",i.y," C"].join("")),t=1;t<=r-4;t+=3){var s=n.getItem(t),l=n.getItem(t+1),u=n.getItem(t+2);if(a){var c=Fe(a,s,i);if(c&&2===c.length){var d=o[o.length-1].split(",");d[2]=c[0].x,d[3]=c[0].y,o[o.length-1]=d.join(","),s=c[1]}}o.push([s.x,s.y,l.x,l.y,u.x,u.y].join(",")),i=u,a=l}for(o.push("L");t<r;){var h=n.getItem(t);o.push([h.x,h.y].join(",")),t++}o=o.join(" "),e=_e.addSVGElementFromJson({element:"path",curStyles:!0,attr:{id:_e.getId(),d:o,fill:"none"}})}return e},setSegType:function(e){Ne.setSegType(e)},moveNode:function(e,t){var n=Ne.selected_pts;if(n.length){Ne.storeD();var r=Ne.segs[n[0]],i={x:0,y:0};i[e]=t-r.item[e],r.move(i.x,i.y),Ne.endChanges("Move path point")}},fixEnd:function(e){for(var t,n=e.pathSegList,r=n.numberOfItems,i=0;i<r;++i){var a=n.getItem(i);if(2===a.pathSegType&&(t=a),1===a.pathSegType){var o=n.getItem(i-1);if(o.x!==t.x||o.y!==t.y){var s=e.createSVGPathSegLinetoAbs(t.x,t.y);Ie(e,s,i),nt.fixEnd(e);break}}}(0,k.VG)()&&_e.resetD(e)},convertPath:Ke}),rt=n(4232),it=n(4188),at=jQuery,ot="a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use".split(","),st=0,lt=[];function ut(e){return e||new it.Z(dt.undoMgr)}function ct(e){for(var t=1;e.includes("Layer "+t);)t++;return"Layer "+t}var dt,ht=function(){function e(t,n){if((0,p.Z)(this,e),!t||!t.tagName||!t.namespaceURI||"svg"!==t.tagName||t.namespaceURI!==b.NS.SVG)throw new Error("Error: svgedit.draw.Drawing instance initialized without a <svg> element");this.svgElem_=t,this.obj_num=0,this.idPrefix=n||"svg_",this.releasedNums=[],this.all_layers=[],this.layer_map={},this.current_layer=null,this.nonce_="";var r=this.svgElem_.getAttributeNS(b.NS.SE,"nonce");r&&2!==st?this.nonce_=r:1===st&&this.setNonce(Math.floor(100001*Math.random()))}return(0,g.Z)(e,[{key:"getElem_",value:function(e){return this.svgElem_.querySelector?this.svgElem_.querySelector("#"+e):at(this.svgElem_).find("[id="+e+"]")[0]}},{key:"getSvgElem",value:function(){return this.svgElem_}},{key:"getNonce",value:function(){return this.nonce_}},{key:"setNonce",value:function(e){this.svgElem_.setAttributeNS(b.NS.XMLNS,"xmlns:se",b.NS.SE),this.svgElem_.setAttributeNS(b.NS.SE,"se:nonce",e),this.nonce_=e}},{key:"clearNonce",value:function(){this.nonce_=""}},{key:"getId",value:function(){return this.nonce_?this.idPrefix+this.nonce_+"_"+this.obj_num:this.idPrefix+this.obj_num}},{key:"getNextId",value:function(){var e=this.obj_num,t=!1;this.releasedNums.length>0?(this.obj_num=this.releasedNums.pop(),t=!0):this.obj_num++;for(var n=this.getId();this.getElem_(n);)t&&(this.obj_num=e,t=!1),this.obj_num++,n=this.getId();return t&&(this.obj_num=e),n}},{key:"releaseId",value:function(e){var t=this.idPrefix+(this.nonce_?this.nonce_+"_":"");if("string"!=typeof e||!e.startsWith(t))return!1;var n=Number.parseInt(e.substr(t.length));return!("number"!=typeof n||n<=0||this.releasedNums.includes(n)||(this.releasedNums.push(n),0))}},{key:"getNumLayers",value:function(){return this.all_layers.length}},{key:"hasLayer",value:function(e){return void 0!==this.layer_map[e]}},{key:"getLayerName",value:function(e){return e>=0&&e<this.getNumLayers()?this.all_layers[e].getName():""}},{key:"getCurrentLayer",value:function(){return this.current_layer?this.current_layer.getGroup():null}},{key:"getLayerByName",value:function(e){var t=this.layer_map[e];return t?t.getGroup():null}},{key:"getCurrentLayerName",value:function(){return this.current_layer?this.current_layer.getName():""}},{key:"setCurrentLayerName",value:function(e,t){var n=null;if(this.current_layer){var r=this.current_layer.getName();(n=this.current_layer.setName(e,t))&&(delete this.layer_map[r],this.layer_map[n]=this.current_layer)}return n}},{key:"setCurrentLayerPosition",value:function(e){var t,n=this.getNumLayers();if(!this.current_layer||e<0||e>=n)return null;for(t=0;t<n&&this.all_layers[t]!==this.current_layer;++t);if(t===n)return null;if(t!==e){var r=this.current_layer.getGroup(),i=r.nextSibling,a=null;return e>t?e<n-1&&(a=this.all_layers[e+1].getGroup()):a=this.all_layers[e].getGroup(),this.svgElem_.insertBefore(r,a),this.identifyLayers(),this.setCurrentLayer(this.getLayerName(e)),{currentGroup:r,oldNextSibling:i}}return null}},{key:"mergeLayer",value:function(e){var t=this.current_layer.getGroup(),n=at(t).prev()[0];if(n){e.startBatchCommand("Merge Layer");var r=t.nextSibling;for(e.removeElement(t,r,this.svgElem_);t.firstChild;){var i=t.firstChild;if("title"!==i.localName){var a=i.nextSibling;n.append(i),e.moveElement(i,a,t)}else e.removeElement(i,i.nextSibling,t),i.remove()}this.current_layer.removeGroup();var o=this.all_layers.indexOf(this.current_layer);if(o>0){var s=this.current_layer.getName();this.current_layer=this.all_layers[o-1],this.all_layers.splice(o,1),delete this.layer_map[s]}e.endBatchCommand()}}},{key:"mergeAllLayers",value:function(e){for(this.current_layer=this.all_layers[this.all_layers.length-1],e.startBatchCommand("Merge all Layers");this.all_layers.length>1;)this.mergeLayer(e);e.endBatchCommand()}},{key:"setCurrentLayer",value:function(e){var t=this.layer_map[e];return!!t&&(this.current_layer&&this.current_layer.deactivate(),this.current_layer=t,this.current_layer.activate(),!0)}},{key:"deleteCurrentLayer",value:function(){if(this.current_layer&&this.getNumLayers()>1){var e=this.current_layer.removeGroup();return this.identifyLayers(),e}return null}},{key:"identifyLayers",value:function(){this.all_layers=[],this.layer_map={};for(var e,t=this.svgElem_.childNodes.length,n=[],r=[],i=null,a=!1,o=0;o<t;++o){var s=this.svgElem_.childNodes.item(o);if(s&&1===s.nodeType)if("g"===s.tagName){a=!0;var l=at("title",e=s).text()||((0,k.f0)()&&e.querySelectorAll?at(e.querySelectorAll("title")).text():"");l?(r.push(l),i=new rt.Z(l,s),this.all_layers.push(i),this.layer_map[l]=i):n.push(s)}else ot.includes(s.nodeName)&&n.push(s)}n.length>0||!a?((i=new rt.Z(ct(r),null,this.svgElem_)).appendChildren(n),this.all_layers.push(i),this.layer_map[name]=i):i.activate(),this.current_layer=i}},{key:"createLayer",value:function(e,t){this.current_layer&&this.current_layer.deactivate(),(null==e||""===e||this.layer_map[e])&&(e=ct(Object.keys(this.layer_map)));var n=new rt.Z(e,null,this.svgElem_);return t&&(t.startBatchCommand("Create Layer"),t.insertElement(n.getGroup()),t.endBatchCommand()),this.all_layers.push(n),this.layer_map[e]=n,this.current_layer=n,n.getGroup()}},{key:"cloneLayer",value:function(e,t){var n=this;if(!this.current_layer)return null;this.current_layer.deactivate(),(null==e||""===e||this.layer_map[e])&&(e=ct(Object.keys(this.layer_map)));var r=this.current_layer.getGroup(),i=new rt.Z(e,r,this.svgElem_),a=i.getGroup();(0,f.Z)(r.childNodes).forEach((function(e){"title"!==e.localName&&a.append(n.copyElem(e))})),t&&(t.startBatchCommand("Duplicate Layer"),t.insertElement(a),t.endBatchCommand());var o=this.all_layers.indexOf(this.current_layer);return o>=0?this.all_layers.splice(o+1,0,i):this.all_layers.push(i),this.layer_map[e]=i,this.current_layer=i,a}},{key:"getLayerVisibility",value:function(e){var t=this.layer_map[e];return!!t&&t.isVisible()}},{key:"setLayerVisibility",value:function(e,t){if("boolean"!=typeof t)return null;var n=this.layer_map[e];return n?(n.setVisible(t),n.getGroup()):null}},{key:"getLayerOpacity",value:function(e){var t=this.layer_map[e];return t?t.getOpacity():null}},{key:"setLayerOpacity",value:function(e,t){if(!("number"!=typeof t||t<0||t>1)){var n=this.layer_map[e];n&&n.setOpacity(t)}}},{key:"copyElem",value:function(e){var t=this;return ye(e,(function(){return t.getNextId()}))}}]),e}(),ft=function(){wt(),dt.getCurrentDrawing().identifyLayers()},mt=function(e,t){if(dt){var n=dt.getCurrentDrawing().createLayer(e,ut(t));dt.clearSelection(),dt.call("changed",[n])}},gt=function(e,t){var n=dt.getCurrentDrawing().cloneLayer(e,ut(t));dt.clearSelection(),wt(),dt.call("changed",[n])},pt=function(){var e=dt.getCurrentDrawing().getCurrentLayer(),t=e.nextSibling,n=e.parentNode;if(e=dt.getCurrentDrawing().deleteCurrentLayer()){var r=new w.BatchCommand("Delete Layer");return r.addSubCommand(new w.RemoveElementCommand(e,t,n)),dt.addCommandToHistory(r),dt.clearSelection(),dt.call("changed",[n]),!0}return!1},vt=function(e){var t=dt.getCurrentDrawing().setCurrentLayer(T(e));return t&&dt.clearSelection(),t},yt=function(e){var t=dt.getCurrentDrawing(),n=t.getCurrentLayer();return!(!n||!t.setCurrentLayerName(e,ut()))&&(dt.call("changed",[n]),!0)},At=function(e){var t=dt.getCurrentDrawing().setCurrentLayerPosition(e);return!!t&&(dt.addCommandToHistory(new w.MoveElementCommand(t.currentGroup,t.oldNextSibling,dt.getSVGContent())),!0)},xt=function(e,t){var n=dt.getCurrentDrawing(),r=n.getLayerVisibility(e),i=n.setLayerVisibility(e,t);if(!i)return!1;var a=r?"inline":"none";return dt.addCommandToHistory(new w.ChangeElementCommand(i,{display:a},"Layer Visibility")),i===n.getCurrentLayer()&&(dt.clearSelection(),dt.pathActions.clear()),!0},bt=function(e){var t=dt.getCurrentDrawing().getLayerByName(e);if(!t)return!1;for(var n=new w.BatchCommand("Move Elements to Layer"),r=dt.getSelectedElements(),i=r.length;i--;){var a=r[i];if(a){var o=a.nextSibling,s=a.parentNode;t.append(a),n.addSubCommand(new w.MoveElementCommand(a,o,s))}}return dt.addCommandToHistory(n),!0},St=function(e){dt.getCurrentDrawing().mergeLayer(ut(e)),dt.clearSelection(),wt(),dt.changeSVGContent()},Ct=function(e){dt.getCurrentDrawing().mergeAllLayers(ut(e)),dt.clearSelection(),wt(),dt.changeSVGContent()},wt=function(){var e=lt.length;if(e){for(var t=0;t<e;t++){var n=lt[t],r=dt.elData(n,"orig_opac");1!==r?n.setAttribute("opacity",r):n.removeAttribute("opacity"),n.setAttribute("style","pointer-events: inherit")}lt=[],dt.clearSelection(!0),dt.call("contextset",null)}dt.setCurrentGroup(null)},Et=function(e){wt(),"string"==typeof e&&(e=fe(e)),dt.setCurrentGroup(e),at(e).parentsUntil("#svgcontent").andSelf().siblings().each((function(){var e=this.getAttribute("opacity")||1;dt.elData(this,"orig_opac",e),this.setAttribute("opacity",.33*e),this.setAttribute("style","pointer-events: none"),lt.push(this)})),dt.clearSelection(),dt.call("contextset",dt.getCurrentGroup())},kt=n(2670),Nt=n(3691),_t=n(8882),Mt=n(3678),It=n(9695),Gt=(n(844),n(3267)),Bt=n(2920);function Lt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Tt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Tt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Tt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pt(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ot=(0,A.Z)(jQuery),Vt=w.MoveElementCommand,Rt=w.InsertElementCommand,jt=w.RemoveElementCommand,Ft=w.ChangeElementCommand,Ut=w.BatchCommand,zt=w.UndoManager,Zt=w.HistoryEventTypes;window.console||(window.console={},window.console.log=function(e){},window.console.dir=function(e){}),window.opera&&(window.console.log=function(e){window.opera.postError(e)},window.console.dir=function(e){});var Wt=(0,g.Z)((function e(t,n){(0,p.Z)(this,e);var r={show_outside_canvas:!0,selectNew:!0,dimensions:[640,480]};n&&Ot.extend(r,n);var i=r.dimensions,o=this,s=t.ownerDocument,l=s.importNode(F('<svg id="svgroot" xmlns="'+b.NS.SVG+'" xlinkns="'+b.NS.XLINK+'" viewBox="0 0 '+i[0]+" "+i[1]+'" width="'+i[0]+'" height="'+i[1]+'" x="'+i[0]+'" y="'+i[1]+'" overflow="visible" preserveAspectRatio="none"><defs><filter id="canvashadow" filterUnits="objectBoundingBox"><feGaussianBlur in="SourceAlpha" stdDeviation="4" result="blur"/><feOffset in="blur" dx="5" dy="5" result="offsetBlur"/><feMerge><feMergeNode in="offsetBlur"/><feMergeNode in="SourceGraphic"/></feMerge></filter></defs></svg>').documentElement,!0);t.append(l);var u=s.createElementNS(b.NS.SVG,"svg");(o.clearSvgContentElement=function(){Ot(u).empty(),Ot(u).attr({id:"svgcontent",width:i[0],height:i[1],x:i[0],y:i[1],overflow:r.show_outside_canvas?"visible":"hidden",xmlns:b.NS.SVG,"xmlns:se":b.NS.SE,"xmlns:xlink":b.NS.XLINK}).appendTo(l);var e=s.createComment(" Created with SVG-edit - https://github.com/SVG-Edit/svgedit");u.append(e)})();var c="svg_";o.setIdPrefix=function(e){c=e},o.current_drawing_=new ht(u,c);var d=o.getCurrentDrawing=function(){return o.current_drawing_},g=1,v=null,A={shape:{fill:("none"===r.initFill.color?"":"#")+r.initFill.color,fill_paint:null,fill_opacity:r.initFill.opacity,stroke:"#"+r.initStroke.color,stroke_paint:null,stroke_opacity:r.initStroke.opacity,stroke_width:r.initStroke.width,stroke_dasharray:"none",stroke_linejoin:"miter",stroke_linecap:"butt",opacity:r.initOpacity}};A.text=Ot.extend(!0,{},A.shape),Ot.extend(A.text,{fill:"#333333",stroke_width:r.text&&r.text.stroke_width,font_size:r.text&&r.text.font_size,font_family:r.text&&r.text.font_family});var _=A.shape,M=[],O=this.getJsonFromSvgElement=function(e){if(3===e.nodeType)return e.nodeValue;for(var t,n={element:e.tagName,attr:{},children:[]},r=0;t=e.attributes[r];r++)n.attr[t.name]=t.value;for(var i,a=0;i=e.childNodes[a];a++)n.children[a]=O(i);return n},V=this.addSVGElementFromJson=function(e){if("string"==typeof e)return s.createTextNode(e);var t=fe(e.attr.id),n=d().getCurrentLayer();if(t&&e.element!==t.tagName&&(t.remove(),t=null),!t){var r=e.namespace||b.NS.SVG;t=s.createElementNS(r,e.element),n&&(v||n).append(t)}return e.curStyles&&me(t,{fill:"none",stroke:"none"==_.stroke?"#333333":_.stroke,"stroke-width":_.stroke_width,"stroke-dasharray":_.stroke_dasharray,"stroke-linejoin":_.stroke_linejoin,"stroke-linecap":_.stroke_linecap,"stroke-opacity":_.stroke_opacity,"fill-opacity":_.fill_opacity,opacity:Bt.prevStyle?Bt.prevStyle.opacity:1,style:"pointer-events:inherit"}),me(t,e.attr),ge(t),e.children&&e.children.forEach((function(e){t.append(V(e))})),t},X=null==r?void 0:r.forRightToGetElements,Y=null==r?void 0:r.mouseCallback;o.getTransformList=S.D9,o.matrixMultiply=E.h9,o.hasMatrixTransform=E.Dy,o.transformListToTransform=E.vm,o.mouseCallback=Y,o.forRightToGetElements=X;var ee=function(){return r.baseUnit};(0,C.S1)({getBaseUnit:ee,getElement:fe,getHeight:function(){return u.getAttribute("height")/g},getWidth:function(){return u.getAttribute("width")/g},getRoundDigits:function(){return Fe.round_digits}}),o.convertToNum=C.R5;var te,ne=function(){return u},re=this.getSelectedElems=function(){return M},ie=nt,ae=function(){return l};I=te={pathActions:ie,getSVGContent:ne,addSVGElementFromJson:V,getSelectedElements:re,getDOMDocument:function(){return s},getDOMContainer:function(){return t},getSVGRoot:ae,getBaseUnit:ee,getSnappingStep:function(){return r.snappingStep}},G=te.getDOMDocument(),B=te.getDOMContainer(),L=te.getSVGRoot(),o.findDefs=q,o.getUrlFromAttr=z,o.getHref=Z,o.setHref=W,o.getBBox=K,o.getRotationAngle=de,o.getElem=fe,o.getRefElem=he,o.assignAttributes=me,this.cleanupElement=ge;var oe=function(){return r.gridSnapping};(0,_t.S)({getDrawing:function(){return d()},getSVGRoot:ae,getGridSnapping:oe}),this.remapElement=_t.w,(0,Mt.S1)({getSVGRoot:ae,getStartTransform:function(){return Xe},setStartTransform:function(e){Xe=e}}),this.recalculateDimensions=Mt._s;var se=(0,b.y)();o.sanitizeSvg=kt.j;var ce=o.undoMgr=new zt({handleHistoryEvent:function(e,t){var n=Zt;if(e===n.BEFORE_UNAPPLY||e===n.BEFORE_APPLY)o.clearSelection();else if(e===n.AFTER_APPLY||e===n.AFTER_UNAPPLY){var r=t.elements();o.pathActions.clear(),_e("changed",r);var i=t.type(),a=e===n.AFTER_APPLY;if("MoveElementCommand"===i)(a?t.newParent:t.oldParent)===u&&ft();else if("InsertElementCommand"===i||"RemoveElementCommand"===i)t.parent===u&&ft(),"InsertElementCommand"===i?a&&Re(t.elem):a||Re(t.elem),t.elem&&"use"===t.elem.tagName&&Jt(t.elem);else if("ChangeElementCommand"===i){"title"===t.elem.tagName&&t.elem.parentNode.parentNode===u&&ft();var s=a?t.newValues:t.oldValues;s.stdDeviation&&o.setBlurOffsets(t.elem.parentNode,s.stdDeviation)}}}}),ye=function(e){o.undoMgr.addCommandToHistory(e)},xe=this.getZoom=function(){return g},be=this.round=function(e){return Number.parseInt(e*g)/g};(0,It.S1)(r,{createSVGElement:function(e){return o.addSVGElementFromJson(e)},svgRoot:function(){return l},svgContent:function(){return u},getCurrentZoom:xe});var Se=this.selectorManager=(0,It.xC)(),we=o.getNextId=function(){return d().getNextId()},Ee=o.getId=function(){return d().getId()},_e=function(e,t){if(lt[e])return lt[e](window,t)},Ie=this.clearSelection=function(e){M.forEach((function(e){Ae(e)||Se.releaseSelector(e)})),M=[],e||_e("selected",M)},Ge=this.addToSelection=function(e,t){if(e.length){for(var n=0;n<M.length&&!Ae(M[n]);)++n;for(var r=e.length;r--;){var i=e[r];if(i){var a=K(i);if(a&&("a"===i.tagName&&1===i.childNodes.length&&(i=i.firstChild),!M.includes(i))){M[n]=i,n++;var o=Se.requestSelector(i,a);M.length>1&&o.showGrips(!1)}}}if(M.length)for(_e("selected",M),1===M.length&&Se.requestSelector(M[0]).showGrips(t),M.sort((function(e,t){return e&&t&&e.compareDocumentPosition?3-(6&t.compareDocumentPosition(e)):Ae(e)?1:0}));Ae(M[0]);)M.shift(0)}},Be=function(){return _.opacity},Le=this.getMouseTarget=function(e){if(Ae(e))return null;var n=e.target;if(n.correspondingUseElement&&(n=n.correspondingUseElement),[b.NS.MATH,b.NS.HTML].includes(n.namespaceURI)&&"svgcanvas"!==n.id)for(;"foreignObject"!==n.nodeName;)if(!(n=n.parentNode))return l;var r=d().getCurrentLayer();if([l,t,u,r].includes(n))return l;if(Ot(n).closest("#selectorParentGroup").length)return Se.selectorParentGroup;for(;n.parentNode!==(v||r);)n=n.parentNode;return n};o.pathActions=ie,Me({selectorManager:Se,canvas:o,call:_e,resetD:function(e){e.setAttribute("d",ie.convertPath(e))},round:be,clearSelection:Ie,addToSelection:Ge,addCommandToHistory:ye,remapElement:_t.w,addSVGElementFromJson:V,getGridSnapping:oe,getOpacity:Be,getSelectedElements:re,getContainer:function(){return t},setStarted:function(e){He=e},getRubberBox:function(){return $e},setRubberBox:function(e){return $e=e},addPtsToSelection:function(e){var t=e.closedSubpath,n=e.grips;ie.canDeleteNodes=!0,ie.closed_subpath=t,_e("pointsAdded",{closedSubpath:t,grips:n}),_e("selected",n)},endChanges:function(e){var t=e.cmd,n=e.elem;ye(t),_e("changed",[n])},getCurrentZoom:xe,getId:Ee,getNextId:we,getMouseTarget:Le,getCurrentMode:function(){return Ke},setCurrentMode:function(e){return Ke=e},getDrawnPath:function(){return qt},setDrawnPath:function(e){return qt=e},getSVGRoot:ae});var Te={},Pe="a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use",De=["clip-path","fill","filter","marker-end","marker-mid","marker-start","mask","stroke"],Oe=Ot.data,Ve=document.createElementNS(b.NS.SVG,"animate");Ot(Ve).attr({attributeName:"opacity",begin:"indefinite",dur:1,fill:"freeze"}).appendTo(l);var Re=function e(t){var n=Ot(t).attr(De);Object.values(n).forEach((function(e){if(e&&e.startsWith("url(")){var t=z(e).substr(1);fe(t)||(q().append(qe[t]),delete qe[t])}}));var r=t.getElementsByTagName("*");if(r.length)for(var i=0,a=r.length;i<a;i++)e(r[i])},je={},Fe={round_digits:5},Ue={},ze=A.text,Ze={},qe={},He=!1,Xe=null,Ke="select",Ye="none",Qe=_,Je=null,$e=null,et=[],tt=null;this.runExtension=function(e,t,n){return this.runExtensions(t,n,!1,(function(t){return t===e}))};var rt=this.runExtensions=function(e,t,n,r){var i=!!n&&[];return Ot.each(Ze,(function(a,o){r&&!r(a)||o&&e in o&&("function"==typeof t&&(t=t(a)),n?i.push(o[e](t)):i=o[e](t))})),i};this.addExtension=function(){var e=(0,m.Z)(y().mark((function e(t,n,r){var i,a,s,c;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.$,a=r.importLocale,"function"==typeof n){e.next=3;break}throw new TypeError("Function argument expected for `svgcanvas.addExtension`");case 3:if(!(t in Ze)){e.next=5;break}throw new Error('Cannot add extension "'+t+'", an extension by that name already exists.');case 5:return s=Ot.extend(o.getPrivateMethods(),{$:i,importLocale:a,svgroot:l,svgcontent:u,nonce:d().getNonce(),selectorManager:Se}),e.next=8,n(s);case 8:return(c=e.sent)&&(c.name=t),Ze[t]=c,e.abrupt("return",_e("extension_added",c));case 12:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();var it=this.getIntersectionList=function(e){if(Ae($e))return null;var t,n=v||d().getCurrentLayer();if(e)(t=u.createSVGRect()).x=e.x,t.y=e.y,t.width=e.width,t.height=e.height;else{t=$e.getBBox();var r=u.createSVGRect();["x","y","width","height","top","right","bottom","left"].forEach((function(e){r[e]=t[e]/g})),t=r}var i=null;if((0,k.w1)()||"function"==typeof l.getIntersectionList&&(t.x+=Number.parseInt(u.getAttribute("x")),t.y+=Number.parseInt(u.getAttribute("y")),i=l.getIntersectionList(t,n)),Ae(i)||"function"!=typeof i.item){i=[],et.length||(et=at(n));for(var a=et.length;a--;)t.width&&(0,E.$D)(t,et[a].bbox)&&i.push(et[a].elem)}return i};this.getStrokedBBox=ue,this.getVisibleElements=le;var at=this.getVisibleElementsAndBBoxes=function(e){e||(e=Ot(u).children());var t=[];return Ot(e).children().each((function(e,n){n.getBBox&&t.push({elem:n,bbox:ue([n])})})),t.reverse()},ot=this.groupSvgElem=function(e){var t=document.createElementNS(b.NS.SVG,"g");e.replaceWith(t),Ot(t).append(e).data("gsvg",e)[0].id=we()},lt={};o.call=_e,o.bind=function(e,t){var n=lt[e];return lt[e]=t,n},this.prepareSvg=function(e){(0,f.Z)(e.getElementsByTagNameNS(b.NS.SVG,"path")).forEach((function(e){e.setAttribute("d",ie.convertPath(e)),ie.fixEnd(e)}))};var ut=function(e){if(!(0,k.hx)())return e;var t=e.cloneNode(!0);return e.before(t),e.remove(),Se.releaseSelector(e),M[0]=t,Se.requestSelector(t).showGrips(!0),t};this.setRotationAngle=function(e,t){e=Number.parseFloat(e);var n=M[0],r=n.getAttribute("transform"),i=K(n),a=i.x+i.width/2,o=i.y+i.height/2,s=(0,S.D9)(n);if(s.numberOfItems>0&&4===s.getItem(0).type&&s.removeItem(0),0!==e){var u=(0,E.DC)(a,o,(0,E.vm)(s).matrix),c=l.createSVGTransform();c.setRotate(e,u.x,u.y),s.numberOfItems?s.insertItemBefore(c,0):s.appendItem(c)}else 0===s.numberOfItems&&n.removeAttribute("transform");if(!t){var d=n.getAttribute("transform");null==n||n.setAttribute("transform",r),ln("transform",d,M),_e("changed",M)}Se.requestSelector(M[0]).resize(),It.Qf.updateGripCursors(e)};var ct=this.recalculateAllSelectedDimensions=function(){for(var e=new Ut("none"===Ye?"position":"size"),t=M.length;t--;){var n=M[t],r=(0,Mt._s)(n);r&&e.addSubCommand(r)}e.isEmpty()||(ye(e),_e("changed",M))},Tt=function(e){console.log([e.a,e.b,e.c,e.d,e.e,e.f])},Pt=null,Wt=this.selectOnly=function(e,t){Ie(!0),Ge(e,t)};this.removeFromSelection=function(e){if(!Ae(M[0])&&e.length){for(var t=[],n=M.length,r=0;r<n;++r){var i=M[r];i&&(e.includes(i)?Se.releaseSelector(i):t.push(i))}M=t}},this.selectAllInCurrentLayer=function(){var e=d().getCurrentLayer();e&&(Ke="select",Wt(Ot(v||e).children()))};var qt=null;!function(){var e,i,a={minx:null,miny:null,maxx:null,maxy:null},s=null,c=null,h=null,f=null,m={},p=0,y={x:0,y:0},A={x:0,y:0},x={x:0,y:0},b={x:0,y:0},C={x:0,y:0},w={x:0,y:0},N=function(e){var t={x:0,y:0},n=y,r=A,i=x,a=b,o=1/6,s=e*e,l=s*e,u=[[-1,3,-3,1],[3,-6,3,0],[-3,0,3,0],[1,4,1,0]];return t.x=o*((n.x*u[0][0]+r.x*u[0][1]+i.x*u[0][2]+a.x*u[0][3])*l+(n.x*u[1][0]+r.x*u[1][1]+i.x*u[1][2]+a.x*u[1][3])*s+(n.x*u[2][0]+r.x*u[2][1]+i.x*u[2][2]+a.x*u[2][3])*e+(n.x*u[3][0]+r.x*u[3][1]+i.x*u[3][2]+a.x*u[3][3])),t.y=o*((n.y*u[0][0]+r.y*u[0][1]+i.y*u[0][2]+a.y*u[0][3])*l+(n.y*u[1][0]+r.y*u[1][1]+i.y*u[1][2]+a.y*u[1][3])*s+(n.y*u[2][0]+r.y*u[2][1]+i.y*u[2][2]+a.y*u[2][3])*e+(n.y*u[3][0]+r.y*u[3][1]+i.y*u[3][2]+a.y*u[3][3])),{x:t.x,y:t.y}},I=null;Gt.Z,Ot(t).mousedown((function(e){var t,n,u,d;if(!o.spaceKey&&1!==e.button){var p=2===e.button;e.altKey&&o.cloneSelectedElements(0,0);var v=Dt(Dt({},_),{},{fill:Bt.prevStyle?null===Bt.prevStyle||void 0===Bt.prevStyle||null===(t=Bt.prevStyle.lineType)||void 0===t?void 0:t.fill:_.fill,opacity:Bt.prevStyle?null===Bt.prevStyle||void 0===Bt.prevStyle?void 0:Bt.prevStyle.opacity:1,stroke:Bt.prevStyle?null===Bt.prevStyle||void 0===Bt.prevStyle||null===(n=Bt.prevStyle.lineType)||void 0===n?void 0:n.stroke:"#333333",stroke_dasharray:Bt.prevStyle?null===Bt.prevStyle||void 0===Bt.prevStyle||null===(u=Bt.prevStyle.lineType)||void 0===u?void 0:u.stroke_dasharray:_.stroke_dasharray,stroke_width:Bt.prevStyle?null===Bt.prevStyle||void 0===Bt.prevStyle||null===(d=Bt.prevStyle.lineType)||void 0===d?void 0:d.stroke_width:_.stroke_width});Pt=Ot("#svgcontent g")[0].getScreenCTM().inverse();var b=(0,E.DC)(e.pageX,e.pageY,Pt),C=b.x*g,w=b.y*g;e.preventDefault(),p&&(Ke="select",tt=b);var N=C/g,I=w/g,G=Le(e);"a"===G.tagName&&1===G.childNodes.length&&(G=G.firstChild);var B=N;h=s=N;var L=I;if(f=c=I,r.gridSnapping&&(N=pe(N),I=pe(I),s=pe(s),c=pe(c)),G===Se.selectorParentGroup&&!Ae(M[0])){var T=e.target,P=Oe(T,"type");"rotate"===P?Ke="rotate":"resize"===P&&(Ke="resize",Ye=Oe(T,"dir")),G=M[0]}Xe=G.getAttribute("transform");var D=(0,S.D9)(G);switch(Ke){case"select":if(He=!0,Ye="none",p&&(He=!1),G!==l){if(M.includes(G)||(e.shiftKey||Ie(!0),Ge([G]),Je=G,ie.clear()),!p)for(var O=0,R=M;O<R.length;O++){var j=R[O];if(!Ae(j)){var F=(0,S.D9)(j);F.numberOfItems?F.insertItemBefore(l.createSVGTransform(),0):F.appendItem(l.createSVGTransform())}}}else p||(Ie(),Ke="multiselect",Ae($e)&&($e=Se.getRubberBandBox()),me($e,{x:h*=g,y:f*=g,width:0,height:0,display:"inline"}));break;case"zoom":He=!0,Ae($e)&&($e=Se.getRubberBandBox()),me($e,{x:B*g,y:B*g,width:0,height:0,display:"inline"});break;case"resize":He=!0,s=N,c=I,m=K(Ot("#selectedBox0")[0]);var U={};Ot.each(m,(function(e,t){U[e]=t/g})),m=U;var z=de(G)?1:0;if((0,E.Dy)(D))D.insertItemBefore(l.createSVGTransform(),z),D.insertItemBefore(l.createSVGTransform(),z),D.insertItemBefore(l.createSVGTransform(),z);else if(D.appendItem(l.createSVGTransform()),D.appendItem(l.createSVGTransform()),D.appendItem(l.createSVGTransform()),(0,k.oQ)()){var Z,q=(0,k.VG)();q&&(Z=function(e){var t=e.getAttribute("stroke");e.removeAttribute("stroke"),null!==t&&setTimeout((function(){e.setAttribute("stroke",t)}),0)}),G.style.vectorEffect="non-scaling-stroke",q&&Z(G);for(var H=G.getElementsByTagName("*"),X=H.length,Y=0;Y<X;Y++)H[Y].style&&(H[Y].style.vectorEffect="non-scaling-stroke",q&&Z(H[Y]))}break;case"fhellipse":case"fhrect":case"fhpath":x.x=B,x.y=L,A={x:0,y:0},y={x:0,y:0},He=!0,V({element:"polyline",curStyles:!0,attr:{points:B+","+L+" ",id:we(),fill:"none",opacity:1,"stroke-linecap":"round",style:"pointer-events:none","data-type":"polyline","data-isrun":1}}),a.minx=B,a.maxx=B,a.miny=L,a.maxy=L;break;case"image":He=!0;var Q=V({element:"image",attr:{x:N,y:I,width:0,height:0,id:we(),opacity:1,style:"pointer-events:inherit"}});W(Q,null),ve(Q);break;case"square":case"rect":He=!0,s=N,c=I,V({element:"rect",curStyles:!0,attr:{x:N,y:I,width:0,height:0,id:we(),opacity:1,fill:"none",stroke:"#333333","data-type":Ke,"data-isrun":1}});break;case"line":He=!0,0===Number(v.stroke_width)||v.stroke_width,V({element:"line",curStyles:!0,attr:{x1:N,y1:I,x2:N,y2:I,id:we(),stroke:"none"==v.stroke?"#333333":v.stroke,"stroke-width":v.stroke_width,"stroke-dasharray":v.stroke_dasharray,"stroke-linejoin":v.stroke_linejoin,"stroke-linecap":v.stroke_linecap,"stroke-opacity":v.stroke_opacity,fill:"none",opacity:(null===Bt.prevStyle||void 0===Bt.prevStyle?void 0:Bt.prevStyle.opacity)||1,style:"pointer-events:none","data-type":Ke,"data-isrun":1}});break;case"circle":He=!0,V({element:"circle",curStyles:!0,attr:{cx:N,cy:I,r:0,id:we(),opacity:1,fill:"none",stroke:"#333333","data-type":Ke,"data-isrun":1}});break;case"ellipse":He=!0,V({element:"ellipse",curStyles:!0,attr:{cx:N,cy:I,rx:0,ry:0,id:we(),opacity:1,fill:"none",stroke:"#333333","data-type":Ke,"data-isrun":1}});break;case"text":He=!0,V({element:"text",curStyles:!0,attr:{x:N,y:I,id:we(),fill:ze.fill,"stroke-width":ze.stroke_width,"font-size":ze.font_size,"font-family":ze.font_family,"text-anchor":"middle","xml:space":"preserve",opacity:v.opacity}});break;case"path":case"pathedit":s*=g,c*=g,ie.mouseDown(e,G,s,c),He=!0;break;case"textedit":s*=g,c*=g,Xt.mouseDown(e,G,s,c),He=!0;break;case"rotate":He=!0,o.undoMgr.beginUndoableChange("transform",M);break;case"star":o.getColor("fill"),o.getColor("stroke"),o.getStrokeWidth(),He=!0,i=V({element:"polygon",attr:{cx:e.start_x||N,cy:e.start_y||I,id:o.getNextId(),shape:"star",point:document.getElementsByName("starNumPoints")[0].value||5,r:0,radialshift:document.getElementsByName("radialShift")[0].value||0,r2:0,orient:"point",fill:"none",strokecolor:"#333333",strokeWidth:1,"data-type":Ke,"data-isrun":1}}),He=!0;break;case"polygon":o.getColor("fill"),o.getColor("stroke"),o.getStrokeWidth(),i=V({element:"polygon",attr:{cx:e.start_x||N,cy:e.start_y||I,id:o.getNextId(),shape:"regularPoly",sides:document.getElementsByName("polySides")[0].value,orient:"x",edge:0,fill:"none",strokecolor:"#333333",strokeWidth:1,"data-type":Ke,"data-isrun":1}}),He=!0}var J=rt("mouseDown",{event:e,start_x:s,start_y:c,selectedElements:M},!0);Ot.each(J,(function(e,t){t&&t.started&&(He=!0)}))}})).mousemove((function(t){if(He&&1!==t.button&&!o.spaceKey){var n,d,v,k,_,I,G,B,L,T,P=M[0],D=(0,E.DC)(t.pageX,t.pageY,Pt),O=D.x*g,V=D.y*g,R=fe(Ee()),j=O/g,F=j,U=V/g,z=U;switch(r.gridSnapping&&(F=pe(F),z=pe(z)),t.preventDefault(),Ke){case"select":if(null!==M[0]&&(_=F-s,I=z-c,r.gridSnapping&&(_=pe(_),I=pe(I)),0!==_||0!==I)){for(G=M.length,n=0;n<G&&(P=M[n],!Ae(P));++n){var Z=l.createSVGTransform();T=(0,S.D9)(P),Z.setTranslate(_,I),T.numberOfItems?T.replaceItem(Z,0):T.appendItem(Z),Se.requestSelector(P).resize()}_e("transition",M)}break;case"multiselect":j*=g,U*=g,me($e,{x:Math.min(h,j),y:Math.min(f,U),width:Math.abs(j-h),height:Math.abs(U-f)});var W=M.slice(),q=[],H=it();for(G=H.length,n=0;n<G;++n){var X=H[n];M.includes(X)||q.push(X);var Y=W.indexOf(X);-1!==Y&&W.splice(Y,1)}W.length>0&&o.removeFromSelection(W),q.length>0&&o.addToSelection(q);break;case"resize":T=(0,S.D9)(P);var Q=(0,E.Dy)(T),J=(L=Q?m:K(P)).x,$=L.y,ee=L,te=ee.width,ne=ee.height;if(_=F-s,I=z-c,r.gridSnapping&&(_=pe(_),I=pe(I),ne=pe(ne),te=pe(te)),B=de(P)){var re=Math.sqrt(_*_+I*I),ae=Math.atan2(I,_)-B*Math.PI/180;_=re*Math.cos(ae),I=re*Math.sin(ae)}Ye.includes("n")||Ye.includes("s")||(I=0),Ye.includes("e")||Ye.includes("w")||(_=0);var oe=0,se=0,le=ne?(ne+I)/ne:1,ue=te?(te+_)/te:1;Ye.includes("n")&&(le=ne?(ne-I)/ne:1,se=ne),Ye.includes("w")&&(ue=te?(te-_)/te:1,oe=te);var ce=l.createSVGTransform(),he=l.createSVGTransform(),ge=l.createSVGTransform();if(r.gridSnapping&&(J=pe(J),oe=pe(oe),$=pe($),se=pe(se)),ce.setTranslate(-(J+oe),-($+se)),t.shiftKey&&(1===ue?ue=le:le=ue),he.setScale(ue,le),ge.setTranslate(J+oe,$+se),Q){var ve=B?1:0;T.replaceItem(ce,2+ve),T.replaceItem(he,1+ve),T.replaceItem(ge,Number(ve))}else{var ye=T.numberOfItems;T.replaceItem(ge,ye-3),T.replaceItem(he,ye-2),T.replaceItem(ce,ye-1)}Se.requestSelector(P).resize(),_e("transition",M);break;case"zoom":j*=g,U*=g,me($e,{x:Math.min(h*g,j),y:Math.min(f*g,U),width:Math.abs(j-h*g),height:Math.abs(U-f*g)});break;case"text":me(R,{x:F,y:z});break;case"line":r.gridSnapping&&(F=pe(F),z=pe(z));var xe=F,be=z;t.shiftKey&&(xe=(d=(0,E.lG)(s,c,xe,be)).x,be=d.y),R.setAttribute("x2",xe),R.setAttribute("y2",be);break;case"foreignObject":case"square":case"rect":case"image":var Ce,we,ke="square"===Ke||t.shiftKey,Me=Math.abs(F-s),Ie=Math.abs(z-c);ke?(Me=Ie=Math.max(Me,Ie),Ce=s<F?s:s-Me,we=c<z?c:c-Ie):(Ce=Math.min(s,F),we=Math.min(c,z)),r.gridSnapping&&(Me=pe(Me),Ie=pe(Ie),Ce=pe(Ce),we=pe(we)),me(R,{width:Me,height:Ie,x:Ce,y:we});break;case"circle":var Ge=Ot(R).attr(["cx","cy"]);v=Ge.cx,k=Ge.cy;var Be=Math.sqrt((F-v)*(F-v)+(z-k)*(z-k));r.gridSnapping&&(Be=pe(Be)),R.setAttribute("r",Be);break;case"ellipse":var Le=Ot(R).attr(["cx","cy"]);v=Le.cx,k=Le.cy,r.gridSnapping&&(F=pe(F),v=pe(v),z=pe(z),k=pe(k)),R.setAttribute("rx",Math.abs(F-v));var Te=Math.abs(t.shiftKey?F-v:z-k);R.setAttribute("ry",Te);break;case"fhellipse":case"fhrect":a.minx=Math.min(j,a.minx),a.maxx=Math.max(j,a.maxx),a.miny=Math.min(U,a.miny),a.maxy=Math.max(U,a.maxy);case"fhpath":if(b.x=j,b.y=U,y.x&&y.y)for(n=0;n<9;n++)if(e=n/10,C=N((n+1)/10),w=C,C=N(e),(p+=Math.sqrt((w.x-C.x)*(w.x-C.x)+(w.y-C.y)*(w.y-C.y)))>.8){p-=.8;var Pe=u.createSVGPoint();Pe.x=C.x,Pe.y=C.y,R.points.appendItem(Pe)}y={x:A.x,y:A.y},A={x:x.x,y:x.y},x={x:b.x,y:b.y};break;case"path":case"pathedit":if(F*=g,z*=g,r.gridSnapping&&(F=pe(F),z=pe(z),s=pe(s),c=pe(c)),t.shiftKey){var De,Oe,Ve=Ne;Ve?(De=Ve.dragging?Ve.dragging[0]:s,Oe=Ve.dragging?Ve.dragging[1]:c):(De=s,Oe=c);var Re=d=(0,E.lG)(De,Oe,F,z);F=Re.x,z=Re.y}$e&&"none"!==$e.getAttribute("display")&&(j*=g,U*=g,me($e,{x:Math.min(h*g,j),y:Math.min(f*g,U),width:Math.abs(j-h*g),height:Math.abs(U-f*g)})),ie.mouseMove(F,z);break;case"textedit":F*=g,z*=g,Xt.mouseMove(O,V);break;case"rotate":v=(L=K(P)).x+L.width/2,k=L.y+L.height/2;var je=(0,E.Rb)(P),Fe=(0,E.DC)(v,k,je);v=Fe.x,k=Fe.y,B=(Math.atan2(k-z,v-F)*(180/Math.PI)-90)%360,r.gridSnapping&&(B=pe(B)),t.shiftKey&&(B=45*Math.round(B/45)),o.setRotationAngle(B<-180?360+B:B,!0),_e("transition",M);break;case"star":if(!He)return;var Ue=Ot(i).attr(["cx","cy","point","orient","fill","strokecolor","strokeWidth","radialshift"]),ze=t.offsetX,Ze=t.offsetY,We=Ue.cx,qe=Ue.cy,Xe=Ue.fill,Qe=Ue.strokecolor,Je=Ue.strokeWidth,et=Ue.radialshift,tt=Ue.point,nt=Ue.orient,at=Math.sqrt((ze-We)*(ze-We)+(Ze-qe)*(Ze-qe))/1.5,ot=at/Number(document.getElementsByName("starRadiusMulitplier")[0].value);i.setAttribute("r",at),i.setAttribute("r2",ot);for(var st="",lt=0;tt>=lt;lt++){var ut=2*Math.PI*(lt/tt);"point"===nt?ut-=Math.PI/2:"edge"===nt&&(ut=ut+Math.PI/tt-Math.PI/2),st+=(ze=at*Math.cos(ut)+We)+","+(Ze=at*Math.sin(ut)+qe)+" ",isNaN(ot)||(ut=2*Math.PI*(lt/tt)+Math.PI/tt,"point"===nt?ut-=Math.PI/2:"edge"===nt&&(ut=ut+Math.PI/tt-Math.PI/2),ut+=et,st+=(ze=ot*Math.cos(ut)+We)+","+(Ze=ot*Math.sin(ut)+qe)+" ")}i.setAttribute("points",st),i.setAttribute("fill",Xe),i.setAttribute("stroke",Qe),i.setAttribute("stroke-width",Je),i.getAttribute("shape"),He=!0;break;case"polygon":var ct=Ot(i).attr(["cx","cy","sides","orient","fill","strokecolor","strokeWidth"]),dt=t.offsetX,ht=t.offsetY,ft=ct.cx,mt=ct.cy,gt=ct.fill,pt=ct.strokecolor,vt=ct.strokeWidth,yt=ct.sides,At=Math.sqrt((dt-ft)*(dt-ft)+(ht-mt)*(ht-mt))/1.5;i.setAttribute("edge",At);for(var xt=At/2*(1/Math.tan(Math.PI/yt))*(1/Math.cos(Math.PI/yt)),bt="",St=0;yt>=St;St++){var Ct=2*Math.PI*St/yt;bt+=(dt=xt*Math.cos(Ct)+ft)+","+(ht=xt*Math.sin(Ct)+mt)+" "}i.setAttribute("points",bt),i.setAttribute("fill",gt),i.setAttribute("stroke",pt),i.setAttribute("stroke-width",vt),He=!0}rt("mouseMove",{event:t,mouse_x:O,mouse_y:V,selected:P})}})).click((function(e){return e.preventDefault(),!1})).dblclick((function(e){var t=e.target.parentNode,n=Le(e),r=n.tagName;if("text"===r&&"textedit"!==Ke){var i=(0,E.DC)(e.pageX,e.pageY,Pt);Xt.select(n,i.x,i.y)}t!==v&&("g"!==r&&"a"!==r||!de(n)||(dn(n),n=M[0],Ie(!0)),v&&wt(),"g"!==t.tagName&&"a"!==t.tagName||t===d().getCurrentLayer()||n===Se.selectorParentGroup||Et(n))})).mouseup((function(e){if(2!==e.button){var t=Je;if(Je=null,He){var s,l,u=(0,E.DC)(e.pageX,e.pageY,Pt),c=u.x*g,m=u.y*g,v=c/g,S=m/g,C=fe(Ee()),w=!1,N=v,G=S;switch(He=!1,Ke){case"resize":case"multiselect":Ae($e)||($e.setAttribute("display","none"),et=[]),Ke="select";case"select":if(!Ae(M[0])){if(Ae(M[1])){var B=M[0];switch(B.tagName){case"g":case"use":case"image":case"foreignObject":break;default:Qe.fill=B.getAttribute("fill"),Qe.fill_opacity=B.getAttribute("fill-opacity"),Qe.stroke=B.getAttribute("stroke"),Qe.stroke_opacity=B.getAttribute("stroke-opacity"),Qe.stroke_width=B.getAttribute("stroke-width"),Qe.stroke_dasharray=B.getAttribute("stroke-dasharray"),Qe.stroke_linejoin=B.getAttribute("stroke-linejoin"),Qe.stroke_linecap=B.getAttribute("stroke-linecap")}"text"===B.tagName&&(ze.font_size=B.getAttribute("font-size"),ze.font_family=B.getAttribute("font-family")),Se.requestSelector(B).showGrips(!0)}if(ct(),N!==h||G!==f)for(var L=M.length,T=0;T<L&&!Ae(M[T]);++T)M[T].firstChild||Se.requestSelector(M[T]).resize();else if(l=e.target,"path"===M[0].nodeName&&Ae(M[1])){var P=I?I[0]:null;ie.select(M[0],l==P)}else e.shiftKey&&t!==l&&o.removeFromSelection([l]);if((0,k.oQ)()){var D=M[0];D&&(D.removeAttribute("style"),U(D,(function(e){e.removeAttribute("style")})))}I=M}return o.mouseCallback&&o.mouseCallback(M),o.forRightToGetElements&&o.forRightToGetElements(M),void n.setSelectedList(M,Ke);case"zoom":Ae($e)||$e.setAttribute("display","none");var O=e.shiftKey?.5:2;return _e("zoomed",{x:Math.min(h,N),y:Math.min(f,G),width:Math.abs(N-h),height:Math.abs(G-f),factor:O}),void(w&&(o.mouseCallback&&o.mouseCallback(C||M),o.forRightToGetElements&&o.forRightToGetElements(C||M),n.setSelectedList(C||M,Ke)));case"fhpath":p=0,y={x:0,y:0},A={x:0,y:0},x={x:0,y:0},b={x:0,y:0};var R=C.getAttribute("points"),j=R.indexOf(",");(w=j>=0?R.includes(",",j+1):R.includes(" ",R.indexOf(" ")+1))?(C=ie.smoothPolylineIntoPath(C),o.mouseCallback&&o.mouseCallback(C||M),o.forRightToGetElements&&o.forRightToGetElements(C||M),n.setSelectedList(C||M,Ke),C.setAttribute("data-type",Ke)):C.setAttribute("data-type",C.tagName),C.setAttribute("data-isrun",1);break;case"line":s=Ot(C).attr(["x1","x2","y1","y2"]),(w=s.x1!==s.x2||s.y1!==s.y2)&&(o.mouseCallback&&o.mouseCallback(C||M),o.forRightToGetElements&&o.forRightToGetElements(C||M),n.setSelectedList(C||M,Ke));break;case"foreignObject":case"square":case"rect":case"image":s=Ot(C).attr(["width","height"]),(w=!!s.width||!!s.height)&&(o.mouseCallback&&o.mouseCallback(C||M),o.forRightToGetElements&&o.forRightToGetElements(C||M),n.setSelectedList(C||M,Ke));break;case"circle":(w="0"!==C.getAttribute("r"))&&(o.mouseCallback&&o.mouseCallback(C||M),o.forRightToGetElements&&o.forRightToGetElements(C||M),n.setSelectedList(C||M,Ke));break;case"ellipse":s=Ot(C).attr(["rx","ry"]),(w=s.rx||s.ry)&&(o.mouseCallback&&o.mouseCallback(C||M),o.forRightToGetElements&&o.forRightToGetElements(C||M),n.setSelectedList(C||M,Ke));break;case"fhellipse":a.maxx-a.minx>0&&a.maxy-a.miny>0&&(C=V({element:"ellipse",curStyles:!0,attr:{cx:(a.minx+a.maxx)/2,cy:(a.miny+a.maxy)/2,rx:(a.maxx-a.minx)/2,ry:(a.maxy-a.miny)/2,id:Ee()}}),_e("changed",[C]),w=!0),w&&(o.mouseCallback&&o.mouseCallback(C||M),o.forRightToGetElements&&o.forRightToGetElements(C||M),n.setSelectedList(C||M,Ke));break;case"fhrect":a.maxx-a.minx>0&&a.maxy-a.miny>0&&(C=V({element:"rect",curStyles:!0,attr:{x:a.minx,y:a.miny,width:a.maxx-a.minx,height:a.maxy-a.miny,id:Ee()}}),_e("changed",[C]),w=!0),w&&(o.mouseCallback&&o.mouseCallback(C||M),o.forRightToGetElements&&o.forRightToGetElements(C||M),n.setSelectedList(C||M,Ke));break;case"text":w=!0,Wt([C]),Xt.start(C),w&&(o.mouseCallback&&o.mouseCallback(C||M),o.forRightToGetElements&&o.forRightToGetElements(C||M),n.setSelectedList(C||M,Ke));break;case"path":C=null,He=!0;var F=ie.mouseUp(e,C,c,m);C=F.element,(w=F.keep)&&(C&&C.setAttribute("data-type","path"),o.mouseCallback&&o.mouseCallback(C||M),o.forRightToGetElements&&o.forRightToGetElements(C||M),n.setSelectedList(C||M,Ke),C&&C.setAttribute("data-isrun",1));break;case"pathedit":w=!0,C=null,ie.mouseUp(e),w&&(o.mouseCallback&&o.mouseCallback(C||M),o.forRightToGetElements&&o.forRightToGetElements(C||M),n.setSelectedList(C||M,Ke));break;case"textedit":w=!1,C=null,Xt.mouseUp(e,c,m),w&&(o.mouseCallback&&o.mouseCallback(C||M),o.forRightToGetElements&&o.forRightToGetElements(C||M),n.setSelectedList(C||M,Ke));break;case"rotate":w=!0,C=null,Ke="select";var z=o.undoMgr.finishUndoableChange();z.isEmpty()||ye(z),ct(),_e("changed",M),w&&(o.mouseCallback&&o.mouseCallback(C||M),o.forRightToGetElements&&o.forRightToGetElements(C||M),n.setSelectedList(C||M,Ke));break;case"star":var Z=Ot(i).attr(["r"]);w="0"!=Z.r,C=i,w&&(o.mouseCallback&&o.mouseCallback(C||M),o.forRightToGetElements&&o.forRightToGetElements(C||M),n.setSelectedList(C||M,Ke));break;case"polygon":var W=Ot(i).attr("edge");C=i,(w="0"!=W)&&(o.mouseCallback&&o.mouseCallback(C||M),o.forRightToGetElements&&o.forRightToGetElements(C||M),n.setSelectedList(C||M,Ke))}var q=rt("mouseUp",{event:e,mouse_x:c,mouse_y:m},!0);if(Ot.each(q,(function(e,t){t&&(w=t.keep||w,C=t.element,He=t.started||He)})),w||Ae(C))Ae(C)||(o.addedNew=!0,setTimeout((function(){C.setAttribute("opacity",(null===Bt.prevStyle||void 0===Bt.prevStyle?void 0:Bt.prevStyle.opacity)||_.opacity),C.setAttribute("style","pointer-events:inherit"),ge(C),"path"===Ke?ie.toEditMode(C):r.selectNew&&Wt([C],!0),ye(new Rt(C)),_e("changed",[C])}),200));else{for(d().releaseId(Ee()),C.remove(),C=null,l=e.target;l&&l.parentNode&&l.parentNode.parentNode&&"g"===l.parentNode.parentNode.tagName;)l=l.parentNode;"path"===Ke&&qt||!l||!l.parentNode||"selectorParentGroup"===l.parentNode.id||"svgcanvas"===l.id||"svgroot"===l.id||(o.setMode("select"),Wt([l],!0)),n.switchMode(C||M,Ke),o.mouseCallback&&o.mouseCallback(C||M),o.forRightToGetElements&&o.forRightToGetElements(C||M)}Xe=null}}})),Ot(t).bind("mousewheel DOMMouseScroll",(function(e){if(e.shiftKey){e.preventDefault();var t=e.originalEvent;Pt=Ot("#svgcontent g")[0].getScreenCTM().inverse();var n=Ot("#workarea"),i=r.showRulers?16:0,a=(0,E.DC)(t.pageX,t.pageY,Pt),s=n.width(),l=n.height(),u=s-15-i,c=l-15-i,d=u*Pt.a,h=c*Pt.d,f=n.offset(),m=f.left+i,p=f.top+i,v=t.wheelDelta?t.wheelDelta:t.detail?-t.detail:0;if(v){var y,A,x=Math.max(3/4,Math.min(4/3,v));x>1?(y=Math.ceil(u/d*x*100)/100,A=Math.ceil(c/h*x*100)/100):(y=Math.floor(u/d*x*100)/100,A=Math.floor(c/h*x*100)/100);var b=Math.min(y,A);if((b=Math.min(10,Math.max(.01,b)))!==g){x=b/g;var S=(0,E.DC)(m,p,Pt),C={x:(a.x-(a.x-S.x)/x)*b-i+s/2,y:(a.y-(a.y-S.y)/x)*b-i+l/2};o.setZoom(b),Ot("#zoom").val((100*b).toFixed(1)),_e("updateCanvas",{center:!1,newCtr:C}),_e("zoomDone")}}}}))}();var Ht,Xt=o.textActions=function(){var e,t,n,r,i,a,s,u,c,d,h=[];function f(e){var o=""===t.value;if(Ot(t).focus(),!arguments.length)if(o)e=0;else{if(t.selectionEnd!==t.selectionStart)return;e=t.selectionEnd}var s=h[e];o||t.setSelectionRange(e,e),(n=fe("text_cursor"))||(n=document.createElementNS(b.NS.SVG,"line"),me(n,{id:"text_cursor",stroke:"#333333","stroke-width":1}),n=fe("selectorParentGroup").appendChild(n)),i||(i=setInterval((function(){var e="none"===n.getAttribute("display");n.setAttribute("display",e?"inline":"none")}),600));var l=x(s.x,a.y),u=x(s.x,a.y+a.height);me(n,{x1:l.x,y1:l.y,x2:u.x,y2:u.y,visibility:"visible",display:"inline"}),r&&r.setAttribute("d","")}function m(e,i,o){if(e!==i){o||t.setSelectionRange(e,i),(r=fe("text_selectblock"))||(r=document.createElementNS(b.NS.SVG,"path"),me(r,{id:"text_selectblock",fill:"green",opacity:.5,style:"pointer-events:none"}),fe("selectorParentGroup").append(r));var s=h[e],l=h[i];n.setAttribute("visibility","hidden");var u=x(s.x,a.y),c=x(s.x+(l.x-s.x),a.y),d=x(s.x,a.y+a.height),m=x(s.x+(l.x-s.x),a.y+a.height),g="M"+u.x+","+u.y+" L"+c.x+","+c.y+" "+m.x+","+m.y+" "+d.x+","+d.y+"z";me(r,{d:g,display:"inline"})}else f(i)}function p(t,n){var r=l.createSVGPoint();if(r.x=t,r.y=n,1===h.length)return 0;var i=e.getCharNumAtPosition(r);i<0?(i=h.length-2,t<=h[0].x&&(i=0)):i>=h.length-2&&(i=h.length-2);var a=h[i];return t>a.x+a.width/2&&i++,i}function v(e,t){f(p(e,t))}function y(e,n,r){var i=t.selectionStart,a=p(e,n);m(Math.min(i,a),Math.max(i,a),!r)}function A(e,t){var n={x:e,y:t};if(n.x/=g,n.y/=g,s){var r=(0,E.DC)(n.x,n.y,s.inverse());n.x=r.x,n.y=r.y}return n}function x(e,t){var n={x:e,y:t};if(s){var r=(0,E.DC)(n.x,n.y,s);n.x=r.x,n.y=r.y}return n.x*=g,n.y*=g,n}function S(t){m(0,e.textContent.length),Ot(this).unbind(t)}function C(t){if(d&&e){var n=(0,E.DC)(t.pageX,t.pageY,Pt),r=A(n.x*g,n.y*g),i=p(r.x,r.y),a=e.textContent,o=a.substr(0,i).replace(/[a-z\d]+$/i,"").length,s=a.substr(i).match(/^[a-z\d]+/i);m(o,(s?s[0].length:0)+i),Ot(t.target).click(S),setTimeout((function(){Ot(t.target).unbind("click",S)}),300)}}return{select:function(t,n,r){e=t,Xt.toEditMode(n,r)},start:function(t){e=t,Xt.toEditMode()},mouseDown:function(e,n,r,i){var a=A(r,i);t.focus(),v(a.x,a.y),u=r,c=i},mouseMove:function(e,t){var n=A(e,t);y(n.x,n.y)},mouseUp:function(t,n,r){var i=A(n,r);y(i.x,i.y,!0),t.target!==e&&n<u+2&&n>u-2&&r<c+2&&r>c-2&&Xt.toSelectMode(!0)},setCursor:f,toEditMode:function(t,n){if(d=!1,Ke="textedit",Se.requestSelector(e).showGrips(!1),Se.requestSelector(e),Xt.init(),Ot(e).css("cursor","text"),arguments.length){var r=A(t,n);v(r.x,r.y)}else f();setTimeout((function(){d=!0}),300)},toSelectMode:function(a){Ke="select",clearInterval(i),i=null,r&&Ot(r).attr("display","none"),n&&Ot(n).attr("visibility","hidden"),Ot(e).css("cursor","move"),a&&(Ie(),Ot(e).css("cursor","move"),_e("selected",[e]),Ge([e],!0)),e&&!e.textContent.length&&o.deleteSelectedElements(),Ot(t).blur(),e=!1},setInputElem:function(e){t=e},clear:function(){"textedit"===Ke&&Xt.toSelectMode()},init:function(n){if(e){var r,i;e.parentNode||(e=M[0],Se.requestSelector(e).showGrips(!1));var l=e.textContent.length,u=e.getAttribute("transform");for(a=K(e),s=u?(0,E.Rb)(e):null,(h=[]).length=l,t.focus(),Ot(e).unbind("dblclick",C).dblclick(C),l||(i={x:a.x+a.width/2,width:0}),r=0;r<l;r++){var c=e.getStartPositionOfChar(r);if(i=e.getEndPositionOfChar(r),!(0,k.uy)()){var d=o.contentW*g;c.x-=d,i.x-=d,c.x/=g,i.x/=g}h[r]={x:c.x,y:a.y,width:i.x-c.x,height:a.height}}h.push({x:i.x,width:0}),m(t.selectionStart,t.selectionEnd,!0)}}}}(),Kt=this.removeUnusedDefElems=function(){var e=u.getElementsByTagNameNS(b.NS.SVG,"defs");if(!e||!e.length)return 0;var t,n,r=[],i=0,a=["fill","stroke","filter","marker-start","marker-mid","marker-end"],o=a.length,s=u.getElementsByTagNameNS(b.NS.SVG,"*"),l=s.length;for(t=0;t<l;t++){var c=s[t];for(n=0;n<o;n++){var d=z(c.getAttribute(a[n]));d&&r.push(d.substr(1))}var h=Z(c);h&&h.startsWith("#")&&r.push(h.substr(1))}var f=Ot(e).find("linearGradient, radialGradient, filter, marker, svg, symbol");for(t=f.length;t--;){var m=f[t],g=m.id;r.includes(g)||(qe[g]=m,m.remove(),i++)}return i};function Yt(){Ie();var e=[],t=[],n={feGaussianBlur:Te.exportNoBlur,foreignObject:Te.exportNoforeignObject,"[stroke-dasharray]":Te.exportNoDashArray},r=Ot(u);return"font"in Ot("<canvas>")[0].getContext("2d")||(n.text=Te.exportNoText),Ot.each(n,(function(n,i){r.find(n).length&&(t.push(n),e.push(i))})),{issues:e,issueCodes:t}}this.svgCanvasToString=function(){for(;Kt()>0;);ie.clear(!0),Ot.each(u.childNodes,(function(e,t){e&&8===t.nodeType&&t.data.includes("Created with")&&u.firstChild.before(t)})),v&&(wt(),Wt([v]));var e=[];Ot(u).find("g:data(gsvg)").each((function(){for(var t=this.attributes,n=t.length,r=0;r<n;r++)"id"!==t[r].nodeName&&"style"!==t[r].nodeName||n--;if(n<=0){var i=this.firstChild;e.push(i),Ot(this).replaceWith(i)}}));var t=this.svgToString(u,0);return e.length&&Ot(e).each((function(){ot(this)})),t},this.svgToString=function(e,t){var n=[],i=r.baseUnit,a=new RegExp("^-?[\\d\\.]+"+i+"$");if(e){ge(e);var o=(0,f.Z)(e.attributes),s=e.childNodes;o.sort((function(e,t){return e.name>t.name?-1:1}));for(var l=0;l<t;l++)n.push(" ");if(n.push("<"),n.push(e.nodeName),"svgcontent"===e.id){var u=nn();"px"!==i&&(u.w=(0,C.En)(u.w,i)+i,u.h=(0,C.En)(u.h,i)+i),n.push(' width="'+u.w+'" height="'+u.h+'" xmlns="'+b.NS.SVG+'"');var c={};Ot(e).find("*").andSelf().each((function(){var e=this.namespaceURI;e&&!c[e]&&se[e]&&"xmlns"!==se[e]&&"xml"!==se[e]&&(c[e]=!0,n.push(" xmlns:"+se[e]+'="'+e+'"')),Ot.each(this.attributes,(function(e,t){var r=t.namespaceURI;r&&!c[r]&&"xmlns"!==se[r]&&"xml"!==se[r]&&(c[r]=!0,n.push(" xmlns:"+se[r]+'="'+r+'"'))}))}));for(var d=o.length,h=["width","height","xmlns","x","y","viewBox","id","overflow"];d--;){var m=o[d],g=T(m.value);m.nodeName.startsWith("xmlns:")||""===g||h.includes(m.localName)||m.namespaceURI&&!se[m.namespaceURI]||(n.push(" "),n.push(m.nodeName),n.push('="'),n.push(g),n.push('"'))}}else{if("defs"===e.nodeName&&!e.firstChild)return"";for(var p=["-moz-math-font-style","_moz-math-font-style"],v=o.length-1;v>=0;v--){var y=o[v],A=T(y.value);if(!p.includes(y.localName)){if("null"===A){var x=y.localName.replace(/-[a-z]/g,(function(e){return e[1].toUpperCase()}));if(Object.prototype.hasOwnProperty.call(e.style,x))continue}if(""!==A){if(A.startsWith("pointer-events"))continue;if("class"===y.localName&&A.startsWith("se_"))continue;if(n.push(" "),"d"===y.localName&&(A=ie.convertPath(e,!0)),isNaN(A)?a.test(A)&&(A=(0,C.LX)(A)+i):A=(0,C.LX)(A),Fe.apply&&"image"===e.nodeName&&"href"===y.localName&&Fe.images&&"embed"===Fe.images){var S=je[A];S&&(A=S)}y.namespaceURI&&y.namespaceURI!==b.NS.SVG&&!se[y.namespaceURI]||(n.push(y.nodeName),n.push('="'),n.push(A),n.push('"'))}}}}if(e.hasChildNodes()){n.push(">"),t++;for(var w=!1,E=0;E<s.length;E++){var k=s.item(E);switch(k.nodeType){case 1:n.push("\n"),n.push(this.svgToString(k,t));break;case 3:var N=k.nodeValue.replace(/^\s+|\s+$/g,"");""!==N&&(w=!0,n.push(String(T(N))));break;case 4:n.push("\n"),n.push(new Array(t+1).join(" ")),n.push("<![CDATA["),n.push(k.nodeValue),n.push("]]>");break;case 8:n.push("\n"),n.push(new Array(t+1).join(" ")),n.push("\x3c!--"),n.push(k.data),n.push("--\x3e")}}if(t--,!w){n.push("\n");for(var _=0;_<t;_++)n.push(" ")}n.push("</"),n.push(e.nodeName),n.push(">")}else n.push("/>")}return n.join("")},this.embedImage=function(e){return new Promise((function(t,n){Ot(new Image).load((function(r,i,a){if("error"!==i){var o=document.createElement("canvas");o.width=this.width,o.height=this.height,o.getContext("2d").drawImage(this,0,0);try{var s=";svgedit_url="+encodeURIComponent(e);s=o.toDataURL().replace(";base64",s+";base64"),je[e]=s}catch(t){je[e]=!1}t(je[e])}else n(new Error("Error loading image: "+a.status+" "+a.statusText))})).attr("src",e)}))},this.setGoodImage=function(e){},this.open=function(){},this.save=function(e){Ie(),e&&Ot.extend(Fe,e),Fe.apply=!0;var t=this.svgCanvasToString();_e("saved",t)},this.rasterExport=function(){var e=(0,m.Z)(y().mark((function e(t,n,i){var a,s,l,u,c,d,h,f,m,g=arguments;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=g.length>3&&void 0!==g[3]?g[3]:{},l="image/"+(s="ICO"===t?"BMP":t||"PNG").toLowerCase(),u=Yt(),c=u.issues,d=u.issueCodes,h=this.svgCanvasToString(),Ht){e.next=10;break}return e.next=8,(0,Nt.Qo)(r.canvgPath+"canvg.js",{global:"canvg"});case 8:f=e.sent,Ht=f.canvg;case 10:return Ot("#export_canvas").length||Ot("<canvas>",{id:"export_canvas"}).hide().appendTo("body"),(m=Ot("#export_canvas")[0]).width=o.contentW,m.height=o.contentH,e.next=16,Ht(m,h);case 16:return e.abrupt("return",new Promise((function(e,r){var o,u=s.toLowerCase(),f=n?m.toDataURL("image/"+u,n):m.toDataURL("image/"+u);function g(){var r={datauri:f,bloburl:o,svg:h,issues:c,issueCodes:d,type:t,mimeType:l,quality:n,exportWindowName:i};a.avoidEvent||_e("exported",r),e(r)}m.toBlob?m.toBlob((function(e){o=j(e),g()}),l,n):(o=R(f),g())})));case 17:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),this.exportPDF=function(){var e=(0,m.Z)(y().mark((function e(t){var n,i,a,o,s,l,u,c,d,h,f,m=arguments;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=m.length>1&&void 0!==m[1]?m[1]:(0,k.i7)()?"save":void 0,window.jsPDF){e.next=7;break}return e.next=4,(0,Nt.c7)(["jspdf/underscore-min.js","../../svgedit-myfix/editor/jspdf/jspdf-1.0.150.debug.js"]);case 4:return i=!("svgEditor"in window)||!window.svgEditor||!1!==window.svgEditor.modules,e.next=7,(0,Nt.c7)(r.jspdfPath+"jspdf.plugin.svgToPdf.js",{type:i?"module":"text/javascript"});case 7:return a=nn(),o=a.w>a.h?"landscape":"portrait",s=jsPDF({orientation:o,unit:"pt",format:[a.w,a.h]}),l=rn(),s.setProperties({title:l}),u=Yt(),c=u.issues,d=u.issueCodes,h=this.svgCanvasToString(),s.addSVG(h,0,0),(f={svg:h,issues:c,issueCodes:d,exportWindowName:t,outputType:n=n||"dataurlstring"}).output=s.output(n,"save"===n?t||"svg.pdf":void 0),_e("exportedPDF",f),e.abrupt("return",f);case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),this.getSvgString=function(){return Fe.apply=!1,this.svgCanvasToString()},this.randomizeIds=function(e){!function(e,t){1!=(st=!1===e?2:1)||t.getNonce()?2===st&&t.getNonce()&&t.clearNonce():t.setNonce(Math.floor(100001*Math.random()))}(!(arguments.length>0&&!1===e),d())};var Qt=this.uniquifyElems=function(e){var t={},n=["filter","linearGradient","pattern","radialGradient","symbol","textPath","use"];for(var r in U(e,(function(e){if(1===e.nodeType){e.id&&(e.id in t||(t[e.id]={elem:null,attrs:[],hrefs:[]}),t[e.id].elem=e),Ot.each(De,(function(n,r){var i=e.getAttributeNode(r);if(i){var a=z(i.value),o=a?a.substr(1):null;o&&(o in t||(t[o]={elem:null,attrs:[],hrefs:[]}),t[o].attrs.push(i))}}));var r=Z(e);if(r&&n.includes(e.nodeName)){var i=r.substr(1);i&&(i in t||(t[i]={elem:null,attrs:[],hrefs:[]}),t[i].hrefs.push(e))}}})),t)if(r){var i=t[r].elem;if(i){var a=we();i.id=a;for(var o=t[r].attrs,s=o.length;s--;){var l=o[s];l.ownerElement.setAttribute(l.name,"url(#"+a+")")}for(var u=t[r].hrefs,c=u.length;c--;){var d=u[c];W(d,"#"+a)}}}},Jt=this.setUseData=function(e){var t=Ot(e);"use"!==e.tagName&&(t=t.find("use")),t.each((function(){var e=Z(this).substr(1),t=fe(e);t&&(Ot(this).data("ref",t),"symbol"!==t.tagName&&"svg"!==t.tagName||Ot(this).data("symbol",t).data("ref",t))}))},$t=this.convertGradients=function(e){var t=Ot(e).find("linearGradient, radialGradient");!t.length&&(0,k.VG)()&&(t=Ot(e).find("*").filter((function(){return this.tagName.includes("Gradient")}))),t.each((function(){var e=this;if("userSpaceOnUse"===Ot(e).attr("gradientUnits")){var t=Ot(u).find('[fill="url(#'+e.id+')"],[stroke="url(#'+e.id+')"]');if(!t.length)return;var n=K(t[0]);if(!n)return;if("linearGradient"===e.tagName){var r=Ot(e).attr(["x1","y1","x2","y2"]),i=e.gradientTransform.baseVal;if(i&&i.numberOfItems>0){var a=(0,E.vm)(i).matrix,o=(0,E.DC)(r.x1,r.y1,a),s=(0,E.DC)(r.x2,r.y2,a);r.x1=o.x,r.y1=o.y,r.x2=s.x,r.y2=s.y,e.removeAttribute("gradientTransform")}Ot(e).attr({x1:(r.x1-n.x)/n.width,y1:(r.y1-n.y)/n.height,x2:(r.x2-n.x)/n.width,y2:(r.y2-n.y)/n.height}),e.removeAttribute("gradientUnits")}}}))},en=this.convertToGroup=function(e){e||(e=M[0]);var t,n=Ot(e),r=new Ut;if(n.data("gsvg")){var i=e.firstChild,a=Ot(i).attr(["x","y"]);Ot(e.firstChild.firstChild).unwrap(),Ot(e).removeData("gsvg");var o=(0,S.D9)(e),c=l.createSVGTransform();c.setTranslate(a.x,a.y),o.appendItem(c),(0,Mt._s)(e),_e("selected",[e])}else if(n.data("symbol")){e=n.data("symbol"),t=n.attr("transform");var d=n.attr(["x","y"]),h=e.getAttribute("viewBox");if(h){var f=h.split(" ");d.x-=Number(f[0]),d.y-=Number(f[1])}t+=" translate("+(d.x||0)+","+(d.y||0)+")";var m=n.prev();r.addSubCommand(new jt(n[0],n[0].nextSibling,n[0].parentNode)),n.remove();var g,p=Ot(u).find("use:data(symbol)").length,v=s.createElementNS(b.NS.SVG,"g"),y=e.childNodes;for(g=0;g<y.length;g++)v.append(y[g].cloneNode(!0));if((0,k.hx)()){var A=Ot(q()).children("linearGradient,radialGradient,pattern").clone();Ot(v).append(A)}t&&v.setAttribute("transform",t);var x=e.parentNode;if(Qt(v),(0,k.hx)()&&Ot(q()).append(Ot(v).find("linearGradient,radialGradient,pattern")),v.id=we(),m.after(v),x){if(!p){var C=e.nextSibling;e.remove(),r.addSubCommand(new jt(e,C,x))}r.addSubCommand(new Rt(v))}Jt(v),(0,k.hx)()?$t(q()):$t(v),function(e,t){if(e&&1===e.nodeType){for(var n=e.childNodes.length;n--;)U(e.childNodes.item(n),t);t(e)}}(v,(function(e){try{(0,Mt._s)(e)}catch(e){console.log(e)}})),Ot(v).find(Pe).each((function(){this.id||(this.id=we())})),Wt([v]);var w=dn(v,!0);w&&r.addSubCommand(w),ye(r)}else console.log("Unexpected element to ungroup:",e)};this.setSvgString=function(e,t){try{var n=F(e);if(n.firstElementChild&&n.firstElementChild.namespaceURI!==b.NS.SVG)return!1;this.prepareSvg(n);var i=new Ut("Change Source"),a=u.nextSibling;u.remove();var h=u;i.addSubCommand(new jt(h,a,l)),u=s.adoptNode?s.adoptNode(n.documentElement):s.importNode(n.documentElement,!0),l.append(u);var f=Ot(u);o.current_drawing_=new ht(u,c);var m=d().getNonce();m?_e("setnonce",m):_e("unsetnonce"),f.find("image").each((function(){var e=this;ve(e);var t=Z(this);if(t){if(t.startsWith("data:")){var n=t.match(/svgedit_url=(.*?);/);if(n){var r=decodeURIComponent(n[1]);Ot(new Image).load((function(){e.setAttributeNS(b.NS.XLINK,"xlink:href",r)})).attr("src",r)}}o.embedImage(t)}})),f.find("svg").each((function(){if(!Ot(this).closest("defs").length){Qt(this);var e=this.parentNode;1===e.childNodes.length&&"g"===e.nodeName?(Ot(e).data("gsvg",this),e.id=e.id||we()):ot(this)}})),(0,k.hx)()&&f.find("linearGradient, radialGradient, pattern").appendTo(q()),Jt(f),$t(f[0]);var p={id:"svgcontent",overflow:r.show_outside_canvas?"visible":"hidden"},v=!1;if(f.attr("viewBox")){var y=f.attr("viewBox").split(" ");p.width=y[2],p.height=y[3]}else Ot.each(["width","height"],(function(e,t){var n=f.attr(t)||"100%";"%"===String(n).substr(-1)?v=!0:p[t]=(0,C.R5)(t,n)}));if(ft(),f.children().find(Pe).each((function(){this.id||(this.id=we())})),v){var A=ue();p.width=A.width+A.x,p.height=A.height+A.y}p.width<=0&&(p.width=100),p.height<=0&&(p.height=100),f.attr(p),this.contentW=p.width,this.contentH=p.height,i.addSubCommand(new Rt(u));var x=f.attr(["width","height"]);i.addSubCommand(new Ft(l,x)),g=1,(0,S.GU)(),Ie(),ke={},l.append(Se.selectorParentGroup),t||ye(i),_e("changed",[u])}catch(e){return console.log(e),!1}return!0},this.importSvgString=function(e){var t,n,r;try{var i=P(e.length+e).substr(0,32),a=!1;Ue[i]&&Ot(Ue[i].symbol).parents("#svgroot").length&&(a=!0);var o,l=new Ut("Import Image");if(a)o=Ue[i].symbol,n=Ue[i].xform;else{var c,h=F(e);this.prepareSvg(h),c=s.adoptNode?s.adoptNode(h.documentElement):s.importNode(h.documentElement,!0),Qt(c);var f=(0,C.R5)("width",c.getAttribute("width")),m=(0,C.R5)("height",c.getAttribute("height")),g=c.getAttribute("viewBox"),p=g?g.split(" "):[0,0,f,m];for(t=0;t<4;++t)p[t]=Number(p[t]);var y=Number(u.getAttribute("height"));n="translate(0) "+(n=m>f?"scale("+y/3/p[3]+")":"scale("+y/3/p[2]+")")+" translate(0)",o=s.createElementNS(b.NS.SVG,"symbol");var A=q();for((0,k.hx)()&&Ot(c).find("linearGradient, radialGradient, pattern").appendTo(A);c.firstChild;){var x=c.firstChild;o.append(x)}var S,w=Lt(c.attributes);try{for(w.s();!(S=w.n()).done;){var E=S.value;o.setAttribute(E.nodeName,E.value)}}catch(e){w.e(e)}finally{w.f()}o.id=we(),Ue[i]={symbol:o,xform:n},q().append(o),l.addSubCommand(new Rt(o))}(r=s.createElementNS(b.NS.SVG,"use")).id=we(),W(r,"#"+o.id),(v||d().getCurrentLayer()).append(r),l.addSubCommand(new Rt(r)),Ie(),r.setAttribute("transform",n),(0,Mt._s)(r),Ot(r).data("symbol",o).data("ref",o),Ge([r]),ye(l),_e("changed",[u])}catch(e){return console.log(e),null}return r};var tn={identifyLayers:ft,createLayer:mt,cloneLayer:gt,deleteCurrentLayer:pt,setCurrentLayer:vt,renameCurrentLayer:yt,setCurrentLayerPosition:At,setLayerVisibility:xt,moveSelectedToLayer:bt,mergeLayer:St,mergeAllLayers:Ct,leaveContext:wt,setContext:Et};Object.entries(tn).forEach((function(e){var t=(0,a.Z)(e,2),n=t[0],r=t[1];o[n]=r})),function(e){dt=e}({pathActions:ie,getCurrentGroup:function(){return v},setCurrentGroup:function(e){v=e},getSelectedElements:re,getSVGContent:ne,undoMgr:ce,elData:Oe,getCurrentDrawing:d,clearSelection:Ie,call:_e,addCommandToHistory:ye,changeSVGContent:function(){_e("changed",[u])}}),this.clear=function(){ie.clear(),Ie(),o.clearSvgContentElement(),o.current_drawing_=new ht(u),o.createLayer("Layer 1"),o.undoMgr.resetUndoStack(),Se.initGroup(),$e=Se.getRubberBandBox(),_e("cleared")},this.linkControlPoints=ie.linkControlPoints,this.getContentElem=function(){return u},this.getRootElem=function(){return l};var nn=this.getResolution=function(){return{w:u.getAttribute("width")/g,h:u.getAttribute("height")/g,zoom:g}};this.getSnapToGrid=function(){return r.gridSnapping},this.getVersion=function(){return"svgcanvas.js ($Rev$)"},this.setUiStrings=function(e){Object.assign(Te,e.notification),Ot=(0,x.Z)(Ot,e.common),Ce(e)},this.setConfig=function(e){Object.assign(r,e)},this.getTitle=function(e){if(e=e||M[0]){var t,n=Lt((e=Ot(e).data("gsvg")||Ot(e).data("symbol")||e).childNodes);try{for(n.s();!(t=n.n()).done;){var r=t.value;if("title"===r.nodeName)return r.textContent}}catch(e){n.e(e)}finally{n.f()}return""}},this.setGroupTitle=function(e){var t=M[0];t=Ot(t).data("gsvg")||t;var n,r=Ot(t).children("title"),i=new Ut("Set Label");if(e.length)r.length?(n=r[0],i.addSubCommand(new Ft(n,{"#text":n.textContent})),n.textContent=e):((n=s.createElementNS(b.NS.SVG,"title")).textContent=e,Ot(t).prepend(n),i.addSubCommand(new Rt(n)));else{var a=r.nextSibling;i.addSubCommand(new jt(r[0],a,t)),r.remove()}ye(i)};var rn=this.getDocumentTitle=function(){return o.getTitle(u)};this.setDocumentTitle=function(e){var t,n=u.childNodes,r=!1,i="",a=new Ut("Change Image Title"),o=Lt(n);try{for(o.s();!(t=o.n()).done;){var l=t.value;if("title"===l.nodeName){i=(r=l).textContent;break}}}catch(e){o.e(e)}finally{o.f()}r||(r=s.createElementNS(b.NS.SVG,"title"),u.insertBefore(r,u.firstChild)),e.length?r.textContent=e:r.remove(),a.addSubCommand(new Ft(r,{"#text":i})),ye(a)},this.getEditorNS=function(e){return e&&u.setAttribute("xmlns:se",b.NS.SE),b.NS.SE},this.setResolution=function(e,t){var n,r=nn(),i=r.w,a=r.h;if("fit"===e){var s=ue();if(!s)return!1;n=new Ut("Fit Canvas to Content");var l=le();Ge(l);var c=[],d=[];Ot.each(l,(function(e,t){c.push(-1*s.x),d.push(-1*s.y)}));var h=o.moveSelectedElements(c,d,!0);n.addSubCommand(h),Ie(),e=Math.round(s.width),t=Math.round(s.height)}return e===i&&t===a||(n||(n=new Ut("Change Image Dimensions")),e=(0,C.R5)("width",e),t=(0,C.R5)("height",t),u.setAttribute("width",e),u.setAttribute("height",t),this.contentW=e,this.contentH=t,n.addSubCommand(new Ft(u,{width:i,height:a})),u.setAttribute("viewBox",[0,0,e/g,t/g].join(" ")),n.addSubCommand(new Ft(u,{viewBox:["0 0",i,a].join(" ")})),ye(n),_e("changed",[u])),!0},this.getOffset=function(){return Ot(u).attr(["x","y"])},this.setBBoxZoom=function(e,t,n){var r,i=.85,a=function(e){if(!e)return!1;var r=Math.round(t/e.width*100*i)/100,a=Math.round(n/e.height*100*i)/100,s=Math.min(r,a);return o.setZoom(s),{zoom:s,bbox:e}};if("object"===(0,h.Z)(e)){if(0===(r=e).width||0===r.height){var s=r.zoom?r.zoom:g*r.factor;return o.setZoom(s),{zoom:g,bbox:r}}return a(r)}switch(e){case"selection":if(!M[0])return;var l=Ot.map(M,(function(e){if(e)return e}));r=ue(l);break;case"canvas":var u=nn();i=.95,r={width:u.w,height:u.h,x:0,y:0};break;case"content":r=ue();break;case"layer":r=ue(le(d().getCurrentLayer()));break;default:return}return a(r)},this.setZoom=function(e){var t=nn();u.setAttribute("viewBox","0 0 "+t.w/e+" "+t.h/e),g=e,Ot.each(M,(function(e,t){t&&Se.requestSelector(t).resize()})),ie.zoomChange(),rt("zoomChanged",e)},this.getMode=function(){return Ke},this.setMode=function(e){ie.clear(!0),Xt.clear(),Qe=M[0]&&"text"===M[0].nodeName?ze:_,Ke=e},this.getColor=function(e){return Qe[e]},this.setColor=function(e,t,n){_[e]=t,Qe[e+"_paint"]={type:"solidColor"};var r=[];function i(e){"g"!==e.nodeName&&r.push(e)}for(var a=M.length;a--;){var o=M[a];o&&("g"===o.tagName?U(o,i):"fill"===e?"polyline"!==o.tagName&&"line"!==o.tagName&&r.push(o):r.push(o))}r.length>0&&(n?sn(e,t,r):(ln(e,t,r),_e("changed",r)))};var an=this.setGradient=function(e){if(Qe[e+"_paint"]&&"solidColor"!==Qe[e+"_paint"].type){var t=o[e+"Grad"],n=on(t),r=q();n?t=n:(t=r.appendChild(s.importNode(t,!0))).id=we(),o.setColor(e,"url(#"+t.id+")")}},on=function(e){for(var t=q(),n=Ot(t).find("linearGradient, radialGradient"),r=n.length,i=["r","cx","cy","fx","fy"],a=function(){var t=n[r];if("linearGradient"===e.tagName){if(e.getAttribute("x1")!==t.getAttribute("x1")||e.getAttribute("y1")!==t.getAttribute("y1")||e.getAttribute("x2")!==t.getAttribute("x2")||e.getAttribute("y2")!==t.getAttribute("y2"))return"continue"}else{var a=Ot(e).attr(i),o=Ot(t).attr(i),s=!1;if(Ot.each(i,(function(e,t){a[t]!==o[t]&&(s=!0)})),s)return"continue"}var l=e.getElementsByTagNameNS(b.NS.SVG,"stop"),u=t.getElementsByTagNameNS(b.NS.SVG,"stop");if(l.length!==u.length)return"continue";for(var c=l.length;c--;){var d=l[c],h=u[c];if(d.getAttribute("offset")!==h.getAttribute("offset")||d.getAttribute("stop-opacity")!==h.getAttribute("stop-opacity")||d.getAttribute("stop-color")!==h.getAttribute("stop-color"))break}return-1===c?{v:t}:void 0};r--;){var o=a();if("continue"!==o&&"object"===(0,h.Z)(o))return o.v}return null};this.setPaint=function(e,t){var n=new Ot.jGraduate.Paint(t);switch(this.setPaintOpacity(e,n.alpha/100,!0),Qe[e+"_paint"]=n,n.type){case"solidColor":this.setColor(e,"none"!==n.solidColor?"#"+n.solidColor:"none");break;case"linearGradient":case"radialGradient":o[e+"Grad"]=n[n.type],an(e)}},this.setStrokePaint=function(e){this.setPaint("stroke",e)},this.setFillPaint=function(e){this.setPaint("fill",e)},this.getStrokeWidth=function(){return Qe.stroke_width},this.setStrokeWidth=function(e){if(0===e&&["line","path"].includes(Ke))o.setStrokeWidth(1);else{Qe.stroke_width=e;for(var t=[],n=M.length;n--;){var r=M[n];r&&("g"===r.tagName?U(r,i):t.push(r))}t.length>0&&(ln("stroke-width",e,t),_e("changed",M))}function i(e){"g"!==e.nodeName&&t.push(e)}},this.setStrokeAttr=function(e,t){_[e.replace("-","_")]=t;for(var n=[],r=M.length;r--;){var i=M[r];i&&("g"===i.tagName?U(i,(function(e){"g"!==e.nodeName&&n.push(e)})):n.push(i))}n.length>0&&(ln(e,t,n),_e("changed",M))},this.getStyle=function(){return _},this.getOpacity=Be,this.setOpacity=function(e){_.opacity=e,ln("opacity",e)},this.getFillOpacity=function(){return _.fill_opacity},this.getStrokeOpacity=function(){return _.stroke_opacity},this.setPaintOpacity=function(e,t,n){_[e+"_opacity"]=t,n?sn(e+"-opacity",t):ln(e+"-opacity",t)},this.getPaintOpacity=function(e){return"fill"===e?this.getFillOpacity():this.getStrokeOpacity()},this.getBlur=function(e){var t=0;if(e&&e.getAttribute("filter")){var n=fe(e.id+"_blur");n&&Array.from(n.childNodes).filter((function(e){return"feGaussianBlur"==e.tagName})).map((function(e){t=e.getAttribute("stdDeviation")}))}return t},function(){var e=null,t=null,n=!1;function r(){var n=o.undoMgr.finishUndoableChange();e.addSubCommand(n),ye(e),e=null,t=null}o.setBlurNoUndo=function(e){if(t)if(0===e)sn("filter",""),n=!0;else{var r=M[0];n&&sn("filter","url(#"+r.id+"_blur)"),(0,k.VG)()&&(r.removeAttribute("filter"),r.setAttribute("filter","url(#"+r.id+"_blur)")),sn("stdDeviation",e,[t.firstChild]),o.setBlurOffsets(t,e)}else o.setBlur(e)},o.setBlurOffsets=function(e,t){t>3?me(e,{x:"-50%",y:"-50%",width:"200%",height:"200%"}):(0,k.VG)()||(e.removeAttribute("x"),e.removeAttribute("y"),e.removeAttribute("width"),e.removeAttribute("height"))},o.setBlur=function(n,i){e?r():M.map((function(a){var s=a,l=s.id;t=fe(l+"_blur"),n-=0;var u=new Ut;if(t)0===n&&(t=null);else{var c=V({element:"feGaussianBlur",attr:{in:"SourceGraphic",stdDeviation:n}});(t=V({element:"filter",attr:{id:l+"_blur"}})).append(c),q().append(t),u.addSubCommand(new Rt(t))}var d={filter:s.getAttribute("filter")};if(0===n)return s.removeAttribute("filter"),void u.addSubCommand(new Ft(s,d));ln("filter","url(#"+l+"_blur)"),u.addSubCommand(new Ft(s,d)),o.setBlurOffsets(t,n),e=u;var h=null;t&&(h=t.childNodes.length>2?t.childNodes[1]:t.firstChild),o.undoMgr.beginUndoableChange("stdDeviation",[h||null]),i&&(o.setBlurNoUndo(n),r())}))}}(),this.getBold=function(){var e=M[0];return!(Ae(e)||"text"!==e.tagName||!Ae(M[1]))&&"bold"===e.getAttribute("font-weight")},this.setBold=function(e){var t=M[0];!Ae(t)&&"text"===t.tagName&&Ae(M[1])&&ln("font-weight",e?"bold":"normal"),M[0].textContent||Xt.setCursor()},this.getItalic=function(){var e=M[0];return!(Ae(e)||"text"!==e.tagName||!Ae(M[1]))&&"italic"===e.getAttribute("font-style")},this.setItalic=function(e){var t=M[0];!Ae(t)&&"text"===t.tagName&&Ae(M[1])&&ln("font-style",e?"italic":"normal"),M[0].textContent||Xt.setCursor()},this.getFontFamily=function(){return ze.font_family},this.setFontFamily=function(e){ze.font_family=e,ln("font-family",e),M[0]&&!M[0].textContent&&Xt.setCursor()},this.setFontColor=function(e){ze.fill=e,ln("fill",e)},this.getFontColor=function(){return ze.fill},this.getFontSize=function(){return ze.font_size},this.setFontSize=function(e){ze.font_size=e,ln("font-size",e),M[0].textContent||Xt.setCursor()},this.getText=function(){var e=M[0];return Ae(e)?"":e.textContent},this.setTextContent=function(e){ln("#text",e),Xt.init(e),Xt.setCursor()},this.setImageURL=function(e){var t=M[0];if(t){var n=Ot(t).attr(["width","height"]),r=!n.width||!n.height,i=Z(t);if(i!==e||r){var a=new Ut("Change Image URL");W(t,e),a.addSubCommand(new Ft(t,{"#href":i})),Ot(new Image).load((function(){var e=Ot(t).attr(["width","height"]);Ot(t).attr({width:this.width,height:this.height}),Se.requestSelector(t).resize(),a.addSubCommand(new Ft(t,e)),ye(a),_e("changed",[t])})).attr("src",e)}}},this.setLinkURL=function(e){var t=M[0];if(t){if("a"!==t.tagName){var n=Ot(t).parents("a");if(!n.length)return;t=n[0]}var r=Z(t);if(r!==e){var i=new Ut("Change Link URL");W(t,e),i.addSubCommand(new Ft(t,{"#href":r})),ye(i)}}},this.setRectRadius=function(e){var t=M[0];if(!Ae(t)&&"rect"===t.tagName){var n=t.getAttribute("rx");n!==String(e)&&(t.setAttribute("rx",e),t.setAttribute("ry",e),ye(new Ft(t,{rx:n,ry:n},"Radius")),_e("changed",[t]))}},this.makeHyperlink=function(e){o.groupSelectedElements("a",e)},this.removeHyperlink=function(){o.ungroupSelectedElement()},this.setSegType=function(e){ie.setSegType(e)},this.convertToPath=function(e,t){if(!Ae(e))return t?$(e,V,ie):function(e,t,n,r,i,a,o,s){var l=new o.BatchCommand("Convert element to Path"),u=n({element:"path",attr:t=N.extend({},t,J(e))}),c=e.getAttribute("transform");c&&u.setAttribute("transform",c);var d=e.id,h=e.parentNode;e.nextSibling?e.before(u):h.append(u);var f=Q(e);if(f){if(u.setAttribute("d",f),c){var m=(0,S.D9)(u);(0,E.Dy)(m)&&r.resetOrientation(u)}var g=e.nextSibling;return l.addSubCommand(new o.RemoveElementCommand(e,g,parent)),l.addSubCommand(new o.InsertElementCommand(u)),i(),e.remove(),u.setAttribute("id",d),u.removeAttribute("visibility"),a([u],!0),s(l),u}return u.remove(),null}(e,{fill:_.fill,"fill-opacity":_.fill_opacity,stroke:_.stroke,"stroke-width":_.stroke_width,"stroke-dasharray":_.stroke_dasharray,"stroke-linejoin":_.stroke_linejoin,"stroke-linecap":_.stroke_linecap,"stroke-opacity":_.stroke_opacity,opacity:_.opacity,visibility:"hidden"},V,ie,Ie,Ge,w,ye);var n=M;Ot.each(n,(function(e,t){t&&o.convertToPath(t)}))};var sn=function(e,t,n){"pathedit"===Ke&&ie.moveNode(e,t);for(var r=(n=n||M).length,i=["g","polyline","path"],a=function(){var a=n[r];if(Ae(a))return"continue";if(("x"===e||"y"===e)&&i.includes(a.tagName)){var s=ue([a]),u="x"===e?t-s.x:0,c="y"===e?t-s.y:0;return o.moveSelectedElements(u*g,c*g,!0),"continue"}var d="#text"===e?a.textContent:a.getAttribute(e);if(Ae(d)&&(d=""),d!==String(t)){"#text"===e?(a.textContent=t,/rotate/.test(a.getAttribute("transform"))&&(a=ut(a))):"#href"===e?W(a,t):a.setAttribute(e,t),"textedit"===Ke&&"#text"!==e&&a.textContent.length&&Xt.toSelectMode(a),(0,k.hx)()&&"text"===a.nodeName&&/rotate/.test(a.getAttribute("transform"))&&(String(t).startsWith("url")||["font-size","font-family","x","y"].includes(e)&&a.textContent)&&(a=ut(a)),M.includes(a)&&setTimeout((function(){a.parentNode&&Se.requestSelector(a).resize()}),0);var h=de(a);if(0!==h&&"transform"!==e)for(var f=(0,S.D9)(a),m=f.numberOfItems;m--;)if(4===f.getItem(m).type){f.removeItem(m);var p=K(a),v=(0,E.DC)(p.x+p.width/2,p.y+p.height/2,(0,E.vm)(f).matrix),y=v.x,A=v.y,x=l.createSVGTransform();x.setRotate(h,y,A),f.insertItemBefore(x,m);break}}};r--;)a()},ln=this.changeSelectedAttribute=function(e,t,n){n=n||M,o.undoMgr.beginUndoableChange(e,n),sn(e,t,n);var r=o.undoMgr.finishUndoableChange();r.isEmpty()||ye(r)};this.deleteSelectedElements=function(){for(var e=new Ut("Delete Elements"),t=M.length,n=[],r=0;r<t;++r){var i=M[r];if(Ae(i))break;var a=i.parentNode,o=i;Se.releaseSelector(o),We(o.id),"a"===a.tagName&&1===a.childNodes.length&&(o=a,a=a.parentNode);var s=o.nextSibling;o.remove();var l=o;n.push(i),e.addSubCommand(new jt(l,s,a))}M=[],e.isEmpty()||ye(e),_e("changed",n),Ie()},this.cutSelectedElements=function(){o.copySelectedElements(),o.deleteSelectedElements()};var un="svgedit_clipboard";function cn(){var e=sessionStorage.getItem(un);localStorage.setItem(un,e),setTimeout((function(){localStorage.removeItem(un)}),1)}window.addEventListener("storage",(function(e){e.newValue&&(e.key===un+"_startup"?(localStorage.removeItem(un+"_startup"),cn()):e.key===un&&sessionStorage.setItem(un,e.newValue))}),!1),localStorage.setItem(un+"_startup",Math.random()),this.copySelectedElements=function(){var e=JSON.stringify(M.map((function(e){return O(e)})));sessionStorage.setItem(un,e),cn();var t=Ot("#cmenu_canvas");t.enableContextMenuItems&&t.enableContextMenuItems("#paste,#paste_in_place")},this.pasteElements=function(e,t,n){var r=JSON.parse(sessionStorage.getItem(un));if(r){var i=r.length;if(i){var a=[],s=new Ut("Paste elements"),l={};for(r.forEach((function e(t){t.attr&&t.attr.id&&(l[t.attr.id]=we(),t.attr.id=l[t.attr.id]),t.children&&t.children.forEach(e)})),rt("IDsUpdated",{elems:r,changes:l},!0).forEach((function(e){e&&"remove"in e&&e.remove.forEach((function(e){r=r.filter((function(t){return t.attr.id!==e}))}))}));i--;){var u=r[i];if(u){var c=V(u);a.push(c),s.addSubCommand(new Rt(c)),Re(c)}}if(Wt(a),"in_place"!==e){var d,h;e?"point"===e&&(d=t,h=n):(d=tt.x,h=tt.y);var f=ue(a),m=d-(f.x+f.width/2),g=h-(f.y+f.height/2),p=[],v=[];Ot.each(a,(function(e,t){p.push(m),v.push(g)}));var y=o.moveSelectedElements(p,v,!1);y&&s.addSubCommand(y)}ye(s),_e("changed",a)}}},this.groupSelectedElements=function(e,t){e||(e="g");var n,r="";"a"===e?(r="Make hyperlink",n=t||""):(e="g",r="Group Elements");var i=new Ut(r),a=V({element:e,attr:{id:we()}});"a"===e&&W(a,n),i.addSubCommand(new Rt(a));for(var o=M.length;o--;){var s=M[o];if(!Ae(s)){"a"===s.parentNode.tagName&&1===s.parentNode.childNodes.length&&(s=s.parentNode);var l=s.nextSibling,u=s.parentNode;a.append(s),i.addSubCommand(new Vt(s,l,u))}}i.isEmpty()||ye(i),Wt([a],!0)};var dn=this.pushGroupProperties=function(e,t){for(var n,r,i,a=e.childNodes,s=a.length,u=e.getAttribute("transform"),c=(0,S.D9)(e),h=(0,E.vm)(c).matrix,f=new Ut("Push group properties"),m=de(e),g=Ot(e).attr(["filter","opacity"]),p=d(),v=0;v<s;v++){var y=a[v];if(1===y.nodeType){if(null!==g.opacity&&1!==g.opacity){var A=Math.round((y.getAttribute("opacity")||1)*g.opacity*100)/100;ln("opacity",A,[y])}if(g.filter){var x=this.getBlur(y),b=x;r||(r=this.getBlur(e)),x?x=Number(r)+Number(x):0===x&&(x=r),b?n=he(y.getAttribute("filter")):n?(n=p.copyElem(n),q().append(n)):n=he(g.filter);var C="feGaussianBlur"===n.firstChild.tagName?"blur":"filter";n.id=y.id+"_"+C,ln("filter","url(#"+n.id+")",[y]),x&&(ln("stdDeviation",x,[n.firstChild]),o.setBlurOffsets(n,x))}var w=(0,S.D9)(y);if(y.tagName.includes("Gradient")&&(w=null),w&&"defs"!==y.tagName&&c.numberOfItems){if(m&&1===c.numberOfItems){var k=c.getItem(0).matrix,N=l.createSVGMatrix(),_=de(y);_&&(N=w.getItem(0).matrix);var M=K(y),I=(0,E.vm)(w).matrix,G=(0,E.DC)(M.x+M.width/2,M.y+M.height/2,I),B=m+_,L=l.createSVGTransform();L.setRotate(B,G.x,G.y);var T=(0,E.h9)(k,N,L.matrix.inverse());if(_&&w.removeItem(0),B&&(w.numberOfItems?w.insertItemBefore(L,0):w.appendItem(L)),T.e||T.f){var P=l.createSVGTransform();P.setTranslate(T.e,T.f),w.numberOfItems?w.insertItemBefore(P,0):w.appendItem(P)}}else{var D=y.getAttribute("transform");(i={}).transform=D||"";var O=l.createSVGTransform(),V=(0,E.vm)(w).matrix,R=V.inverse(),j=(0,E.h9)(R,h,V);O.setMatrix(j),w.appendItem(O)}var F=(0,Mt._s)(y);F&&f.addSubCommand(F)}}}if(u&&((i={}).transform=u,e.setAttribute("transform",""),e.removeAttribute("transform"),f.addSubCommand(new Ft(e,i))),t&&!f.isEmpty())return f};this.ungroupSelectedElement=function(){var e=M[0];if(e)if(Ot(e).data("gsvg")||Ot(e).data("symbol"))en(e);else{if("use"===e.tagName){var t=fe(Z(e).substr(1));return Ot(e).data("symbol",t).data("ref",t),void en(e)}var n=Ot(e).parents("a");if(n.length&&(e=n[0]),"g"===e.tagName||"a"===e.tagName){var r=new Ut("Ungroup Elements"),i=dn(e,!0);i&&r.addSubCommand(i);for(var a=e.parentNode,o=e.nextSibling,s=new Array(e.childNodes.length),l=0;e.firstChild;){var u=e.firstChild,c=u.nextSibling,d=u.parentNode;if("title"!==u.tagName)o?o.before(u):e.after(u),s[l++]=u,r.addSubCommand(new Vt(u,c,d));else{var h=u.nextSibling;r.addSubCommand(new jt(u,h,d)),u.remove()}}Ie();var f=e.nextSibling;e.remove(),r.addSubCommand(new jt(e,f,a)),r.isEmpty()||ye(r),Ge(s)}}},this.moveToTopSelectedElement=function(){var e=M,t=(0,a.Z)(e,1)[0];if(!Ae(t)){var n=t,r=n.parentNode,i=n.nextSibling;i!==(n=n.parentNode.appendChild(n)).nextSibling&&(ye(new Vt(n,i,r,"top")),_e("changed",[n]))}},this.moveToBottomSelectedElement=function(e){var t=M,n=(0,a.Z)(t,1)[0];if(!Ae(n)){var r=n,i=r.parentNode,o=r.nextSibling,s=Array.from(r.parentNode.childNodes).filter((function(t){return t.id==e.dropKey}));if("title"===s.tagName&&(s=s.nextSibling),"text"===s.tagName&&(s=s[0].nextSibling),!s[0].nextElementSibling)return void this.moveToTopSelectedElement();"defs"===(s=s[0].nextElementSibling).tagName&&(s=s.nextSibling),o!==(r=r.parentNode.insertBefore(r,s)).nextSibling&&(ye(new Vt(r,o,i,"bottom")),_e("changed",[r]))}},this.moveUpDownSelected=function(e){var t=M[0];if(t){var n,r;et=[];var i=Ot(it(ue([t]))).toArray();if("Down"===e&&i.reverse(),Ot.each(i,(function(){return r?(n=this,!1):(this===t&&(r=!0),!0)})),n){var a=t,o=a.parentNode,s=a.nextSibling;Ot(n)["Down"===e?"before":"after"](a),s!==a.nextSibling&&(ye(new Vt(a,s,o,"Move "+e)),_e("changed",[a]))}}},this.moveSelectedElements=function(e,t,n){e.constructor!==Array&&(e/=g,t/=g),n=n||!0;for(var r=new Ut("position"),i=M.length;i--;){var a=M[i];if(!Ae(a)){var o=l.createSVGTransform(),s=(0,S.D9)(a);e.constructor===Array?o.setTranslate(e[i],t[i]):o.setTranslate(e,t),s.numberOfItems?s.insertItemBefore(o,0):s.appendItem(o);var u=(0,Mt._s)(a);u&&r.addSubCommand(u),Se.requestSelector(a).resize()}}if(!r.isEmpty())return n&&ye(r),_e("changed",M),r},this.cloneSelectedElements=function(e,t){var n,r,i=new Ut("Clone Elements"),a=M.length;for(M.sort((function(e,t){return Ot(t).index()-Ot(e).index()})),n=0;n<a&&(r=M[n],!Ae(r));++n);var o=M.slice(0,n);this.clearSelection(!0);var s=d();for(n=o.length;n--;)r=o[n]=s.copyElem(o[n]),(v||s.getCurrentLayer()).append(r),i.addSubCommand(new Rt(r));i.isEmpty()||(Ge(o.reverse()),this.moveSelectedElements(e,t,!1),ye(i))},this.alignSelectedElements=function(e,t){var n=[],r=M.length;if(r){for(var i=Number.MAX_VALUE,a=Number.MIN_VALUE,s=Number.MAX_VALUE,l=Number.MIN_VALUE,u=Number.MIN_VALUE,c=Number.MIN_VALUE,d=0;d<r&&!Ae(M[d]);++d){var h=M[d];switch(n[d]=ue([h]),t){case"smallest":(("l"===e||"c"===e||"r"===e)&&(u===Number.MIN_VALUE||u>n[d].width)||("t"===e||"m"===e||"b"===e)&&(c===Number.MIN_VALUE||c>n[d].height))&&(i=n[d].x,s=n[d].y,a=n[d].x+n[d].width,l=n[d].y+n[d].height,u=n[d].width,c=n[d].height);break;case"largest":(("l"===e||"c"===e||"r"===e)&&(u===Number.MIN_VALUE||u<n[d].width)||("t"===e||"m"===e||"b"===e)&&(c===Number.MIN_VALUE||c<n[d].height))&&(i=n[d].x,s=n[d].y,a=n[d].x+n[d].width,l=n[d].y+n[d].height,u=n[d].width,c=n[d].height);break;default:n[d].x<i&&(i=n[d].x),n[d].y<s&&(s=n[d].y),n[d].x+n[d].width>a&&(a=n[d].x+n[d].width),n[d].y+n[d].height>l&&(l=n[d].y+n[d].height)}}"page"===t&&(i=0,s=0,a=o.contentW,l=o.contentH);for(var f=new Array(r),m=new Array(r),g=0;g<r&&!Ae(M[g]);++g){var p=n[g];switch(f[g]=0,m[g]=0,e){case"l":f[g]=i-p.x;break;case"c":f[g]=(i+a)/2-(p.x+p.width/2);break;case"r":f[g]=a-(p.x+p.width);break;case"t":m[g]=s-p.y;break;case"m":m[g]=(s+l)/2-(p.y+p.height/2);break;case"b":m[g]=l-(p.y+p.height)}}this.moveSelectedElements(f,m)}},this.contentW=nn().w,this.contentH=nn().h,this.updateCanvas=function(e,t){l.setAttribute("width",e),l.setAttribute("height",t);var n=Ot("#canvasBackground")[0],r=u.getAttribute("x"),i=u.getAttribute("y"),a=(e-this.contentW*g)/2,o=(t-this.contentH*g)/2;me(u,{width:this.contentW*g,height:this.contentH*g,x:a,y:o,viewBox:"0 0 "+this.contentW+" "+this.contentH}),me(n,{width:u.getAttribute("width"),height:u.getAttribute("height"),x:a,y:o});var s=fe("background_image");return s&&me(s,{width:"100%",height:"100%"}),Se.selectorParentGroup.setAttribute("transform","translate("+a+","+o+")"),rt("canvasUpdated",{new_x:a,new_y:o,old_x:r,old_y:i,d_x:a-r,d_y:o-i}),{x:a,y:o,old_x:r,old_y:i,d_x:a-r,d_y:o-i}},this.setBackground=function(e,t){var n=fe("canvasBackground"),r=Ot(n).find("rect")[0],i=fe("background_image"),a=fe("background_pattern");if(r&&r.setAttribute("fill","chessboard"===e?"#fff":e),r&&r.setAttribute("stroke","chessboard"===e?"#fff":e),"chessboard"===e){if(!a){a=s.createElementNS(b.NS.SVG,"foreignObject"),me(a,{id:"background_pattern",width:"100%",height:"100%",preserveAspectRatio:"xMinYMin",style:"pointer-events:none"});var o=document.createElement("div");me(o,{style:"pointer-events:none;width:100%;height:100%;background-image:url(data:image/gif;base64,R0lGODlhEAAQAIAAAP///9bW1iH5BAAAAAAALAAAAAAQABAAAAIfjG+gq4jM3IFLJgpswNly/XkcBpIiVaInlLJr9FZWAQA7);"}),a.appendChild(o),n.append(a)}}else a&&a.remove();t?(i||(i=s.createElementNS(b.NS.SVG,"image"),me(i,{id:"background_image",width:"100%",height:"100%",preserveAspectRatio:"xMinYMin",style:"pointer-events:none"})),W(i,t),n.append(i)):i&&i.remove()},this.cycleElement=function(e){var t,n=M[0],r=!1,i=le(v||d().getCurrentLayer());if(i.length){if(Ae(n))r=i[t=e?i.length-1:0];else for(var a=i.length;a--;)if(i[a]===n){(t=e?a-1:a+1)>=i.length?t=0:t<0&&(t=i.length-1),r=i[t];break}Wt([r],!0),_e("selected",M)}},this.clear(),this.getPrivateMethods=function(){return{addCommandToHistory:ye,BatchCommand:Ut,ChangeElementCommand:Ft,decode64:D,encode64:P,ffClone:ut,findDefs:q,findDuplicateGradient:on,getElem:fe,getPathBBox:H,getTypeMap:C.X9,getUrlFromAttr:z,identifyLayers:ft,InsertElementCommand:Rt,isChrome:k.i7,isIdentity:E.GU,isIE:k.w1,logMatrix:Tt,MoveElementCommand:Vt,NS:b.NS,preventClickDefault:ve,RemoveElementCommand:jt,SVGEditTransformList:S.MU,text2xml:F,transformBox:E.D2,transformPoint:E.DC,walkTree:U}}}));const qt=Wt;var Ht=n(3379),Xt=n.n(Ht),Kt=n(1);Xt()(Kt.Z,{insert:"head",singleton:!1}),Kt.Z.locals;var Yt=n(4648);function Qt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Jt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qt(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $t=function(e){var t=e.cellKey,n=e.code,r=(e.changeDMode,e.mergeParams,e.mode),l=void 0===r?null:r,d=(e.time,e.file),h=(0,c.use)("svg.tool"),f=(0,a.Z)(h,2),m=f[0],g=(f[1],(0,c.use)("cell.params",t,"base")),p=(0,a.Z)(g,2),v=(p[0],p[1]),y=(0,o.useRef)(null),A=(0,o.useRef)(null),x=y.current,b=(window.airiotSVG,function(e,t){var n=u().isArray(e)?e:[e];1==e.length&&"path"==e[0].tagName&&(0,Yt.V5)(y.current,e[0].id,A.current),1==e.length&&"polyline"==e[0].tagName&&(0,Yt.OM)(e[0]);var r=["fhpath","line","rect","ellipse","path","image"].includes(t)?t:"select";window.airiotSVG=Jt(Jt({},window.airiotSVG||{}),{},{selectList:n,mode:t||r,isLeft:!1})}),S=function(e,t){var n=u().isArray(e)?e:[e];window.airiotSVG=Jt(Jt({},window.airiotSVG||{}),{},{selectList:n,mode:t})};(0,o.useLayoutEffect)((function(){var r=A.current.clientWidth,a=A.current.clientHeight,o={initFill:{color:"FFFFFF",opacity:1},initStroke:{color:"000000",opacity:1,width:1},text:{stroke_width:0,font_size:24,font_family:"serif"},initOpacity:1,dimensions:[r,a],baseUnit:"px",setSelectedList:b,mouseCallback:null,forRightToGetElements:null,switchMode:S},s=new qt(A.current,o);if(s.setMode("select"),s.updateCanvas(r,a),s.setBackground("rgba(0,0,0,0)"),y.current=s,window.airiotSVG=Jt(Jt({},window.airiotSVG||{}),{},(0,i.Z)({},t,s)),n){var l=n.replace(/width="NaN"/,'width="'.concat(r,'"'));l=(l=l.replace(/height="NaN"/,'height="'.concat(a,'"'))).slice(0,4)+' x="0" y="0" '+l.slice(4),s&&s.setSvgString(l),en(e,s,A)}var u=document.querySelector("#svgcontent").getAttribute("viewBox");document.querySelector("#canvasBackground").setAttribute("width",(null==u?void 0:u.split(" ")[2])||r),document.querySelector("#svgcontent").setAttribute("width",(null==u?void 0:u.split(" ")[2])||r),document.querySelector("#svgroot").setAttribute("width",r),u&&document.querySelector("#svgroot").setAttribute("viewBox",u),document.querySelector("#canvasBackground").setAttribute("height",(null==u?void 0:u.split(" ")[3])||a),document.querySelector("#svgcontent").setAttribute("height",(null==u?void 0:u.split(" ")[3])||a),document.querySelector("#svgcontent").setAttribute("preserveAspectRatio","none"),document.querySelector("#svgcontent").removeAttribute("viewBox"),document.querySelector("#svgroot").setAttribute("height",a),document.querySelector("#svgcontent").setAttribute("style","")}),[d]),s().useEffect((function(){x&&en(e,x,A,l),"svg"==l&&x&&!["pathedit","path"].includes(x.getMode())&&(0,Yt.S9)({svg:x,setParams:v,cellKey:t})}),[m,d]);var C=function(){e.changeDMode("svg"),x&&x.setMode(null)};return s().useMemo((function(){return s().createElement("div",{style:{height:"100%"},ref:A,id:"svg_container"+(null==e?void 0:e.cellKey),onDoubleClick:C})}),[])},en=function(e,t,n,r){var i,o,s,l,u,c,d,h,f,m,g,p,v,y,A,x,b=e.customVar,S=void 0===b?{}:b,C=Object.keys(S).filter((function(e){return e.includes("#")}));l=null!==(i=n.current.childNodes)&&void 0!==i&&i[0]&&null!==(o=Array.from(null===(s=n.current.childNodes)||void 0===s?void 0:s[0].childNodes).filter((function(e){return"svgcontent"==e.id})))&&void 0!==o&&o[0]?null!==(u=n.current)&&void 0!==u&&null!==(c=u.childNodes)&&void 0!==c&&c[0]?null===(d=Array.from(null===(h=Array.from((null===(f=n.current)||void 0===f||null===(m=f.childNodes)||void 0===m?void 0:m[0].childNodes)||[]).filter((function(e){return"svgcontent"==e.id})))||void 0===h?void 0:h[0].childNodes).filter((function(e){return"g"==e.tagName})))||void 0===d?void 0:d[0].childNodes:[]:null!==(g=n.current)&&void 0!==g&&null!==(p=g.childNodes)&&void 0!==p&&p[0]?null===(v=Array.from((null===(A=n.current)||void 0===A||null===(x=A.childNodes)||void 0===x?void 0:x[0].childNodes)||[]).filter((function(e){return"g"==e.tagName})))||void 0===v||null===(y=v[0])||void 0===y?void 0:y.childNodes:[],C.map((function(e){var t=e.split("#"),i=e.split("#"),o=(0,a.Z)(i,3),s=o[0],u=o[1],c=o[2];if(2==t.length)(0,Yt.IQ)(s,u,null==S?void 0:S[e],n,r);else if(3==t.length){var d,h=Array.from(l).filter((function(e){return e.id==s}))[0];null===(d=(h?Array.from(h.childNodes).filter((function(e){return"animate"==e.tagName})):[])[c])||void 0===d||d.setAttribute(u,null==S?void 0:S[e])}else{var f=e.split("#"),m=(0,a.Z)(f,4),g=m[0],p=(m[1],m[2]),v=m[3],y=Array.from(n.current.childNodes[0].childNodes[3].childNodes).filter((function(e){return e.id==g}));if(!y[0])return;var A=Array.from(y[0].childNodes).filter((function(e){return"animate"==e.tagName}));A.map((function(t,n){v==n&&t.setAttribute(p,"dur"==p?(null==S?void 0:S[e])+"s":null==S?void 0:S[e])}))}}))},tn=function(e){var t=e.cellKey,n=e.code,r=e.changeDMode,i=(e.mode,e.time),a=(e.isFront,e.mergeParams,e.preserveAspectRatio),l=(e.editMode,(0,c.use)("dashboard.mode")),u=(0,o.useRef)();(0,o.useLayoutEffect)((function(){if(n){var t,r=u.current,o=r.clientWidth,s=r.clientHeight,l="";if(null==n||n.indexOf("="),null==n||n.indexOf("height"),null==n||n.indexOf("xmlns"),n&&(l=(l=n.replace(/width="NaN"/,'width="'.concat(o,'"'))).replace(/height="NaN"/,'height="'.concat(s,'"'))),r.innerHTML=l,en(e,null,u),null!=r&&null!==(t=r.childNodes)&&void 0!==t&&t[0]){var c,d,h,f,m,g,p,v,y,A,x,b,S,C,w,E,k,N,_,M,I,G,B=null===(c=Array.from((null==r||null===(h=r.childNodes)||void 0===h||null===(f=h[0])||void 0===f?void 0:f.childNodes)||[]).filter((function(e){return"g"==e.tagName})))||void 0===c||null===(d=c[0])||void 0===d?void 0:d.childNodes;null==u||null===(m=u.current)||void 0===m||null===(g=m.childNodes)||void 0===g||null===(p=g[(null==u||null===(v=u.current)||void 0===v||null===(y=v.childNodes)||void 0===y?void 0:y.length)>1?2:0])||void 0===p||p.setAttribute("width","100%"),null==u||null===(A=u.current)||void 0===A||null===(x=A.childNodes)||void 0===x||null===(b=x[(null==u||null===(S=u.current)||void 0===S||null===(C=S.childNodes)||void 0===C?void 0:C.length)>1?2:0])||void 0===b||b.setAttribute("height","100%"),a?null==r||null===(w=r.childNodes)||void 0===w||null===(E=w[(null==u||null===(k=u.current)||void 0===k||null===(N=k.childNodes)||void 0===N?void 0:N.length)>1?2:0])||void 0===E||E.setAttribute("preserveAspectRatio",""):null==r||null===(_=r.childNodes)||void 0===_||null===(M=_[(null==u||null===(I=u.current)||void 0===I||null===(G=I.childNodes)||void 0===G?void 0:G.length)>1?2:0])||void 0===M||M.setAttribute("preserveAspectRatio","none"),Array.from(B||[]).map((function(e){if("title"!=e.tagName&&e.tagName){var t=!e.getAttribute("data-isrun")||!!Number(e.getAttribute("data-isrun"));if(e.getAttribute("style")){var n=e.getAttribute("style");e.setAttribute("style",t?n.replace(" 0ms"," 1000ms"):n.replace(" 1000ms"," 0ms"))}else e.style.animation="dash ".concat(t?i:0,"ms linear infinite")}}))}}}),[e]);var h=function(e){l&&r("svg")};return s().createElement("div",{style:{width:"100%",height:"100%"},onDoubleClick:h},!n&&s().createElement(d.C,{is:"NoData",style:{position:"absolute",left:0,right:0,top:"50%",marginTop:-80,color:"#999999"},description:_t1("双击组件，可进入SVG编辑模式或直接上传svg内容")}),s().createElement("div",{style:{height:"100%",position:"relative"},id:"svg_container"+t,ref:u,onDoubleClick:h}))};const nn=function(e){var t=(0,c.use)("editor.mode"),n=(0,a.Z)(t,2),i=n[0],o=n[1],l=(0,c.use)("editor.selected"),u=(0,c.use)("cell.params",null==e?void 0:e.cellKey,"base"),d=(0,a.Z)(u,2),h=(d[0],d[1]);return s().createElement(s().Fragment,null,"svg"!=i||(null==e?void 0:e.cellKey)!=l[0]?s().createElement(tn,(0,r.Z)({changeDMode:function(e){o(e)},editMode:{}},e)):s().createElement($t,(0,r.Z)({changeDMode:function(e){o(e)},mode:i},e,{setParams:h})))}},1:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(4015),i=n.n(r),a=n(3645),o=n.n(a)()(i());o.push([e.id,"#canvasBackground {\n  width: 100%;\n  height: 100%;\n}\n#svgcontent {\n  width: 100%;\n  height: 100%;\n}\n#svgroot {\n  width: 100%;\n  height: 100%;\n}\n#tools_left {\n  position: absolute;\n  border-right: none;\n  width: 50px;\n  top: 27px;\n  bottom: 0;\n  left: -27px;\n  background: none;\n  z-index: 4;\n}\n#tools_left .tool_button {\n  height: 27px;\n  width: 27px;\n  border: solid #2f2f2c 1px;\n  border-left-width: 1px;\n  margin: 0;\n  background-color: #ddd;\n  cursor: pointer;\n  padding: 0px;\n}\n#tools_left .tool_button .tool_button_current .tool_button_pressed {\n  cursor: pointer;\n}\n#tools_left .tool_button:hover,\n#tools_left .push_button:hover,\n#tools_left .buttonup:hover,\n#tools_left .buttondown,\n#tools_left .tool_button_current,\n#tools_left .push_button_pressed {\n  background-color: #fff;\n}\n#tools_left .tool_button_current:after {\n  position: absolute;\n  content: '';\n  border: solid #2f2f2c 2px;\n  top: -1px;\n  left: -1px;\n  width: 26px;\n  height: 26px;\n  z-index: 0;\n}\n#tools_left .tool_button_current {\n  background-color: #0cf;\n}\n#tool_open input,\n#tool_import input,\n#tool_image input {\n  position: absolute;\n  opacity: 0;\n  font-size: 10em;\n  top: -5px;\n  right: -5px;\n  margin: 0;\n  cursor: pointer;\n  /* Sadly doesn't appear to have an effect */\n}\n#main_icon {\n  position: relative;\n  top: -2px;\n  left: -2px;\n  width: 95px;\n  line-height: 26px;\n}\n#main_icon:hover {\n  background: #eee !important;\n}\n#main_icon.buttondown {\n  background: #eee !important;\n  -moz-box-shadow: none !important;\n  -webkit-box-shadow: none !important;\n  box-shadow: none !important;\n  border-radius: 3px 3px 0 0;\n}\n#main_icon > div {\n  float: left;\n}\n#main_button .dropdown {\n  position: absolute;\n  right: 7px;\n  top: 4px;\n}\n#main_icon span {\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  display: block;\n  z-index: 2;\n  font-weight: bold;\n  padding-left: 34px;\n  line-height: 32px;\n  font-family: sans-serif;\n}\n#main_menu {\n  z-index: 12;\n  background: #eee;\n  position: relative;\n  width: 230px;\n  padding: 5px;\n  -moz-box-shadow: #555 1px 1px 4px;\n  -webkit-box-shadow: #555 1px 1px 4px;\n  box-shadow: #555 1px 1px 4px;\n  font-size: 1.1em;\n  display: none;\n  overflow: hidden;\n  clear: both;\n  top: -9px;\n}\n#main_menu ul,\n#main_menu li {\n  list-style: none;\n  margin: 0;\n  padding: 0;\n}\n#main_menu li {\n  /*  height: 35px;*/\n  line-height: 22px;\n  padding-top: 7px;\n  padding-left: 7px;\n  margin: -5px;\n  overflow: auto;\n  cursor: pointer;\n}\n#main_menu li:hover {\n  background: #FFC;\n}\n#main_menu li > div {\n  float: left;\n  padding-right: 5px;\n}\n#main_menu p {\n  margin-top: 5px;\n}\n#color_picker {\n  position: absolute;\n  display: none;\n  background: #E8E8E8;\n  height: 350px;\n  z-index: 5;\n}\n.icon_label {\n  float: left;\n  padding-top: 3px;\n  padding-right: 3px;\n  box-sizing: border-box;\n  -moz-box-sizing: border-box;\n  -webkit-box-sizing: border-box;\n  height: 0;\n}\n#bg_blocks .color_block {\n  position: static;\n}\n#svg_prefs_container div.color_block {\n  float: left;\n  margin: 2px;\n  padding: 20px;\n}\n#stroke_bg,\n#fill_bg {\n  height: 16px;\n  width: 16px;\n  margin: 1px;\n}\n.dropdown li.tool_button {\n  width: 24px;\n}\n@keyframes dash {\n  to {\n    stroke-dashoffset: 0;\n  }\n}\nsvg:not(:root) {\n  overflow: hidden;\n}\n","",{version:3,sources:["webpack://./src/styles/index.less"],names:[],mappings:"AAAA;EACE,WAAA;EACA,YAAA;AACF;AACA;EACE,WAAA;EACA,YAAA;AACF;AAEA;EACE,WAAA;EACA,YAAA;AAAF;AAGE;EAEE,kBAAA;EACA,kBAAA;EACA,WAAA;EACA,SAAA;EACA,SAAA;EACA,WAAA;EACA,gBAAA;EACA,UAAA;AAFJ;AAPE;EAYI,YAAA;EACA,WAAA;EACA,yBAAA;EACA,sBAAA;EACA,SAAA;EACA,sBAAA;EACA,eAAA;EACA,YAAA;AAFN;AAjBE;EAuBI,eAAA;AAHN;AApBE;;;;;;EAiCI,sBAAA;AALN;AA5BE;EAqCI,kBAAA;EACA,WAAA;EACA,yBAAA;EACA,SAAA;EACA,UAAA;EACA,WAAA;EACA,YAAA;EACA,UAAA;AANN;AAtCE;EA+CI,sBAAA;AANN;AASA;;;EAGE,kBAAA;EACA,UAAA;EACA,eAAA;EACA,SAAA;EACA,WAAA;EACA,SAAA;EACA,eAAA;EAPA,2CAA2C;AAC7C;AAUA;EACE,kBAAA;EACA,SAAA;EACA,UAAA;EACA,WAAA;EACA,iBAAA;AARF;AAWA;EACE,2BAAA;AATF;AAYA;EACE,2BAAA;EACA,gCAAA;EACA,mCAAA;EACA,2BAAA;EACA,0BAAA;AAVF;AAcA;EACE,WAAA;AAZF;AAeA;EACE,kBAAA;EACA,UAAA;EACA,QAAA;AAbF;AAgBA;EACE,kBAAA;EACA,MAAA;EACA,OAAA;EACA,SAAA;EACA,QAAA;EACA,cAAA;EACA,UAAA;EACA,iBAAA;EACA,kBAAA;EACA,iBAAA;EACA,uBAAA;AAdF;AAiBA;EACE,WAAA;EACA,gBAAA;EACA,kBAAA;EACA,YAAA;EACA,YAAA;EACA,iCAAA;EACA,oCAAA;EACA,4BAAA;EACA,gBAAA;EACA,aAAA;EACA,gBAAA;EACA,WAAA;EACA,SAAA;AAfF;AAkBA;;EAEE,gBAAA;EACA,SAAA;EACA,UAAA;AAhBF;AAmBA;EAjBE,kBAAkB;EAmBlB,iBAAA;EACA,gBAAA;EACA,iBAAA;EACA,YAAA;EACA,cAAA;EACA,eAAA;AAjBF;AAoBA;EACE,gBAAA;AAlBF;AAqBA;EACE,WAAA;EACA,kBAAA;AAnBF;AAsBA;EACE,eAAA;AApBF;AAuBA;EACE,kBAAA;EACA,aAAA;EACA,mBAAA;EACA,aAAA;EACA,UAAA;AArBF;AAyBA;EACE,WAAA;EACA,gBAAA;EACA,kBAAA;EACA,sBAAA;EACA,2BAAA;EACA,8BAAA;EACA,SAAA;AAvBF;AA0BA;EACE,gBAAA;AAxBF;AA0BA;EACE,WAAA;EACA,WAAA;EACA,aAAA;AAxBF;AA0BA;;EAEE,YAAA;EACA,WAAA;EACA,WAAA;AAxBF;AA2BA;EACE,WAAA;AAzBF;AA+BA;EACE;IACE,oBAAA;EA7BF;AACF;AAgCA;EACE,gBAAA;AA9BF",sourcesContent:["#canvasBackground {\n  width: 100%;\n  height: 100%;\n}\n#svgcontent {\n  width: 100%;\n  height: 100%;\n}\n\n#svgroot {\n  width: 100%;\n  height: 100%;\n}\n\n  #tools_left {\n    \n    position: absolute;\n    border-right: none;\n    width: 50px;\n    top: 27px;\n    bottom: 0;\n    left: -27px ;\n    background: none;\n    z-index: 4;\n\n    .tool_button { \n      height:27px;\n      width:27px;\n      border:solid #2f2f2c 1px;\n      border-left-width:1px;\n      margin:0;\n      background-color:#ddd;\n      cursor:pointer;\n      padding: 0px;\n    }\n\n    .tool_button .tool_button_current .tool_button_pressed {\n      cursor: pointer;\n    }\n\n    .tool_button:hover, \n    .push_button:hover,\n    .buttonup:hover,\n    .buttondown,\n    .tool_button_current,\n    .push_button_pressed\n    {\n      background-color: #fff;\n    }\n\n    .tool_button_current:after {\n      position: absolute;\n      content: '';\n      border: solid #2f2f2c 2px;\n      top: -1px;\n      left: -1px;\n      width: 26px;\n      height: 26px;\n      z-index: 0;\n    }\n    .tool_button_current {\n      background-color: #0cf;\n    }\n  }\n#tool_open input,\n#tool_import input,\n#tool_image input {\n  position: absolute;\n  opacity: 0;\n  font-size: 10em;\n  top: -5px;\n  right: -5px;\n  margin: 0;\n  cursor: pointer; /* Sadly doesn't appear to have an effect */\n}\n\n\n#main_icon {\n  position: relative;\n  top: -2px;\n  left: -2px;\n  width: 95px;\n  line-height: 26px;\n}\n\n#main_icon:hover {\n  background: #eee !important;\n}\n\n#main_icon.buttondown {\n  background: #eee !important;\n  -moz-box-shadow: none !important;\n  -webkit-box-shadow: none !important;\n  box-shadow: none !important;\n  border-radius: 3px 3px 0 0;\n}\n\n\n#main_icon > div {\n  float: left;\n}\n\n#main_button .dropdown {\n  position: absolute;\n  right: 7px;\n  top: 4px;\n}\n\n#main_icon span {\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  display: block;\n  z-index: 2;\n  font-weight: bold;\n  padding-left: 34px;\n  line-height: 32px;\n  font-family: sans-serif;\n}\n\n#main_menu {\n  z-index: 12;\n  background: #eee;\n  position: relative;\n  width: 230px;\n  padding: 5px;\n  -moz-box-shadow: #555 1px 1px 4px;\n  -webkit-box-shadow: #555 1px 1px 4px;\n  box-shadow: #555 1px 1px 4px;\n  font-size: 1.1em;\n  display: none;\n  overflow: hidden;\n  clear: both;\n  top: -9px;\n}\n\n#main_menu ul,\n#main_menu li {\n  list-style: none;\n  margin: 0;\n  padding: 0;\n}\n\n#main_menu li {\n/*  height: 35px;*/\n  line-height: 22px;\n  padding-top: 7px;\n  padding-left: 7px;\n  margin: -5px;\n  overflow: auto;\n  cursor: pointer;\n}\n\n#main_menu li:hover {\n  background: #FFC;\n}\n\n#main_menu li > div {\n  float: left;\n  padding-right: 5px;\n}\n\n#main_menu p {\n  margin-top: 5px;\n}\n\n#color_picker {\n  position: absolute;\n  display: none;\n  background: #E8E8E8;\n  height: 350px;\n  z-index: 5;\n}\n\n\n.icon_label {\n  float: left;\n  padding-top: 3px;\n  padding-right: 3px;\n  box-sizing: border-box;\n  -moz-box-sizing: border-box;\n  -webkit-box-sizing: border-box;\n  height: 0;\n}\n\n#bg_blocks .color_block {\n  position: static;\n}\n#svg_prefs_container div.color_block {\n  float: left;\n  margin: 2px;\n  padding: 20px;\n}\n#stroke_bg,\n#fill_bg {\n  height: 16px;\n  width: 16px;\n  margin: 1px;\n}\n\n.dropdown li.tool_button {\n  width: 24px;\n}\n\n// line,rect,ellipse,polygon{\n//   animation: dash 500ms linear infinite;\n// }\n@keyframes dash {\n  to {\n    stroke-dashoffset: 0;\n  }\n}\n\nsvg:not(:root) {\n  overflow: hidden;\n}"],sourceRoot:""}]);const s=o}}]);
//# sourceMappingURL=561.2163986e52ffb75649d2.js.map