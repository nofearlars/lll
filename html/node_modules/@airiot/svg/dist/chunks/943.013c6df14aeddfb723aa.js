"use strict";(this.webpackChunk_airiot_svg=this.webpackChunk_airiot_svg||[]).push([[943],{9943:(e,t,n)=>{n.r(t),n.d(t,{default:()=>w});var i=n(7462),r=n(2982),l=n(4942),o=n(885),a=n(7363),s=n.n(a),c=n(3078),d=n(1821),u=n(3379),A=n.n(u),f=n(7482);A()(f.Z,{insert:"head",singleton:!1}),f.Z.locals,n(8862);var p=n(4648),m=n(2920);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h={fhpath:s().createElement("i",{class:"iconfont list-icon"},""),line:s().createElement("i",{class:"iconfont list-icon"},""),rect:s().createElement("i",{class:"iconfont list-icon"},""),ellipse:s().createElement("i",{class:"iconfont list-icon"},""),path:s().createElement("i",{class:"iconfont list-icon"},""),star:s().createElement("i",{class:"iconfont list-icon"},""),polygon:s().createElement("i",{class:"iconfont list-icon"},""),image:s().createElement("i",{class:"iconfont list-icon"},""),polyline:s().createElement("i",{class:"iconfont list-icon"},"")},y={fhpath:_t1("线条"),line:_t1("线段"),rect:_t1("矩形"),ellipse:_t1("椭圆形"),path:_t1("钢笔"),star:_t1("星形"),polygon:_t1("多边形"),image:_t1("图片"),polyline:_t1("多段线")},E=function(e){var t,n,i,r,l=e.id,c=e.tagName,u=e.node,A=e.svgData,f=e.svg,p=e.dataType,m=e.getState,g=(0,a.useRef)(null),E=s().useState(!1),w=(0,o.Z)(E,2),b=w[0],S=w[1],_=s().useState("null"==e.name?y[p||c]:e.name),B=(0,o.Z)(_,2),x=B[0],N=B[1],C=null!==(t=Array.from((null==u?void 0:u.childNodes)||[]))&&void 0!==t&&t.filter((function(e){return(null==e?void 0:e.id)==l}))[0]&&"null"!=(null===(n=Array.from((null==u?void 0:u.childNodes)||[]))||void 0===n||null===(i=n.filter((function(e){return(null==e?void 0:e.id)==l}))[0])||void 0===i?void 0:i.getAttribute("data-name"))&&Array.from(u.childNodes).filter((function(e){return e.id==l}))[0].getAttribute("data-name")||y[p||c];(0,a.useEffect)((function(e){return g.current.addEventListener("dblclick",(function(e){S(!b),m(!b),Array.from(g.current.childNodes)[0].select()}))}));var Z=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];N(e),f.getElem(l).setAttribute("data-name",e),t||(window.airiotSVG=v(v({},window.airiotSVG||{}),{},{listNodeName:e})),!t&&S(!1),m(!b)};return s().createElement("span",{className:"svg_list_item "+l,ref:g},s().createElement(d.Tooltip,{title:["path","polyline"].includes(c)?_t1("可做轨迹路径"):""},h[p||c],b&&A.selectList&&(null===(r=A.selectList[0])||void 0===r?void 0:r.id)==l?s().createElement(d.Input,{value:x,style:{width:"50%"},size:"small",onChange:function(e){Z(e.target.value,!0)},onPressEnter:function(e){Z(e.target.value)},onBlur:function(e){Z(e.target.value)}}):C," ( ID: ",l," )"))};const w=function(e){var t,n=(0,c.use)("editor.mode"),u=(0,o.Z)(n,2),A=(u[0],u[1]),f=(0,c.use)("svg.store"),g=(0,o.Z)(f,2),h=g[0],y=g[1],w=(0,c.use)("svg.tool"),b=(0,o.Z)(w,2),S=b[0],B=b[1],x=e.cellKey,N=(0,c.use)("cell.params",x,"base"),C=(0,o.Z)(N,2),Z=C[0],k=C[1],O=s().useState([]),P=(0,o.Z)(O,2),j=P[0],G=P[1],K=s().useState(!1),R=(0,o.Z)(K,2),T=R[0],V=R[1],D=(0,a.useRef)(null),L=((0,c.use)("dashboard.from").mergeParams,null===(t=window.airiotSVG)||void 0===t?void 0:t[x]),I=(null==L?void 0:L.getSelectedElems())||[],Q=s().useState([]),M=(0,o.Z)(Q,2),J=M[0],Y=M[1],q=window.airiotSVG||{},$=L?Array.from(L.getContentElem().childNodes).filter((function(e){return"g"==e.tagName}))[0]:null;s().useEffect((function(){var e=[];I.map((function(t){t&&e.push(t.id)})),Y(e)}),[I,null==h?void 0:h.selected]);var z=function(e){V(e)};L&&(L.mouseCallback=function(e){try{var t;window.airiotSVG=v(v({},window.airiotSVG||{}),{},(t={selectList:e},(0,l.Z)(t,x,L),(0,l.Z)(t,"runkey",((null==T?void 0:T.runkey)||0)+1),t)),Y(_.isArray(e)?e:[e]),setTimeout((function(){!["pathedit","path"].includes(L.getMode())&&y((function(t){return v(v({},t),{},{selected:e,data:(0,m.getSVGStyle)(_.isArray(e)?e:[e],L,Z)})})),L.getMode()!=S&&B(L.getMode())}),500),G((0,p.$S)(L,q.time)),!["pathedit","path"].includes(L.getMode())&&(0,p.S9)({svg:L,setParams:k,cellKey:x})}catch(e){console.log(e)}});var F=(0,p.$S)(L,null==q?void 0:q.time);(0,a.useEffect)((function(){L&&(G((0,r.Z)(F.filter((function(e){return"filter"!=e.tagName})))),0!=F&&H())}),[q.selectList,null==h?void 0:h.selected,J]);var H=function(e,t){j.map((function(e){var t,n;J.includes(e.id)?e.id&&(null===(t=document.querySelector("."+e.id))||void 0===t||t.parentNode.parentNode.parentNode.parentNode.classList.add("ant-tree-treenode-selected")):e.id&&(null===(n=document.querySelector("."+e.id))||void 0===n||n.parentNode.parentNode.parentNode.parentNode.classList.remove("ant-tree-treenode-selected"))}))};return s().createElement(s().Fragment,null,s().createElement("div",{className:"svg_list_title"},s().createElement("div",null,_t1("图形"),s().createElement(d.Button,{type:"link",onClick:function(){(0,p.S9)({svg:L,setParams:k,cellKey:q.cellKey}),null==L||L.clearSelection(!0),A("cell"),window.airiotSVG=v(v({},window.airiotSVG||{}),{},(0,l.Z)({},x,L))}},s().createElement("i",{class:"iconfont"},"")))),s().createElement("div",{id:"svg_list",ref:D},s().createElement(d.Tree.DirectoryTree,{showIcon:!1,onSelect:function(e,t){var n=t.node.key,i=null,r=Array.from($.childNodes).filter((function(e){return e.id==n}))[0];if(n&&"ant-tree-treenode-selected"!==n)if(event.ctrlKey)if(J.includes(n)){var l=J.indexOf(n);I.splice(l,1)}else I.push(r);else if(event.shiftKey)if(J.includes(n)){var o=J.indexOf(n);I.splice(o,1)}else{var a,s;I[1]=r,j.map((function(e,t){e.id==I[0].id&&(a=t),e.id==I[1].id&&(s=t)})),i=function(e,t,n){var i=new Array;return e.map((function(e,r){var l=Array.from($.childNodes).filter((function(t){return t.id==e.id}))[0];t>n?r>=n&&r<=t&&i.push(l):r<=n&&r>=t&&i.push(l)})),i}(j,a,s)}else I=[r];null==L||L.clearSelection(!0),null==L||L.forRightToGetElements(I),B("select"),null==L||L.setMode("select"),null==L||L.addToSelection(i||I,!0),y((function(e){return v(v({},e),{},{selectList:i||I,data:(0,m.getSVGStyle)(i||I,L,Z)})})),window.airiotSVG=v(v({},window.airiotSVG||{}),{},{selectList:i||I,mode:"select",isLeft:!0})},selectedKeys:[],draggable:!0,expandAction:"false",onDragEnter:function(e){},onDragLeave:function(e){},onDrop:function(e){var t,n,i,l=e.node.key,o=e.dragNode.key,a=e.node.pos.split("-"),s=e.dropPosition-Number(a[a.length-1]),c=function(e,t,n){for(var i=0;i<e.length;i++)if(e[i].id===t)return n(e[i],i,e)},d=(0,r.Z)(j);c(d,o,(function(e,n,i){i.splice(n,1),t=e})),e.dropToGap?(c(d,l,(function(e,t,r){n=r,i=t})),-1===s?n.splice(i,0,t):n.splice(i+1,0,t)):c(d,l,(function(e){e.children=e.children||[],e.children.unshift(t)})),G(d),L.moveToBottomSelectedElement({dropKey:l,dragKey:o,dropPos:a,dropPosition:s,parent:$}),(0,p.S9)({svg:L,setParams:k,cellKey:q.cellKey})},className:"draggable-tree"},(j.filter((function(e){return"title"!=e.tagName}))||[]).map((function(e){return s().createElement(d.Tree.TreeNode,{title:s().createElement("span",null,s().createElement(E,(0,i.Z)({},e,{getState:z,node:$,svgData:q,svg:L}))),key:e.id})})))))}},7482:(e,t,n)=>{n.d(t,{Z:()=>a});var i=n(4015),r=n.n(i),l=n(3645),o=n.n(l)()(r());o.push([e.id,"#svg_list {\n  height: calc(100% - 50px);\n  overflow: auto;\n}\n#svg_list .ant-tree-title {\n  user-select: none;\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  width: 100% !important;\n  height: 100%;\n  vertical-align: middle;\n}\n#svg_list .ant-tree-list {\n  min-width: 0 !important;\n  width: 100% !important;\n}\n#svg_list .list-icon {\n  margin-right: 8px;\n}\n#svg_list .ant-list-item {\n  justify-content: unset;\n  padding: 0px;\n}\n#svg_list .ant-tree .ant-tree-treenode {\n  padding: 5px;\n  vertical-align: middle;\n}\n#svg_list .ant-list-item-meta-avatar {\n  margin-right: 0px;\n  margin-left: 16px;\n}\n.svg_list_title {\n  line-height: 34px;\n  padding: 8px 16px;\n  padding-left: 20px!important;\n  border-bottom: 1px solid #ccc;\n}\n.svg_list_title button {\n  float: right;\n}\n","",{version:3,sources:["webpack://./src/styles/svglist.less"],names:[],mappings:"AAIA;EAEI,yBAAA;EACA,cAAA;AAJJ;AACA;EAKQ,iBAAA;EACA,gBAAA;EACA,mBAAA;EACA,uBAAA;EACA,sBAAA;EACA,YAAA;EACA,sBAAA;AAHR;AARA;EAeQ,uBAAA;EACA,sBAAA;AAJR;AAZA;EAqBQ,iBAAA;AANR;AAfA;EAwBQ,sBAAA;EACA,YAAA;AANR;AAnBA;EA6BQ,YAAA;EACA,sBAAA;AAPR;AAvBA;EA0CQ,iBAAA;EACA,iBAAA;AAhBR;AAiCA;EACI,iBAAA;EACA,iBAAA;EACA,4BAAA;EACA,6BAAA;AA/BJ;AA2BA;EAMQ,YAAA;AA9BR",sourcesContent:["// #test {\n//     display: none;\n//     height: 0px!important;\n// };\n#svg_list {\n    // background: #ffffff;\n    height: calc(100% - 50px);\n    overflow: auto;\n    .ant-tree-title {\n        user-select:none;\n        overflow: hidden;\n        white-space: nowrap;\n        text-overflow: ellipsis;\n        width: 100% !important;\n        height: 100%;\n        vertical-align: middle;\n        // padding: 8px 16px;\n    }\n    .ant-tree-list {\n        min-width: 0 !important;\n        width: 100% !important;\n    }\n    \n    .list-icon {\n        // color: #613BE8;\n        margin-right: 8px;\n    }\n    .ant-list-item {\n        justify-content: unset;\n        padding: 0px;\n    }\n    \n    .ant-tree .ant-tree-treenode {\n        padding: 5px;\n        vertical-align: middle;\n    }\n    // .dashboard-editor .left-sider .draggable-tree.ant-tree .ant-tree-title, .dashboard-editor .left-sider .draggable-tree.ant-tree .ant-tree-switcher{\n    //     vertical-align: middle !important;\n    // }\n    \n    // .svg_selected {\n        // background: #4359C7;\n        // color: #fff !important;\n    // }\n\n    .ant-list-item-meta-avatar{\n        margin-right: 0px;\n        margin-left: 16px;\n    }\n    .ant-tree-treenode-selected {\n        // background: #4359C7;\n        // color: #fff !important;\n        // .list-icon {\n            // color: #fff!important;\n        // }\n    }\n    .ant-tree-treenode-selected :hover {\n        // background: #f5f5f5;\n        // color: #333;\n    }\n}\n\n\n\n.svg_list_title {\n    line-height: 34px;\n    padding: 8px 16px;\n    padding-left: 20px!important;\n    border-bottom: 1px solid #ccc;\n    button {\n        float: right;\n    }\n}"],sourceRoot:""}]);const a=o},2982:(e,t,n)=>{n.d(t,{Z:()=>l});var i=n(907),r=n(181);function l(e){return function(e){if(Array.isArray(e))return(0,i.Z)(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||(0,r.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}}}]);
//# sourceMappingURL=943.013c6df14aeddfb723aa.js.map