import React from 'react'
import { use } from 'xadmin'
import { Select } from 'antd'
import _ from 'lodash'

const MapSelect = props => {
  const { input: { value, onChange } } = props
  const selected = use('editor.selected')
  const [ cellParams ] = use('cell.params', selected?.[0])
  const stringParseParams = use('cell.params.parser', { params: cellParams })

  const parseValues = JSON.parse(stringParseParams)
  const dimensions = parseValues?.base?.chartData?.dimensions
  const options = dimensions?.map((d, index) => ({ value: index, label: d?.name })) || []

  return (
    <Select
      onChange={onChange}
      defaultValue={_.isNaN(value) ? null : value}
      options={options}>
    </Select>
  )
}

export default MapSelect
