import React from 'react';
import { C } from 'xadmin-ui'
import { Select, Empty, Card } from 'antd';
import TagWrap from './TagWrap'
import _ from 'lodash';

const Option = Select.Option;

const TagSelect = (props) => {
  const { input: { value, onChange }, tags, loading } = props;

  const { t:_t1 } = useI18n()

  const filterOption = (input, option) => (
    option.children.toLowerCase().indexOf(input.toLowerCase()) >= 0 ||
    option.value.toLowerCase().indexOf(input.toLowerCase()) >= 0
  )

  return (
    <Select
      allowClear
      showSearch
      loading={loading}
      onChange={onChange}
      placeholder={_t1("请选择数据点")}
      style={{ minWidth: 150 }}
      value={value || undefined}
      filterOption={filterOption}
      notFoundContent={<C is="NoData" />}
    >
      {(tags && tags.length > 0) ? tags.map(item => <Option value={item.id}>{item.name}</Option>) : <Card key="noData" disabled>
        <C is="NoData" />
      </Card>}
    </Select>
  )
}


const TagSelectField = (props) => {
  const { field } = props
  return (
    <TagWrap tableId={field?.tableId} tableDataId={field?.tableDataId}>
      {state => <TagSelect {...props} {...state} />}
    </TagWrap>
  )
}

export default TagSelectField;
