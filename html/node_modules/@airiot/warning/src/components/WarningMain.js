import { use } from 'xadmin'
import React from 'react'
import _ from 'lodash';


export default (props) => {
  // const { dispatch } = use('redux')
  const { onData, subscribe } = use('ws')
  const [ warningAdd, setWarning_Data ] = use('warning.add')
  // 订阅实时历史数据
  React.useEffect(() => {
    return subscribe('warning', {})
  }, [])

  onData(data => {
    // 报警恢复数据不处理，统一在弹窗处理
    if (data && _.isPlainObject(data) && !data?.recoveryTime) {
      setWarning_Data(data)
      // dispatch({ type: '@@oilive/ADD_UNREAD_WARNING', payload: data })
    }
  })
  return null
}