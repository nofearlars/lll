import React from 'react';
import { Button, Col, Row } from 'antd';
import { app, use } from 'xadmin';
import { Icon as FaIcon } from 'xadmin-ui';
import { Model } from 'xadmin-model';
import WarningBarList from './WarningBarList';
import ConfirmBtn from './ConfirmBtn';
import ProcessedBtn from './ProcessedBtn'
import { HasPermission } from 'xadmin-auth';

const WarningBar = props => {
  const [show, setShow] = React.useState(false)
  const { settings } = use('settings')

  return settings?.warning?.alarm_card ? (
    <Model name="Warning" modelKey={'warning_bar'}>
      <Row className="warning_bar" style={{ position: 'fixed', zIndex: 10 }}>
        {show ? [
          <Col span={22}>
            <WarningBarList />
          </Col>,
          <Col span={2}>
            <HasPermission FailureComponent={null} permission="warning.edit" >
              <ConfirmBtn />
              <ProcessedBtn />
            </HasPermission>
            <Button block onClick={() => app.go('/app/model/Warning/list')}>查看全部</Button>
          </Col>
        ] : null}

        <div className="arr-btn" onClick={() => setShow(!show)}>
          {show ? <FaIcon name="down" /> : <FaIcon name="up" />}</div>
      </Row>
    </Model >
  ) : null
}

export default WarningBar
