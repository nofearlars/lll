/*! For license information please see index.js.LICENSE.txt */
(()=>{var e={406:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var r=n(15),i=n.n(r),a=n(645),o=n.n(a)()(i());o.push([e.id,".warning_bar {\n  bottom: 0px;\n  left: 0px;\n  right: 0px;\n  overflow: visible;\n  padding: 5px;\n  background-color: rgb(240, 242, 245);\n  box-shadow: 0 -1px 3px rgba(0, 0, 0, 0.2);\n}\n\n.warning_bar>.arr-btn {\n  position: absolute;\n  top: -15px;\n  left: 50%;\n  height: 17px !important;\n  margin-left: -15px;\n  width: 30px;\n  text-align: center;\n  cursor: pointer;\n  background-color: rgb(240, 242, 245);\n  border-radius: 3px;\n  box-shadow: 0 -2px 1px rgba(0, 0, 0, 0.1);\n}\n\n.warning_bar>div {\n  height: 100px;\n  display: flex;\n  justify-content: center;\n  flex-direction: column;\n}\n\n.warning_bar .warning-bar-list-container {\n  height: 100%;\n  flex-grow: 1;\n  overflow: hidden;\n  position: relative;\n}\n\n.warning_bar .arr-icon {\n  height: 100%;\n  padding: 0px 5px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n}\n\n.warning_bar .arr-icon:hover {\n  color: #006699;\n}\n\n.warning_bar .arr-icon.disable {\n  cursor: not-allowed;\n  color: #CCC;\n}\n\n.warning_bar .warning-bar-list {\n  position: absolute;\n  transition: left 300ms ease-out;\n  display: flex;\n  flex-direction: row;\n  height: 100%;\n}\n\n.warning_bar .warning-bar-list .ant-card {\n  margin: 0 8px 0 0;\n  height: 100%;\n}\n\n.warning_bar .warning-bar-list .ant-card .ant-card-body {\n  padding: 0px;\n  height: 100%;\n  width: 120px;\n  overflow: hidden;\n}\n\n.warning_bar .warning-bar-list .ant-card .ant-card-body .content {\n  padding: 7px;\n  text-align: center;\n  width: 120px;\n  height: 100%;\n  cursor: pointer;\n}\n\n.warning_bar .ant-card .time {\n  font-size: 12px;\n  font-weight: bold;\n}\n\n.warning_bar .ant-card .department,\n.warning_bar .ant-card .node {\n  font-size: 12px;\n  width: 100%;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.warning_bar .ant-card .desc {\n  font-size: 12px;\n  line-height: 14px;\n  height: 40px;\n  display: inline-block;\n}\n\n.warning_bar .ant-card-body .unconfirm.info {\n  background-color: #26459b;\n  color: #FFF;\n}\n\n.warning_bar .ant-card-body .unconfirm.warning {\n  background-color: #f77f03;\n  color: #FFF;\n\n}\n\n.warning_bar .ant-card-body .unconfirm.warning a {\n  color: #26459b;\n}\n\n.warning_bar .ant-card-body .unconfirm.danger {\n  background-color: #b32121;\n  color: #FFF;\n}\n\n.warning_bar .ant-card-body .fixed {\n  background-color: #FFF !important;\n  color: rgb(52, 83, 54);\n}\n\n.warning_bar button {\n  margin: 5px 0;\n}\n\n.warning-enter .ant-card-body {\n  opacity: 0.01;\n  width: 0px !important;\n}\n\n.warning-enter.warning-enter-active .ant-card-body {\n  opacity: 1;\n  width: 120px !important;\n  transition: all 500ms linear;\n}\n\n.warning-exit {\n  opacity: 1;\n}\n\n.warning-exit.warning-exit-active {\n  opacity: 0.01;\n  transition: all 800ms ease-in;\n}\n\n.warning-info>div {\n  line-height: 30px;\n}\n\n.warning-bar .warning-bar-an {\n  transition: all 500ms linear;\n}\n\n.ArchiveModel .ant-layout {\n  background-color: transparent !important;\n}\n\n.ArchiveModel .ant-modal-body {\n  padding: 0px\n}\n\n.homeCard {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 50%;\n}\n\n.home-head {\n  display: flex !important;\n  padding: 16px 0;\n  justify-content: center;\n  align-items: center;\n}\n\n.home-foot {\n  display: flex !important;\n  justify-content: center;\n  align-items: center;\n  padding: 8px 0;\n  height: 50px;\n}\n\n.home-title {\n  font-size: 20px;\n  font-family: PingFangSC-Medium, PingFang SC;\n  font-weight: 500;\n  color: #303030;\n  line-height: 62px;\n  text-align: right;\n}\n\n.homeCard .anticon {\n  width: 32px !important;\n  height: 32px !important;\n}\n\n.homeCard .anticon svg {\n  width: 32px !important;\n  height: 32px !important;\n}\n\n.span-title {\n  font-size: 16px;\n  font-family: PingFangSC-Regular, PingFang SC;\n  font-weight: 400;\n  color: #303030;\n}\n\n.span-num {\n  font-size: 24px;\n  font-family: PingFangSC-Medium, PingFang SC;\n  font-weight: 500;\n  color: #303030;\n  text-align: right;\n}\n\n.homeBox .ant-col-home>div {\n  background: #FFFFFF;\n  /* box-shadow: 0px 2px 4px 0px rgba(231, 231, 231, 0.5); */\n}\n\n.warningArchive .ant-btn:first-child{\n  padding: 0\n}\n.warningArchive .ant-btn:first-child span {\n  padding: 4px 15px\n}\n\n.warningTable .ant-table-tbody {\n  animation: tdry 24s linear infinite;\n}\n@keyframes tdry {\n  0% {\n    transform: translateY(0%);\n  }\n  100% {\n    transform: translateX(100x);\n  }\n}\n.dndflow {\n  flex-direction: column;\n  display       : flex;\n  height        : 100%;\n  position      : relative;\n}\n\n.flow-edit-header {\n  display         : flex;\n  align-items     : center;\n  justify-content : space-between;\n  background-color: #FFFFFF !important;\n  box-shadow      : 0px 2px 6px 0px #e8e9ef;\n  height          : 50px;\n  padding         : 0 15px;\n  position        : relative;\n  z-index         : 4;\n}\n\n.flow-edit-header button {\n  border-radius: 4px;\n}\n\n.dndflow aside {\n  border-right: 1px solid #eee;\n  padding     : 15px 10px;\n  font-size   : 12px;\n  background  : #ccc;\n}\n\n.dndflow aside>* {\n  margin-bottom: 10px;\n  cursor       : grab;\n}\n\n.dndflow aside .description {\n  margin-bottom: 10px;\n}\n\n.dndflow .reactflow-wrapper {\n  flex-grow: 1;\n  height   : 100%;\n  position : absolute;\n  z-index  : 2;\n  width    : 100%;\n}\n\n@media screen and (min-width: 768px) {\n  .dndflow {\n    flex-direction: row;\n    height        : 100%;\n    min-height    : 600px;\n  }\n\n  .dndflow aside {\n    width    : 20%;\n    max-width: 180px;\n  }\n}\n\n.flow-add-node {\n  width          : 100%;\n  height         : 70px;\n  min-width      : 67px;\n  display        : flex;\n  flex-direction : column;\n  cursor         : move;\n  align-items    : center;\n  justify-content: space-between;\n}\n\n.flow-add-node:hover.flow-add-node>div:first-child {\n  background-color: rgba(92, 99, 128, 0.3);\n}\n\n.flow-node-level-title {\n  margin-bottom: 12px;\n  margin-top: 12px;\n  font-size: 12px;\n  font-family: PingFangSC-Medium, PingFang SC;\n  font-weight: 500;\n  color: #31395D;\n}\n\n.flow-node-level-title:first-child {\n  margin-top: 16px;\n}\n\n.flow-widgets-card .text-cell {\n  color: #5C6380;\n}\n\n.flow-editor-form {\n  padding: 10px\n}\n\n/* 连接线删除按钮样式 */\n.edgebutton-body {\n  align-items    : center;\n  background     : transparent;\n  display        : flex;\n  height         : 40px;\n  justify-content: center;\n  min-height     : 40px;\n  width          : 40px;\n}\n\n.edgebutton:hover {\n  box-shadow: 0 0 6px 2px rgb(0 0 0 / 8%);\n  transform : scale(1.1);\n}\n\n.edgebutton {\n  background   : darkgray;\n  border       : 1px solid #fff;\n  color        : #fff;\n  border-radius: 50%;\n  cursor       : pointer;\n  font-size    : 17px;\n  height       : 25px;\n  line-height  : 1;\n  width        : 25px;\n}\n\n/* 线删除按钮经过显示 */\n.react-flow__edge .edgebutton-body {\n  display: none\n}\n\n.react-flow__edge:hover.react-flow__edge .edgebutton-body {\n  display: flex\n}\n\n\n.card-remove-button {\n  position: absolute;\n  top: -12px;\n  right: 8px;\n  display: none;\n}\n\n.card-remove-button div, .flow-gateway-remove-button div, .card-remove-button img {\n  cursor: pointer;\n  height: 23px;\n  width: 23px;\n  display: block;\n  border: 1px solid #fff;\n  border-radius: 25px;\n  margin-left: 5px;\n}\n\n.react-flow-card:hover .card-remove-button {\n  display: flex;\n}\n\n.flow-editor-form .dashboard-slate-editor {\n  line-height: 26px;\n}\n\n.flow-editor-form .slate-data-editor {\n  display: flex;\n}\n\n.flow-editor-form .slate-data-editor-dropdown {\n  top  : 0 !important;\n  left : 0 !important;\n  width: calc(100% - 32px) !important;\n}\n\n.react-flow-card {\n  background-color: #fff;\n}\n\n.react-flow-card .react-flow-card-content {\n  line-height: 24px;\n  color: #31395D;\n}\n\n.react-flow__node {\n  border-radius   : 5px;\n  background-color: transparent !important;\n}\n\n.react-flow__node .ant-card-hoverable {\n  cursor: grab\n}\n\n.flow-bind-text {\n  border         : 1px solid #d9d9d9;\n  border-radius  : 2px;\n  padding        : 4px 11px;\n  display        : flex;\n  justify-content: space-between;\n}\n\n.flow-bind-text:hover {\n  border: 1px solid #613BE8\n}\n\n.right-sider {\n  overflow-y: auto;\n}\n\n.edgepanel-body {\n  width          : 100%;\n  height         : 100%;\n  user-select    : none;\n  display        : flex;\n  align-items    : center;\n  justify-content: center;\n}\n\n.flow-select-content {\n  position: relative;\n  overflow: hidden;\n}\n\n.flow-select-content .node-list {\n  font-size: 12px;\n}\n\n.flow-select-content .content-left {\n  float: left;\n  width: 30%;\n}\n\n.flow-select-content .content-right {\n  float     : right;\n  width     : 70%;\n  box-sizing: border-box;\n  padding   : 10px;\n  max-height: 200px;\n  overflow-y: auto;\n  overflow-x: hidden;\n}\n\n.flow-select-content .node-item:hover {\n  color: #613BE8;\n}\n\n.flow-select-content .node-item.active {\n  color: #613BE8;\n}\n\n.flow-select-content .node-item {\n  cursor: pointer;\n}\n\n.flow-select-content .flow-select-tag {\n  cursor       : pointer;\n  width        : 100%;\n  margin-bottom: 4px;\n  text-align   : left;\n  padding-left: 6px;\n}\n\n.flow-select-content .flow-select-tag:hover {\n  color: #613BE8;\n}\n\n\n.ant-radio-button-wrapper {\n  flex      : 1;\n  text-align: center;\n}\n\n.flow-editor-form .dashboard-modal-button {\n  width           : 100%;\n  line-height     : 1.5715;\n  position        : relative;\n  display         : inline-block;\n  font-weight     : 400;\n  white-space     : nowrap;\n  text-align      : center;\n  background-image: none;\n  border          : 1px solid transparent;\n  box-shadow      : 0 2px 0 rgb(0 0 0 / 2%);\n  cursor          : pointer;\n  transition      : all 0.3s cubic-bezier(0.645, 0.045, 0.355, 1);\n  user-select     : none;\n  touch-action    : manipulation;\n  color           : rgba(0, 0, 0, 0.85);\n  border-color    : #d9d9d9;\n  background      : #fff;\n  height          : 24px;\n  padding         : 0px 7px;\n  font-size       : 14px;\n  border-radius   : 2px;\n}\n\n.flow-editor-form .dashboard-modal-button:hover,\n.flow-editor-form .dashboard-modal-button:focus {\n  color       : #8864f5;\n  border-color: #8864f5;\n  background  : #fff;\n}\n\n.flow-editor-form .dashboard-modal-button .array-delete {\n  float    : right;\n  position : relative;\n  font-size: 12px;\n  top      : 3px;\n}\n\n.flow-editor-form .ant-tabs-nav-list {\n  width: 100%;\n}\n\n.flow-editor-form .ant-tabs-tab {\n  flex: 1;\n}\n\n.select-multiple-bind .ant-select-selector>div:last-child,\n.select-multiple-bind .ant-select-selector>div:nth-child(2) {\n  top   : auto !important;\n  bottom: -1px !important;\n}\n\n.flow_radio {\n  display: flex !important;\n}\n\n.flow_radio div label {\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n}\n\n.flow-tabpane .ant-collapse-header {\n  height: 40px;\n  background-color: #E7ECFC;\n  color: #4F71FF !important;\n}\n\n.flow-card:hover .text-cell {\n  color: #6F87EE !important;\n}\n\n.flow-card .add-cell {\n  font-size: 18px;\n}\n\n.left-sider .sider-content .flow-tabpane .add-cell svg {\n  width: 30px !important;\n  height: 30px;\n}\n\n.react-flow-card-title svg circle, .react-flow-card-title svg path, .react-flow-card-title g path, .react-flow-card-title g polygon {\n  fill: #fff;\n}\n\n.react-flow-card-exTableRecord .react-flow-card-title svg path, .react-flow-card-exTableRecord .react-flow-card-title g path {\n  stroke: #EF874C;\n}\n\n.react-flow-card-nodeAttribute .react-flow-card-title svg path {\n  stroke: #B45FB3;\n}\n\n.react-flow-card-businessData .react-flow-card-title svg path {\n  stroke: #e26e6e;\n}\n\n.react-flow-card-businessData .react-flow-card-title svg polygon {\n  fill: #e26e6e;\n}\n\n.flow-editor .react-flow__controls-button svg{\n  max-width: 16px;\n  max-height: 16px;\n}\n.flow-editor .react-flow__controls-button{\n  width: 32px;\n  height: 32px;\n}\n.iot-flow-slate-editor-wrap {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.iot-flow-slate-editor-comp {\n  width: calc(100% - 37px);\n}\n.iot-flow-slate-editor {\n  border: 1px solid #ddd;\n  min-height: 30px;\n  line-height: 30px;\n  padding: 0 5px;\n}\n.iot-flow-slate-editor-icon {\n  width: 32px;\n  height: 32px;\n  margin-left: 5px;\n  border: 1px solid #ddd;\n  padding: 0 9px;\n  line-height: 32px;\n  cursor: pointer;\n}\n.warning-table .ant-table-tbody tr td:hover .anticon-edit:not(.model-list-action .anticon-edit) {\n  margin-right: 0;\n  position: static;\n  line-height: normal;\n}\n\n\ntable.tableExample{\n  margin-top: 42px;\n  border: 0px solid #e8e8e8;\n  text-align: center;\n  width: 100%;\n}\ntable.tableExample td{\n  padding: 13px 10px;\n  min-width: 80px\n}\n\n.tableExample td {\n  font-size: 14px;\n  font-family: PingFangSC-Regular, PingFang SC;\n  font-weight: 400;\n  line-height: 20px;\n}\n.tableExample thead {\n  background: #F6F7FA;\n  font-size: 14px;\n  font-family: PingFangSC-Medium, PingFang SC;\n  font-weight: 500;\n  color: #31395D;\n  line-height: 20px;\n}\n.tableExample tbody tr {\n  opacity: 0.8;\n  border-bottom: 1px solid #E3E5EB;\n}\n.tableExample tbody tr:last-child {\n  border-bottom: none;\n}\n.warning-plugin-tab .cmdb-form-card {\n  height: 100%;\n}\n\n","",{version:3,sources:["webpack://./src/apps/warning/style.css"],names:[],mappings:"AAAA;EACE,WAAW;EACX,SAAS;EACT,UAAU;EACV,iBAAiB;EACjB,YAAY;EACZ,oCAAoC;EACpC,yCAAyC;AAC3C;;AAEA;EACE,kBAAkB;EAClB,UAAU;EACV,SAAS;EACT,uBAAuB;EACvB,kBAAkB;EAClB,WAAW;EACX,kBAAkB;EAClB,eAAe;EACf,oCAAoC;EACpC,kBAAkB;EAClB,yCAAyC;AAC3C;;AAEA;EACE,aAAa;EACb,aAAa;EACb,uBAAuB;EACvB,sBAAsB;AACxB;;AAEA;EACE,YAAY;EACZ,YAAY;EACZ,gBAAgB;EAChB,kBAAkB;AACpB;;AAEA;EACE,YAAY;EACZ,gBAAgB;EAChB,eAAe;EACf,aAAa;EACb,mBAAmB;AACrB;;AAEA;EACE,cAAc;AAChB;;AAEA;EACE,mBAAmB;EACnB,WAAW;AACb;;AAEA;EACE,kBAAkB;EAClB,+BAA+B;EAC/B,aAAa;EACb,mBAAmB;EACnB,YAAY;AACd;;AAEA;EACE,iBAAiB;EACjB,YAAY;AACd;;AAEA;EACE,YAAY;EACZ,YAAY;EACZ,YAAY;EACZ,gBAAgB;AAClB;;AAEA;EACE,YAAY;EACZ,kBAAkB;EAClB,YAAY;EACZ,YAAY;EACZ,eAAe;AACjB;;AAEA;EACE,eAAe;EACf,iBAAiB;AACnB;;AAEA;;EAEE,eAAe;EACf,WAAW;EACX,mBAAmB;EACnB,gBAAgB;EAChB,uBAAuB;AACzB;;AAEA;EACE,eAAe;EACf,iBAAiB;EACjB,YAAY;EACZ,qBAAqB;AACvB;;AAEA;EACE,yBAAyB;EACzB,WAAW;AACb;;AAEA;EACE,yBAAyB;EACzB,WAAW;;AAEb;;AAEA;EACE,cAAc;AAChB;;AAEA;EACE,yBAAyB;EACzB,WAAW;AACb;;AAEA;EACE,iCAAiC;EACjC,sBAAsB;AACxB;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,aAAa;EACb,qBAAqB;AACvB;;AAEA;EACE,UAAU;EACV,uBAAuB;EACvB,4BAA4B;AAC9B;;AAEA;EACE,UAAU;AACZ;;AAEA;EACE,aAAa;EACb,6BAA6B;AAC/B;;AAEA;EACE,iBAAiB;AACnB;;AAEA;EACE,4BAA4B;AAC9B;;AAEA;EACE,wCAAwC;AAC1C;;AAEA;EACE;AACF;;AAEA;EACE,aAAa;EACb,mBAAmB;EACnB,uBAAuB;EACvB,kBAAkB;AACpB;;AAEA;EACE,wBAAwB;EACxB,eAAe;EACf,uBAAuB;EACvB,mBAAmB;AACrB;;AAEA;EACE,wBAAwB;EACxB,uBAAuB;EACvB,mBAAmB;EACnB,cAAc;EACd,YAAY;AACd;;AAEA;EACE,eAAe;EACf,2CAA2C;EAC3C,gBAAgB;EAChB,cAAc;EACd,iBAAiB;EACjB,iBAAiB;AACnB;;AAEA;EACE,sBAAsB;EACtB,uBAAuB;AACzB;;AAEA;EACE,sBAAsB;EACtB,uBAAuB;AACzB;;AAEA;EACE,eAAe;EACf,4CAA4C;EAC5C,gBAAgB;EAChB,cAAc;AAChB;;AAEA;EACE,eAAe;EACf,2CAA2C;EAC3C,gBAAgB;EAChB,cAAc;EACd,iBAAiB;AACnB;;AAEA;EACE,mBAAmB;EACnB,0DAA0D;AAC5D;;AAEA;EACE;AACF;AACA;EACE;AACF;;AAEA;EACE,mCAAmC;AACrC;AACA;EACE;IACE,yBAAyB;EAC3B;EACA;IACE,2BAA2B;EAC7B;AACF;AACA;EACE,sBAAsB;EACtB,oBAAoB;EACpB,oBAAoB;EACpB,wBAAwB;AAC1B;;AAEA;EACE,sBAAsB;EACtB,wBAAwB;EACxB,+BAA+B;EAC/B,oCAAoC;EACpC,yCAAyC;EACzC,sBAAsB;EACtB,wBAAwB;EACxB,0BAA0B;EAC1B,mBAAmB;AACrB;;AAEA;EACE,kBAAkB;AACpB;;AAEA;EACE,4BAA4B;EAC5B,uBAAuB;EACvB,kBAAkB;EAClB,kBAAkB;AACpB;;AAEA;EACE,mBAAmB;EACnB,mBAAmB;AACrB;;AAEA;EACE,mBAAmB;AACrB;;AAEA;EACE,YAAY;EACZ,eAAe;EACf,mBAAmB;EACnB,YAAY;EACZ,eAAe;AACjB;;AAEA;EACE;IACE,mBAAmB;IACnB,oBAAoB;IACpB,qBAAqB;EACvB;;EAEA;IACE,cAAc;IACd,gBAAgB;EAClB;AACF;;AAEA;EACE,qBAAqB;EACrB,qBAAqB;EACrB,qBAAqB;EACrB,qBAAqB;EACrB,uBAAuB;EACvB,qBAAqB;EACrB,uBAAuB;EACvB,8BAA8B;AAChC;;AAEA;EACE,wCAAwC;AAC1C;;AAEA;EACE,mBAAmB;EACnB,gBAAgB;EAChB,eAAe;EACf,2CAA2C;EAC3C,gBAAgB;EAChB,cAAc;AAChB;;AAEA;EACE,gBAAgB;AAClB;;AAEA;EACE,cAAc;AAChB;;AAEA;EACE;AACF;;AAEA,cAAc;AACd;EACE,uBAAuB;EACvB,4BAA4B;EAC5B,qBAAqB;EACrB,qBAAqB;EACrB,uBAAuB;EACvB,qBAAqB;EACrB,qBAAqB;AACvB;;AAEA;EACE,uCAAuC;EACvC,sBAAsB;AACxB;;AAEA;EACE,uBAAuB;EACvB,6BAA6B;EAC7B,mBAAmB;EACnB,kBAAkB;EAClB,sBAAsB;EACtB,mBAAmB;EACnB,mBAAmB;EACnB,gBAAgB;EAChB,mBAAmB;AACrB;;AAEA,cAAc;AACd;EACE;AACF;;AAEA;EACE;AACF;;;AAGA;EACE,kBAAkB;EAClB,UAAU;EACV,UAAU;EACV,aAAa;AACf;;AAEA;EACE,eAAe;EACf,YAAY;EACZ,WAAW;EACX,cAAc;EACd,sBAAsB;EACtB,mBAAmB;EACnB,gBAAgB;AAClB;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,iBAAiB;AACnB;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,mBAAmB;EACnB,mBAAmB;EACnB,mCAAmC;AACrC;;AAEA;EACE,sBAAsB;AACxB;;AAEA;EACE,iBAAiB;EACjB,cAAc;AAChB;;AAEA;EACE,qBAAqB;EACrB,wCAAwC;AAC1C;;AAEA;EACE;AACF;;AAEA;EACE,kCAAkC;EAClC,oBAAoB;EACpB,yBAAyB;EACzB,qBAAqB;EACrB,8BAA8B;AAChC;;AAEA;EACE;AACF;;AAEA;EACE,gBAAgB;AAClB;;AAEA;EACE,qBAAqB;EACrB,qBAAqB;EACrB,qBAAqB;EACrB,qBAAqB;EACrB,uBAAuB;EACvB,uBAAuB;AACzB;;AAEA;EACE,kBAAkB;EAClB,gBAAgB;AAClB;;AAEA;EACE,eAAe;AACjB;;AAEA;EACE,WAAW;EACX,UAAU;AACZ;;AAEA;EACE,iBAAiB;EACjB,eAAe;EACf,sBAAsB;EACtB,gBAAgB;EAChB,iBAAiB;EACjB,gBAAgB;EAChB,kBAAkB;AACpB;;AAEA;EACE,cAAc;AAChB;;AAEA;EACE,cAAc;AAChB;;AAEA;EACE,eAAe;AACjB;;AAEA;EACE,sBAAsB;EACtB,mBAAmB;EACnB,kBAAkB;EAClB,mBAAmB;EACnB,iBAAiB;AACnB;;AAEA;EACE,cAAc;AAChB;;;AAGA;EACE,aAAa;EACb,kBAAkB;AACpB;;AAEA;EACE,sBAAsB;EACtB,wBAAwB;EACxB,0BAA0B;EAC1B,8BAA8B;EAC9B,qBAAqB;EACrB,wBAAwB;EACxB,wBAAwB;EACxB,sBAAsB;EACtB,uCAAuC;EACvC,yCAAyC;EACzC,yBAAyB;EACzB,+DAA+D;EAC/D,sBAAsB;EACtB,8BAA8B;EAC9B,qCAAqC;EACrC,yBAAyB;EACzB,sBAAsB;EACtB,sBAAsB;EACtB,yBAAyB;EACzB,sBAAsB;EACtB,qBAAqB;AACvB;;AAEA;;EAEE,qBAAqB;EACrB,qBAAqB;EACrB,kBAAkB;AACpB;;AAEA;EACE,gBAAgB;EAChB,mBAAmB;EACnB,eAAe;EACf,cAAc;AAChB;;AAEA;EACE,WAAW;AACb;;AAEA;EACE,OAAO;AACT;;AAEA;;EAEE,uBAAuB;EACvB,uBAAuB;AACzB;;AAEA;EACE,wBAAwB;AAC1B;;AAEA;EACE,gBAAgB;EAChB,mBAAmB;EACnB,uBAAuB;AACzB;;AAEA;EACE,YAAY;EACZ,yBAAyB;EACzB,yBAAyB;AAC3B;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,eAAe;AACjB;;AAEA;EACE,sBAAsB;EACtB,YAAY;AACd;;AAEA;EACE,UAAU;AACZ;;AAEA;EACE,eAAe;AACjB;;AAEA;EACE,eAAe;AACjB;;AAEA;EACE,eAAe;AACjB;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,eAAe;EACf,gBAAgB;AAClB;AACA;EACE,WAAW;EACX,YAAY;AACd;AACA;EACE,aAAa;EACb,mBAAmB;EACnB,uBAAuB;AACzB;AACA;EACE,wBAAwB;AAC1B;AACA;EACE,sBAAsB;EACtB,gBAAgB;EAChB,iBAAiB;EACjB,cAAc;AAChB;AACA;EACE,WAAW;EACX,YAAY;EACZ,gBAAgB;EAChB,sBAAsB;EACtB,cAAc;EACd,iBAAiB;EACjB,eAAe;AACjB;AACA;EACE,eAAe;EACf,gBAAgB;EAChB,mBAAmB;AACrB;;;AAGA;EACE,gBAAgB;EAChB,yBAAyB;EACzB,kBAAkB;EAClB,WAAW;AACb;AACA;EACE,kBAAkB;EAClB;AACF;;AAEA;EACE,eAAe;EACf,4CAA4C;EAC5C,gBAAgB;EAChB,iBAAiB;AACnB;AACA;EACE,mBAAmB;EACnB,eAAe;EACf,2CAA2C;EAC3C,gBAAgB;EAChB,cAAc;EACd,iBAAiB;AACnB;AACA;EACE,YAAY;EACZ,gCAAgC;AAClC;AACA;EACE,mBAAmB;AACrB;AACA;EACE,YAAY;AACd",sourcesContent:[".warning_bar {\n  bottom: 0px;\n  left: 0px;\n  right: 0px;\n  overflow: visible;\n  padding: 5px;\n  background-color: rgb(240, 242, 245);\n  box-shadow: 0 -1px 3px rgba(0, 0, 0, 0.2);\n}\n\n.warning_bar>.arr-btn {\n  position: absolute;\n  top: -15px;\n  left: 50%;\n  height: 17px !important;\n  margin-left: -15px;\n  width: 30px;\n  text-align: center;\n  cursor: pointer;\n  background-color: rgb(240, 242, 245);\n  border-radius: 3px;\n  box-shadow: 0 -2px 1px rgba(0, 0, 0, 0.1);\n}\n\n.warning_bar>div {\n  height: 100px;\n  display: flex;\n  justify-content: center;\n  flex-direction: column;\n}\n\n.warning_bar .warning-bar-list-container {\n  height: 100%;\n  flex-grow: 1;\n  overflow: hidden;\n  position: relative;\n}\n\n.warning_bar .arr-icon {\n  height: 100%;\n  padding: 0px 5px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n}\n\n.warning_bar .arr-icon:hover {\n  color: #006699;\n}\n\n.warning_bar .arr-icon.disable {\n  cursor: not-allowed;\n  color: #CCC;\n}\n\n.warning_bar .warning-bar-list {\n  position: absolute;\n  transition: left 300ms ease-out;\n  display: flex;\n  flex-direction: row;\n  height: 100%;\n}\n\n.warning_bar .warning-bar-list .ant-card {\n  margin: 0 8px 0 0;\n  height: 100%;\n}\n\n.warning_bar .warning-bar-list .ant-card .ant-card-body {\n  padding: 0px;\n  height: 100%;\n  width: 120px;\n  overflow: hidden;\n}\n\n.warning_bar .warning-bar-list .ant-card .ant-card-body .content {\n  padding: 7px;\n  text-align: center;\n  width: 120px;\n  height: 100%;\n  cursor: pointer;\n}\n\n.warning_bar .ant-card .time {\n  font-size: 12px;\n  font-weight: bold;\n}\n\n.warning_bar .ant-card .department,\n.warning_bar .ant-card .node {\n  font-size: 12px;\n  width: 100%;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.warning_bar .ant-card .desc {\n  font-size: 12px;\n  line-height: 14px;\n  height: 40px;\n  display: inline-block;\n}\n\n.warning_bar .ant-card-body .unconfirm.info {\n  background-color: #26459b;\n  color: #FFF;\n}\n\n.warning_bar .ant-card-body .unconfirm.warning {\n  background-color: #f77f03;\n  color: #FFF;\n\n}\n\n.warning_bar .ant-card-body .unconfirm.warning a {\n  color: #26459b;\n}\n\n.warning_bar .ant-card-body .unconfirm.danger {\n  background-color: #b32121;\n  color: #FFF;\n}\n\n.warning_bar .ant-card-body .fixed {\n  background-color: #FFF !important;\n  color: rgb(52, 83, 54);\n}\n\n.warning_bar button {\n  margin: 5px 0;\n}\n\n.warning-enter .ant-card-body {\n  opacity: 0.01;\n  width: 0px !important;\n}\n\n.warning-enter.warning-enter-active .ant-card-body {\n  opacity: 1;\n  width: 120px !important;\n  transition: all 500ms linear;\n}\n\n.warning-exit {\n  opacity: 1;\n}\n\n.warning-exit.warning-exit-active {\n  opacity: 0.01;\n  transition: all 800ms ease-in;\n}\n\n.warning-info>div {\n  line-height: 30px;\n}\n\n.warning-bar .warning-bar-an {\n  transition: all 500ms linear;\n}\n\n.ArchiveModel .ant-layout {\n  background-color: transparent !important;\n}\n\n.ArchiveModel .ant-modal-body {\n  padding: 0px\n}\n\n.homeCard {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 50%;\n}\n\n.home-head {\n  display: flex !important;\n  padding: 16px 0;\n  justify-content: center;\n  align-items: center;\n}\n\n.home-foot {\n  display: flex !important;\n  justify-content: center;\n  align-items: center;\n  padding: 8px 0;\n  height: 50px;\n}\n\n.home-title {\n  font-size: 20px;\n  font-family: PingFangSC-Medium, PingFang SC;\n  font-weight: 500;\n  color: #303030;\n  line-height: 62px;\n  text-align: right;\n}\n\n.homeCard .anticon {\n  width: 32px !important;\n  height: 32px !important;\n}\n\n.homeCard .anticon svg {\n  width: 32px !important;\n  height: 32px !important;\n}\n\n.span-title {\n  font-size: 16px;\n  font-family: PingFangSC-Regular, PingFang SC;\n  font-weight: 400;\n  color: #303030;\n}\n\n.span-num {\n  font-size: 24px;\n  font-family: PingFangSC-Medium, PingFang SC;\n  font-weight: 500;\n  color: #303030;\n  text-align: right;\n}\n\n.homeBox .ant-col-home>div {\n  background: #FFFFFF;\n  /* box-shadow: 0px 2px 4px 0px rgba(231, 231, 231, 0.5); */\n}\n\n.warningArchive .ant-btn:first-child{\n  padding: 0\n}\n.warningArchive .ant-btn:first-child span {\n  padding: 4px 15px\n}\n\n.warningTable .ant-table-tbody {\n  animation: tdry 24s linear infinite;\n}\n@keyframes tdry {\n  0% {\n    transform: translateY(0%);\n  }\n  100% {\n    transform: translateX(100x);\n  }\n}\n.dndflow {\n  flex-direction: column;\n  display       : flex;\n  height        : 100%;\n  position      : relative;\n}\n\n.flow-edit-header {\n  display         : flex;\n  align-items     : center;\n  justify-content : space-between;\n  background-color: #FFFFFF !important;\n  box-shadow      : 0px 2px 6px 0px #e8e9ef;\n  height          : 50px;\n  padding         : 0 15px;\n  position        : relative;\n  z-index         : 4;\n}\n\n.flow-edit-header button {\n  border-radius: 4px;\n}\n\n.dndflow aside {\n  border-right: 1px solid #eee;\n  padding     : 15px 10px;\n  font-size   : 12px;\n  background  : #ccc;\n}\n\n.dndflow aside>* {\n  margin-bottom: 10px;\n  cursor       : grab;\n}\n\n.dndflow aside .description {\n  margin-bottom: 10px;\n}\n\n.dndflow .reactflow-wrapper {\n  flex-grow: 1;\n  height   : 100%;\n  position : absolute;\n  z-index  : 2;\n  width    : 100%;\n}\n\n@media screen and (min-width: 768px) {\n  .dndflow {\n    flex-direction: row;\n    height        : 100%;\n    min-height    : 600px;\n  }\n\n  .dndflow aside {\n    width    : 20%;\n    max-width: 180px;\n  }\n}\n\n.flow-add-node {\n  width          : 100%;\n  height         : 70px;\n  min-width      : 67px;\n  display        : flex;\n  flex-direction : column;\n  cursor         : move;\n  align-items    : center;\n  justify-content: space-between;\n}\n\n.flow-add-node:hover.flow-add-node>div:first-child {\n  background-color: rgba(92, 99, 128, 0.3);\n}\n\n.flow-node-level-title {\n  margin-bottom: 12px;\n  margin-top: 12px;\n  font-size: 12px;\n  font-family: PingFangSC-Medium, PingFang SC;\n  font-weight: 500;\n  color: #31395D;\n}\n\n.flow-node-level-title:first-child {\n  margin-top: 16px;\n}\n\n.flow-widgets-card .text-cell {\n  color: #5C6380;\n}\n\n.flow-editor-form {\n  padding: 10px\n}\n\n/* 连接线删除按钮样式 */\n.edgebutton-body {\n  align-items    : center;\n  background     : transparent;\n  display        : flex;\n  height         : 40px;\n  justify-content: center;\n  min-height     : 40px;\n  width          : 40px;\n}\n\n.edgebutton:hover {\n  box-shadow: 0 0 6px 2px rgb(0 0 0 / 8%);\n  transform : scale(1.1);\n}\n\n.edgebutton {\n  background   : darkgray;\n  border       : 1px solid #fff;\n  color        : #fff;\n  border-radius: 50%;\n  cursor       : pointer;\n  font-size    : 17px;\n  height       : 25px;\n  line-height  : 1;\n  width        : 25px;\n}\n\n/* 线删除按钮经过显示 */\n.react-flow__edge .edgebutton-body {\n  display: none\n}\n\n.react-flow__edge:hover.react-flow__edge .edgebutton-body {\n  display: flex\n}\n\n\n.card-remove-button {\n  position: absolute;\n  top: -12px;\n  right: 8px;\n  display: none;\n}\n\n.card-remove-button div, .flow-gateway-remove-button div, .card-remove-button img {\n  cursor: pointer;\n  height: 23px;\n  width: 23px;\n  display: block;\n  border: 1px solid #fff;\n  border-radius: 25px;\n  margin-left: 5px;\n}\n\n.react-flow-card:hover .card-remove-button {\n  display: flex;\n}\n\n.flow-editor-form .dashboard-slate-editor {\n  line-height: 26px;\n}\n\n.flow-editor-form .slate-data-editor {\n  display: flex;\n}\n\n.flow-editor-form .slate-data-editor-dropdown {\n  top  : 0 !important;\n  left : 0 !important;\n  width: calc(100% - 32px) !important;\n}\n\n.react-flow-card {\n  background-color: #fff;\n}\n\n.react-flow-card .react-flow-card-content {\n  line-height: 24px;\n  color: #31395D;\n}\n\n.react-flow__node {\n  border-radius   : 5px;\n  background-color: transparent !important;\n}\n\n.react-flow__node .ant-card-hoverable {\n  cursor: grab\n}\n\n.flow-bind-text {\n  border         : 1px solid #d9d9d9;\n  border-radius  : 2px;\n  padding        : 4px 11px;\n  display        : flex;\n  justify-content: space-between;\n}\n\n.flow-bind-text:hover {\n  border: 1px solid #613BE8\n}\n\n.right-sider {\n  overflow-y: auto;\n}\n\n.edgepanel-body {\n  width          : 100%;\n  height         : 100%;\n  user-select    : none;\n  display        : flex;\n  align-items    : center;\n  justify-content: center;\n}\n\n.flow-select-content {\n  position: relative;\n  overflow: hidden;\n}\n\n.flow-select-content .node-list {\n  font-size: 12px;\n}\n\n.flow-select-content .content-left {\n  float: left;\n  width: 30%;\n}\n\n.flow-select-content .content-right {\n  float     : right;\n  width     : 70%;\n  box-sizing: border-box;\n  padding   : 10px;\n  max-height: 200px;\n  overflow-y: auto;\n  overflow-x: hidden;\n}\n\n.flow-select-content .node-item:hover {\n  color: #613BE8;\n}\n\n.flow-select-content .node-item.active {\n  color: #613BE8;\n}\n\n.flow-select-content .node-item {\n  cursor: pointer;\n}\n\n.flow-select-content .flow-select-tag {\n  cursor       : pointer;\n  width        : 100%;\n  margin-bottom: 4px;\n  text-align   : left;\n  padding-left: 6px;\n}\n\n.flow-select-content .flow-select-tag:hover {\n  color: #613BE8;\n}\n\n\n.ant-radio-button-wrapper {\n  flex      : 1;\n  text-align: center;\n}\n\n.flow-editor-form .dashboard-modal-button {\n  width           : 100%;\n  line-height     : 1.5715;\n  position        : relative;\n  display         : inline-block;\n  font-weight     : 400;\n  white-space     : nowrap;\n  text-align      : center;\n  background-image: none;\n  border          : 1px solid transparent;\n  box-shadow      : 0 2px 0 rgb(0 0 0 / 2%);\n  cursor          : pointer;\n  transition      : all 0.3s cubic-bezier(0.645, 0.045, 0.355, 1);\n  user-select     : none;\n  touch-action    : manipulation;\n  color           : rgba(0, 0, 0, 0.85);\n  border-color    : #d9d9d9;\n  background      : #fff;\n  height          : 24px;\n  padding         : 0px 7px;\n  font-size       : 14px;\n  border-radius   : 2px;\n}\n\n.flow-editor-form .dashboard-modal-button:hover,\n.flow-editor-form .dashboard-modal-button:focus {\n  color       : #8864f5;\n  border-color: #8864f5;\n  background  : #fff;\n}\n\n.flow-editor-form .dashboard-modal-button .array-delete {\n  float    : right;\n  position : relative;\n  font-size: 12px;\n  top      : 3px;\n}\n\n.flow-editor-form .ant-tabs-nav-list {\n  width: 100%;\n}\n\n.flow-editor-form .ant-tabs-tab {\n  flex: 1;\n}\n\n.select-multiple-bind .ant-select-selector>div:last-child,\n.select-multiple-bind .ant-select-selector>div:nth-child(2) {\n  top   : auto !important;\n  bottom: -1px !important;\n}\n\n.flow_radio {\n  display: flex !important;\n}\n\n.flow_radio div label {\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n}\n\n.flow-tabpane .ant-collapse-header {\n  height: 40px;\n  background-color: #E7ECFC;\n  color: #4F71FF !important;\n}\n\n.flow-card:hover .text-cell {\n  color: #6F87EE !important;\n}\n\n.flow-card .add-cell {\n  font-size: 18px;\n}\n\n.left-sider .sider-content .flow-tabpane .add-cell svg {\n  width: 30px !important;\n  height: 30px;\n}\n\n.react-flow-card-title svg circle, .react-flow-card-title svg path, .react-flow-card-title g path, .react-flow-card-title g polygon {\n  fill: #fff;\n}\n\n.react-flow-card-exTableRecord .react-flow-card-title svg path, .react-flow-card-exTableRecord .react-flow-card-title g path {\n  stroke: #EF874C;\n}\n\n.react-flow-card-nodeAttribute .react-flow-card-title svg path {\n  stroke: #B45FB3;\n}\n\n.react-flow-card-businessData .react-flow-card-title svg path {\n  stroke: #e26e6e;\n}\n\n.react-flow-card-businessData .react-flow-card-title svg polygon {\n  fill: #e26e6e;\n}\n\n.flow-editor .react-flow__controls-button svg{\n  max-width: 16px;\n  max-height: 16px;\n}\n.flow-editor .react-flow__controls-button{\n  width: 32px;\n  height: 32px;\n}\n.iot-flow-slate-editor-wrap {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.iot-flow-slate-editor-comp {\n  width: calc(100% - 37px);\n}\n.iot-flow-slate-editor {\n  border: 1px solid #ddd;\n  min-height: 30px;\n  line-height: 30px;\n  padding: 0 5px;\n}\n.iot-flow-slate-editor-icon {\n  width: 32px;\n  height: 32px;\n  margin-left: 5px;\n  border: 1px solid #ddd;\n  padding: 0 9px;\n  line-height: 32px;\n  cursor: pointer;\n}\n.warning-table .ant-table-tbody tr td:hover .anticon-edit:not(.model-list-action .anticon-edit) {\n  margin-right: 0;\n  position: static;\n  line-height: normal;\n}\n\n\ntable.tableExample{\n  margin-top: 42px;\n  border: 0px solid #e8e8e8;\n  text-align: center;\n  width: 100%;\n}\ntable.tableExample td{\n  padding: 13px 10px;\n  min-width: 80px\n}\n\n.tableExample td {\n  font-size: 14px;\n  font-family: PingFangSC-Regular, PingFang SC;\n  font-weight: 400;\n  line-height: 20px;\n}\n.tableExample thead {\n  background: #F6F7FA;\n  font-size: 14px;\n  font-family: PingFangSC-Medium, PingFang SC;\n  font-weight: 500;\n  color: #31395D;\n  line-height: 20px;\n}\n.tableExample tbody tr {\n  opacity: 0.8;\n  border-bottom: 1px solid #E3E5EB;\n}\n.tableExample tbody tr:last-child {\n  border-bottom: none;\n}\n.warning-plugin-tab .cmdb-form-card {\n  height: 100%;\n}\n\n"],sourceRoot:""}]);const l=o},575:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var r=n(15),i=n.n(r),a=n(645),o=n.n(a)()(i());o.push([e.id,".delay-schema .ant-form-item {\n  margin-bottom: 0;\n}","",{version:3,sources:["webpack://./src/plugins/warning/index.css"],names:[],mappings:"AAAA;EACE,gBAAgB;AAClB",sourcesContent:[".delay-schema .ant-form-item {\n  margin-bottom: 0;\n}"],sourceRoot:""}]);const l=o},645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=e(t);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,r){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(r)for(var a=0;a<this.length;a++){var o=this[a][0];null!=o&&(i[o]=!0)}for(var l=0;l<e.length;l++){var c=[].concat(e[l]);r&&i[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),t.push(c))}},t}},15:e=>{"use strict";function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}e.exports=function(e){var n,r,i=(r=4,function(e){if(Array.isArray(e))return e}(n=e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=n){var r,i,a=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(e){l=!0,i=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw i}}return a}}(n,r)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=i[1],o=i[3];if(!o)return a;if("function"==typeof btoa){var l=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(l),s="/*# ".concat(c," */"),u=o.sources.map((function(e){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(e," */")}));return[a].concat(u).concat([s]).join("\n")}return[a].join("\n")}},753:(e,t,n)=>{e.exports=n.p+"4b405a1eb31ced9eb991a08e4c429359.png"},162:function(e,t,n){var r,i;void 0===(i="function"==typeof(r=function(){"use strict";function t(e,t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){l(r.response,t,n)},r.onerror=function(){console.error("could not download file")},r.send()}function r(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function i(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:void 0,o=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(e,n,o){var l=a.URL||a.webkitURL,c=document.createElement("a");n=n||e.name||"download",c.download=n,c.rel="noopener","string"==typeof e?(c.href=e,c.origin===location.origin?i(c):r(c.href)?t(e,n,o):i(c,c.target="_blank")):(c.href=l.createObjectURL(e),setTimeout((function(){l.revokeObjectURL(c.href)}),4e4),setTimeout((function(){i(c)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,n,a){if(n=n||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,a),n);else if(r(e))t(e,n,a);else{var o=document.createElement("a");o.href=e,o.target="_blank",setTimeout((function(){i(o)}))}}:function(e,n,r,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof e)return t(e,n,r);var l="application/octet-stream"===e.type,c=/constructor/i.test(a.HTMLElement)||a.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||l&&c||o)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=s?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=e:location=e,i=null},u.readAsDataURL(e)}else{var d=a.URL||a.webkitURL,m=d.createObjectURL(e);i?i.location=m:location.href=m,i=null,setTimeout((function(){d.revokeObjectURL(m)}),4e4)}});a.saveAs=l.saveAs=l,e.exports=l})?r.apply(t,[]):r)||(e.exports=i)},379:(e,t,n)=>{"use strict";var r,i=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),a=[];function o(e){for(var t=-1,n=0;n<a.length;n++)if(a[n].identifier===e){t=n;break}return t}function l(e,t){for(var n={},r=[],i=0;i<e.length;i++){var l=e[i],c=t.base?l[0]+t.base:l[0],s=n[c]||0,u="".concat(c," ").concat(s);n[c]=s+1;var d=o(u),m={css:l[1],media:l[2],sourceMap:l[3]};-1!==d?(a[d].references++,a[d].updater(m)):a.push({identifier:u,updater:g(m,t),references:1}),r.push(u)}return r}function c(e){var t=document.createElement("style"),r=e.attributes||{};if(void 0===r.nonce){var a=n.nc;a&&(r.nonce=a)}if(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),"function"==typeof e.insert)e.insert(t);else{var o=i(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var s,u=(s=[],function(e,t){return s[e]=t,s.filter(Boolean).join("\n")});function d(e,t,n,r){var i=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=u(t,i);else{var a=document.createTextNode(i),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(a,o[t]):e.appendChild(a)}}function m(e,t,n){var r=n.css,i=n.media,a=n.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),a&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var p=null,f=0;function g(e,t){var n,r,i;if(t.singleton){var a=f++;n=p||(p=c(t)),r=d.bind(null,n,a,!1),i=d.bind(null,n,a,!0)}else n=c(t),r=m.bind(null,n,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r));var n=l(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<n.length;r++){var i=o(n[r]);a[i].references--}for(var c=l(e,t),s=0;s<n.length;s++){var u=o(n[s]);0===a[u].references&&(a[u].updater(),a.splice(u,1))}n=c}}}},458:e=>{e.exports='<svg viewBox="0 0 18 17" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><desc>Created with Sketch.</desc><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="图标" transform="translate(-450.000000, -93.000000)" stroke="#FFFFFF"><g id="报警处理" transform="translate(448.000000, 91.000000)"><g transform="translate(3.000000, 3.000000)"><path d="M7.96772376,4.5 C5.75858476,4.5 3.96772376,6.290861 3.96772376,8.5 L3.96772376,13 C3.96772376,13.2761424 4.19158138,13.5 4.46772376,13.5 L11.4677238,13.5 C11.7438661,13.5 11.9677238,13.2761424 11.9677238,13 L11.9677238,8.5 C11.9677238,6.290861 10.1768628,4.5 7.96772376,4.5 Z" id="Rectangle-10"></path><path d="M2,15.5 L14,15.5" id="Path-15" stroke-linecap="round"></path><path d="M8,0.193967695 L8,2.16869191" id="Path-16" stroke-linecap="round"></path><path d="M14.1335512,2.30494014 L12.1335512,3.30494014" id="Path-16" stroke-linecap="round"></path><path d="M2.06860204,2.28819153 L4.06860204,3.28819153" id="Path-16" stroke-linecap="round"></path><path d="M0.0309549562,6.36409923 L2.10810334,6.36409923" id="Path-16" stroke-linecap="round"></path><path d="M14,6.25 L16.0771484,6.25" id="Path-16" stroke-linecap="round"></path></g></g></g></g></svg>'},139:e=>{e.exports='<svg viewBox="0 0 15 15" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><desc>Created with Sketch.</desc><g id="页面1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="5" transform="translate(-623.000000, -143.000000)" fill-rule="nonzero"><g id="zhuyi" transform="translate(623.000000, 143.000000)"><path d="M0,7.5 C0,10.1794919 1.42949188,12.6554445 3.74999997,13.9951905 C6.07050806,15.3349365 8.92949194,15.3349365 11.25,13.9951905 C13.5705081,12.6554445 15,10.1794919 15,7.5 C15,3.35786435 11.6421356,0 7.5,0 C3.35786438,0 0,3.35786435 0,7.5 Z" id="路径" fill="#E78F41"></path><path d="M7.5,10.7142857 C7.67863278,10.7142857 7.8436963,10.8368136 7.9330127,11.0357143 C8.0223291,11.234615 8.0223291,11.4796707 7.9330127,11.6785714 C7.8436963,11.8774721 7.67863278,12 7.5,12 C7.22385762,12 7,11.7121831 7,11.3571429 C7,11.0021027 7.22385762,10.7142857 7.5,10.7142857 L7.5,10.7142857 Z M7.5,3 C7.77614235,3 8,3.28781695 8,3.64285714 L8,9.10714286 C8,9.46218305 7.77614235,9.75 7.5,9.75 C7.22385762,9.75 7,9.46218305 7,9.10714286 L7,3.64285714 C7,3.28781695 7.22385762,3 7.5,3 Z" id="形状" fill="#FFFFFF"></path></g></g></g></svg>'},739:e=>{e.exports='<svg viewBox="0 0 25 26" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="画板" transform="translate(-911.000000, -772.000000)"><g id="报警卡片" transform="translate(912.000000, 773.000000)"><path d="M0,2 L16.2785059,2 L16.2785059,5.62910467 L19,6.95959227 L19,20 C19,21.1045695 18.1045695,22 17,22 L0,22 L0,22 L0,2 Z" id="矩形" fill="#D0E4FF"></path><g id="编组-62" stroke-width="1.5"><line x1="0" y1="9.5" x2="21" y2="9.5" id="路径-197" stroke="#646669"></line><line x1="5" y1="14.5" x2="17" y2="14.5" id="路径-197" stroke="#4359C7"></line><path d="M21,6.99371622 L21,21.5555556 C21,22.9055849 19.9553311,24 18.6666667,24 L2.33333333,24 C1.04466892,24 0,22.9055849 0,21.5555556 L0,4.44444444 C0,3.09441506 1.04466892,2 2.33333333,2 L16.3312777,2" id="路径" stroke="#646669"></path><line x1="5" y1="18.5" x2="17" y2="18.5" id="路径-197" stroke="#4359C7"></line><circle id="椭圆形" stroke="#4359C7" cx="19.5" cy="3.5" r="3.5"></circle></g></g></g></g></svg>'},785:e=>{e.exports='<svg viewBox="0 0 26 23" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="画板" transform="translate(-913.000000, -705.000000)"><g id="批量指令" transform="translate(914.000000, 705.000000)"><circle id="椭圆形" fill="#D0E4FF" cx="12.5" cy="11.5" r="8.5"></circle><g id="编组-59" stroke-width="1.5"><path d="M16,16 C17.2053706,15.0319782 18,13.3748952 18,11.4932461 C18,9.62032045 17.2127213,7.96988345 16.0167379,7" id="路径" stroke="#4359C7" stroke-linecap="round"></path><path d="M20,20 C22.4107411,18.2790724 24,15.333147 24,11.9879931 C24,8.65834747 22.4254427,5.72423725 20.0334758,4" id="路径" stroke="#4359C7" stroke-linecap="round"></path><path d="M2,6.60040435 L3.96954604,6.60040435 C4.52384868,6.60040435 5.05329166,6.37036109 5.43153775,5.96516816 L10.1345021,0.927157344 C10.3229366,0.725298414 10.639332,0.714415811 10.841191,0.90285037 C10.9424892,0.997411893 11,1.12977264 11,1.2683483 L11,21.7334937 C11,22.0096361 10.7761424,22.2334937 10.5,22.2334937 C10.3615969,22.2334937 10.229385,22.1761255 10.1348408,22.0750472 L5.43136216,17.0464977 C5.05318558,16.6421843 4.52433797,16.4127115 3.97072539,16.4127115 L2,16.4127115 C0.8954305,16.4127115 7.07454551e-14,15.517281 0,14.4127115 L0,8.60040435 C-6.76368306e-14,7.49583486 0.8954305,6.60040435 2,6.60040435 Z" id="路径-3" stroke="#575757"></path></g></g></g></g></svg>'},640:e=>{e.exports='<svg viewBox="0 0 15 18" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="图标" transform="translate(-190.000000, -421.000000)" fill="#9299B9" fill-rule="nonzero"><g id="报警处理" transform="translate(190.000000, 421.000000)"><path d="M9.6100775,3.54145955 C9.6100775,3.54145955 12.0462678,4.37356666 12.4887433,6.73668703 L12.4887433,12.9779889 L2.00757927,12.9779889 L2.00757927,6.8704862 C2.00757927,6.8704862 2.30289307,4.01703479 5.1815589,3.54145955 C5.1815589,3.54145955 4.69412277,-0.0106986349 7.42166559,0.00425657019 C7.42166559,0.00425657019 7.44121502,0.00186209093 7.47662641,0.000383725157 L7.58151343,5.60555075e-13 C8.109967,0.0162616192 9.75897682,0.323355143 9.6100775,3.54145955 Z M7.37263371,0.899246063 C6.88532363,0.899246063 6.49028077,1.30218979 6.49028077,1.79924606 C6.49028077,2.29630234 6.88532363,2.69924606 7.37263371,2.69924606 C7.85994378,2.69924606 8.25498665,2.29630234 8.25498665,1.79924606 C8.25498665,1.30218979 7.85994378,0.899246063 7.37263371,0.899246063 Z M2.11096881,13.7959383 C2.11096881,13.7959383 0.501894817,13.7917509 0,15.5506814 L5.34377353,15.5506814 C5.34377353,15.5506814 5.5505526,17.9991461 7.24915163,17.9957562 C7.24915163,17.9957562 9.24207413,18.1951589 9.37497524,15.5793954 L15,15.5793954 C15,15.5793954 14.8229306,14.0639355 12.7420675,13.7959383 L2.11096881,13.7959383 Z" id="形状"></path></g></g></g></svg>'},714:e=>{e.exports='<svg viewBox="0 0 20 26" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="画板" transform="translate(-834.000000, -704.000000)"><g id="报警铃铛" transform="translate(834.000000, 705.000000)"><g id="编组-9" stroke-width="1.5"><path d="M10,4.30555556 C11.7925449,4.30555556 13.4153897,5.03212793 14.5900983,6.20683654 C15.7648069,7.38154514 16.4913793,9.00438997 16.4913793,10.7968884 L16.4913793,10.7968884 L16.4909536,17.6752778 L18.2407407,17.6759259 C18.51944,17.6759259 18.7717548,17.7888911 18.9543948,17.9715311 C19.1370348,18.1541711 19.25,18.4064859 19.25,18.6851852 C19.25,18.9638844 19.1370348,19.2161992 18.9543948,19.3988393 C18.7717548,19.5814793 18.51944,19.6944444 18.2407407,19.6944444 L18.2407407,19.6944444 L1.75925926,19.6944444 C1.48056001,19.6944444 1.2282452,19.5814793 1.04560519,19.3988393 C0.86296519,19.2161992 0.75,18.9638844 0.75,18.6851852 C0.75,18.4064859 0.86296519,18.1541711 1.04560519,17.9715311 C1.2282452,17.7888911 1.48056001,17.6759259 1.75953739,17.6759259 L1.75953739,17.6759259 L3.50792407,17.6752775 L3.50862069,10.7969349 C3.50862069,9.00438997 4.23519307,7.38154514 5.40990167,6.20683654 C6.58461027,5.03212793 8.2074551,4.30555556 10,4.30555556 Z" id="形状结合" stroke="#646669"></path><path d="M10,2.66666667 C10.7203714,2.66666667 11.3043478,2.069713 11.3043478,1.33333333 C11.3043478,0.596953667 10.7203714,0 10,0 C9.27962859,0 8.69565217,0.596953667 8.69565217,1.33333333 C8.69565217,2.069713 9.27962859,2.66666667 10,2.66666667 Z" id="椭圆形" stroke="#4359C7"></path><path d="M10,24 C11.6808666,24 13.0434783,22.8060927 13.0434783,21.3333333 C13.0434783,21.3333333 6.95652174,21.3333333 6.95652174,21.3333333 C6.95652174,22.8060927 8.31913337,24 10,24 Z" id="椭圆形" stroke="#4359C7"></path></g><path d="M10,7 C12.209139,7 14,8.790861 14,11 L14,17 L14,17 L6,17 L6,11 C6,8.790861 7.790861,7 10,7 Z" id="矩形" fill="#D0E4FF"></path></g></g></g></svg>'},879:e=>{e.exports='<svg t="1630029493130" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2125" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css"></style></defs><path d="M814.56 128c77.472 0 141.568 57.536 145.28 130.88L960 265.6v126.848a32 32 0 0 1-63.776 3.744L896 392.448V265.6c0-38.496-33.152-70.912-76.032-73.44L814.528 192H209.472c-43.648 0-78.56 30.848-81.28 68.8L128 265.6v492.8c0 38.496 33.152 70.912 76.032 73.44l5.44 0.16h207.872a32 32 0 0 1 3.744 63.776l-3.744 0.224H209.44c-77.472 0-141.568-57.536-145.28-130.88L64 758.4V265.6c0-74.272 61.824-133.984 138.464-137.44L209.44 128h605.12z" fill="#000000" p-id="2126"></path><path d="M896 320a32 32 0 0 1 3.744 63.776L896 384H128a32 32 0 0 1-3.744-63.776L128 320h768zM384 496a32 32 0 0 1 3.744 63.776L384 560H256a32 32 0 0 1-3.744-63.776L256 496h128zM922.944 489.536a112 112 0 0 1 4.224 153.92l-4.224 4.48-79.2 79.168a32 32 0 0 1-47.744-42.464l2.464-2.784 79.2-79.2a48 48 0 0 0-64.448-70.976l-3.424 3.104-79.2 79.2a32 32 0 0 1-47.744-42.464l2.496-2.784 79.2-79.2a112 112 0 0 1 158.4 0zM549.92 862.56a112 112 0 0 1-4.224-153.92l4.224-4.48 79.2-79.2a32 32 0 0 1 47.712 42.464l-2.464 2.784-79.2 79.2a48 48 0 0 0 64.448 71.008l3.424-3.136 79.2-79.168a32 32 0 0 1 47.744 42.464l-2.496 2.784-79.2 79.2a112 112 0 0 1-158.4 0z" fill="#000000" p-id="2127"></path><path d="M780.576 585.152a32 32 0 0 1 48.352 41.728l-2.624 3.04-139.2 142.144a32 32 0 0 1-48.32-41.728l2.624-3.072 139.168-142.112z" fill="#000000" p-id="2128"></path></svg>'},817:e=>{e.exports='<svg viewBox="0 0 18 18" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="图标" transform="translate(-189.000000, -781.000000)" fill="#9299B9" fill-rule="nonzero"><g id="规则管理" transform="translate(189.000000, 781.000000)"><path d="M7.36939386,10.9949445 L4.00108725,10.9949445 C3.44876325,10.9949445 3.00081544,10.5473243 3.00081544,9.99540413 C3.00081544,9.44348399 3.44876325,8.99803664 4.00108725,8.99803664 L8.0021745,8.99803664 C8.16961131,8.99803664 8.31965208,9.04584074 8.45664583,9.11971982 C9.55694482,7.83118185 11.1747758,6.99678289 13.0035336,6.99678289 C14.1016581,6.99678289 15.1149769,7.31185542 16,7.82683602 L16,1.39283784 C15.995651,0.623626301 15.3715684,0 14.5996195,0 L1.40038054,0 C0.630606143,0 0.00434900788,0.623626301 0,1.39283784 L0,16.6010625 C0,17.0725848 0.23702093,17.5136864 0.632780647,17.7700902 C1.02636586,18.028667 1.52432726,18.0721253 1.95705355,17.8852547 L7.54552868,15.4581098 C7.20413156,14.7062816 7.00407719,13.8762284 7.00407719,12.9961983 C7.00190269,12.2921742 7.14541995,11.6250896 7.36939386,10.9949445 Z M4.00108725,3.99816165 L12.0032618,3.99816165 C12.5555858,3.99816165 13.0035336,4.44578193 13.0035336,4.99770207 C13.0035336,5.54962221 12.5555858,5.99724248 12.0032618,5.99724248 L4.00108725,5.99724248 C3.44876325,5.99724248 3.00081544,5.54962221 3.00081544,4.99770207 C3.00081544,4.44578193 3.44876325,3.99816165 4.00108725,3.99816165 Z" id="形状"></path><path d="M12.6695652,15.8304348 L10.1652174,13.2 C9.95,12.9782609 9.94347826,12.6108696 10.1456522,12.3804348 C10.35,12.1478261 10.6913043,12.1391304 10.9043478,12.3586957 L13.05,14.6173913 L17.1369565,10.1956522 C16.2369565,8.86956522 14.7195652,8 13,8 C10.2369565,8 8,10.2391304 8,13 C8,15.7630435 10.2391304,18 13,18 C15.7630435,18 18,15.7608696 18,13 C18,12.3804348 17.8869565,11.7869565 17.6804348,11.2413043 L13.4434783,15.8282609 C13.2282609,16.0586957 12.8847826,16.0586957 12.6695652,15.8304348 Z" id="路径"></path></g></g></g></svg>'},755:e=>{e.exports='<svg viewBox="0 0 18 14" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="图标" transform="translate(-189.000000, -743.000000)" fill="#9299B9" fill-rule="nonzero"><g id="通用配置" transform="translate(189.000000, 743.000000)"><path d="M12.5789474,1.51592357 C14.245614,1.51592357 15.7719298,2.1044586 17,3.06751592 L17,1.19490446 C17,0.517197452 16.3508772,0 15.5614035,0 L1.43859649,0 C0.631578947,0 0,0.517197452 0,1.19490446 L0,7.3477707 L5.56140351,7.3477707 C6.22807018,4.03057325 9.12280702,1.51592357 12.5789474,1.51592357 L12.5789474,1.51592357 Z M6.68421053,12.9299363 L1.29824561,12.9299363 C0.947368421,12.9299363 0.649122807,13.1796178 0.649122807,13.4649682 C0.649122807,13.7503185 0.947368421,14 1.29824561,14 L7.57894737,14 C7.26315789,13.6789809 6.94736842,13.3044586 6.68421053,12.9299363 L6.68421053,12.9299363 Z M5.43859649,8.43566879 L0,8.43566879 L0,9.04203822 C0,9.71974522 0.649122807,10.2547771 1.43859649,10.2547771 L5.56140351,10.2547771 C5.47368421,9.7910828 5.42105263,9.29171975 5.42105263,8.79235669 C5.42105263,8.68535032 5.43859649,8.56050955 5.43859649,8.43566879 Z" id="形状"></path><path d="M17.109589,9 C17.109589,8.41780822 17.4691781,7.92123288 18,7.71575342 C17.880137,7.23630137 17.6917808,6.7739726 17.4349315,6.3630137 C16.9212329,6.58561644 16.3219178,6.5 15.9109589,6.0890411 C15.5,5.67808219 15.3972603,5.06164384 15.6369863,4.56506849 C15.2260274,4.32534247 14.7636986,4.11986301 14.2842466,4 C14.0787671,4.51369863 13.5821918,4.89041096 13,4.89041096 C12.4178082,4.89041096 11.9212329,4.53082192 11.7157534,4 C11.2363014,4.11986301 10.7739726,4.30821918 10.3630137,4.56506849 C10.5856164,5.07876712 10.5,5.67808219 10.0890411,6.0890411 C9.67808219,6.5 9.06164384,6.60273973 8.56506849,6.3630137 C8.30821918,6.7739726 8.11986301,7.23630137 8,7.71575342 C8.51369863,7.92123288 8.89041096,8.41780822 8.89041096,9 C8.89041096,9.58219178 8.53082192,10.0787671 8,10.2842466 C8.11986301,10.7636986 8.30821918,11.2260274 8.56506849,11.6369863 C9.07876712,11.4143836 9.67808219,11.5 10.0890411,11.9109589 C10.5,12.3219178 10.6027397,12.9383562 10.3630137,13.4349315 C10.7739726,13.6746575 11.2363014,13.880137 11.7157534,14 C11.9212329,13.4863014 12.4178082,13.109589 13,13.109589 C13.5821918,13.109589 14.0787671,13.4691781 14.2842466,14 C14.7636986,13.880137 15.2260274,13.6917808 15.6369863,13.4349315 C15.4143836,12.9212329 15.5,12.3219178 15.9109589,11.9109589 C16.3219178,11.5 16.9383562,11.3972603 17.4349315,11.6369863 C17.6917808,11.2260274 17.880137,10.7636986 18,10.2842466 C17.4863014,10.0787671 17.109589,9.58219178 17.109589,9 L17.109589,9 Z M12.9828767,11.4315068 C11.6472603,11.4315068 10.5513699,10.3356164 10.5513699,9 C10.5513699,7.66438356 11.6472603,6.56849315 12.9828767,6.56849315 C14.3184932,6.56849315 15.4143836,7.66438356 15.4143836,9 C15.4143836,10.3527397 14.3356164,11.4315068 12.9828767,11.4315068 Z" id="形状"></path><path d="M11.4778488,8.97282404 C11.4778488,9.80125116 12.1494217,10.472824 12.9778488,10.472824 C13.8062759,10.472824 14.4778488,9.80125116 14.4778488,8.97282404 C14.4778488,8.14439691 13.8062759,7.47282404 12.9778488,7.47282404 C12.1494217,7.47282404 11.4778488,8.14439691 11.4778488,8.97282404 Z" id="路径"></path></g></g></g></svg>'},61:(e,t,n)=>{var r=n(698).default;function i(){"use strict";e.exports=i=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},n=Object.prototype,a=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},l="function"==typeof Symbol?Symbol:{},c=l.iterator||"@@iterator",s=l.asyncIterator||"@@asyncIterator",u=l.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,n){return e[t]=n}}function m(e,t,n,r){var i=t&&t.prototype instanceof g?t:g,a=Object.create(i.prototype),l=new S(r||[]);return o(a,"_invoke",{value:x(e,n,l)}),a}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=m;var f={};function g(){}function v(){}function h(){}var y={};d(y,c,(function(){return this}));var b=Object.getPrototypeOf,A=b&&b(b(_([])));A&&A!==n&&a.call(A,c)&&(y=A);var E=h.prototype=g.prototype=Object.create(y);function w(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,o,l,c){var s=p(e[i],e,o);if("throw"!==s.type){var u=s.arg,d=u.value;return d&&"object"==r(d)&&a.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,l,c)}),(function(e){n("throw",e,l,c)})):t.resolve(d).then((function(e){u.value=e,l(u)}),(function(e){return n("throw",e,l,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(a,a):a()}})}function x(e,t,n){var r="suspendedStart";return function(i,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw a;return{value:void 0,done:!0}}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var l=B(o,n);if(l){if(l===f)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=p(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function B(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,B(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=p(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,f;var a=i.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function _(e){if(e){var t=e[c];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(a.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:j}}function j(){return{value:void 0,done:!0}}return v.prototype=h,o(E,"constructor",{value:h,configurable:!0}),o(h,"constructor",{value:v,configurable:!0}),v.displayName=d(h,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,d(e,u,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},w(C.prototype),d(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,i,a){void 0===a&&(a=Promise);var o=new C(m(e,n,r,i),a);return t.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},w(E),d(E,u,"Generator"),d(E,c,(function(){return this})),d(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=_,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],o=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var l=a.call(i,"catchLoc"),c=a.call(i,"finallyLoc");if(l&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;O(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:_(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},t}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},698:e=>{function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},687:(e,t,n)=>{var r=n(61)();e.exports=r;try{regeneratorRuntime=r}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={id:r,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var i=r.length-1;i>-1&&!e;)e=r[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),n.nc=void 0,(()=>{"use strict";const e=xadmin;var t=n.n(e);function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,l=[],c=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){s=!0,i=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(s)throw i}}return l}}(e,t)||i(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o.apply(this,arguments)}function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function c(e){var t=function(e,t){if("object"!==l(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===l(t)?t:String(t)}function s(e,t,n){return(t=c(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const u=React;var d=n.n(u);const m=xadminForm,p=xadminUi,f=_;var g=n.n(f);const v=antd,h=function(t){var n,r=t.input,i=t.field,l=i.name,c=i.schema,s=void 0===c?{}:c,u=useI18n(),m=u.t,f=(u.i18n,(0,e.use)("settings").settings.warning),h=l&&l.substring(l.indexOf("[")+1,l.lastIndexOf("]"));if(null!=s&&s.type)try{n=(0,e.use)("form",(function(e){return{type:e.values.rules&&g().get(e.values.rules[h],s.type)}})).type}catch(e){console.log(e)}var y,b=a(d().useState({}),2),A=b[0],E=b[1],w=a(d().useState([]),2),C=w[0],x=w[1],B=a(d().useState(!1),2),k=B[0],O=B[1],S={name:"file",accept:".mp3,.wav",action:(0,e.api)({name:"media"}).getHost()+"core/media/warning",headers:g().omit((0,e.api)({name:"media"}).getHeaders(),"Content-Type")},_=function(e){var t=e.file;if("removed"===t.status)return r.onChange(),void O(!1);if(O(!0),t.status,"done"===t.status){O(!1),v.message.success("".concat(t.name," ").concat(m("上传成功")));var n=t.response;n&&n.url&&r.onChange("/rest"+n.url)}else if("error"===t.status){var i,a,o;O(!1);var l="".concat(t.name," ").concat((null==t||null===(i=t.response)||void 0===i?void 0:i.message)||m("上传失败！"));E({fileList:[{uid:null==t||null===(a=t.originFileObj)||void 0===a?void 0:a.uid,name:null==t||null===(o=t.originFileObj)||void 0===o?void 0:o.name,status:null==t?void 0:t.status,response:l}]}),v.message.error(l)}},j=null==r?void 0:r.value,P=!j;return j?null!=C&&C.length&&null!==(y=C.filter((function(e){return e.audio==j})))&&void 0!==y&&y.length?(g().omitBy(S,["fileList"]),P=!0):S.fileList=[{name:j,status:"success"}]:g().omitBy(S,["fileList"]),d().useEffect((function(){var e,t=null==f?void 0:f.warningkind;if(null!=t&&t.length&&g().isArray(n)&&null!==(e=n)&&void 0!==e&&e.length){var r=t.filter((function(e){return n.some((function(t){return t===e.id}))})).filter((function(e){return e.audio}));x(r)}}),[n,null==f?void 0:f.warningkind]),d().useMemo((function(){var e;return d().createElement("div",{style:{display:"flex",alignItems:"center"}},n&&g().isArray(n)&&null!=C&&C.length&&null!==(e=C.filter((function(e){return e.audio==j})))&&void 0!==e&&e.length||n&&g().isArray(n)&&g().isEmpty(j)?d().createElement(v.Select,{allowClear:!0,style:{width:200},value:null==r?void 0:r.value,onChange:function(e){r.onChange(e)}},C.map((function(e){return d().createElement(v.Select.Option,{value:null==e?void 0:e.audio},null==e?void 0:e.name)}))):null,d().createElement("div",{style:n?{marginLeft:"1rem"}:{}},d().createElement(v.Upload,o({},S,A,{onChange:_}),P&&d().createElement(v.Button,{loading:k},d().createElement(p.Icon,{type:"upload"})," ",m("上传报警声音")))))}),[j,C,P,A])};var y=v.Select.Option,b=v.Select.OptGroup,A=function(e){var t,n=e.input,r=n.value,i=n.onChange,o=e.tags,l=(e.model,e.loading,a(d().useState([]),2)),c=l[0],s=l[1],u=null!=e&&null!==(t=e.fieldValue)&&void 0!==t&&t.length?null==e?void 0:e.fieldValue.filter((function(e){return e.indexOf("var.")>-1})).map((function(e){return e.substr(e.indexOf(".")+1)})):void 0;d().useEffect((function(){r?i(r):u&&(null==u?void 0:u.length)&&i(u)}),[]),d().useEffect((function(){var e=function(e,t){var n=null!=e&&e.length?e.filter((function(e){if(null!=t&&t.length&&t.findIndex((function(t){return t==e.id}))>-1)return e})):[],r={数据点:null!=n&&n.length?n.reduce((function(e,t){return e[t.name]=t.id,e}),{}):{}};return r}(o,u);s(e),i(u)}),[JSON.stringify(o),JSON.stringify(u)]);var m=function e(t){if(!g().isEmpty(t)&&g().isArray(t)){if(!g().isObject(t[1])){if(t[0]&&g().isString(t[0])&&t[0].indexOf("prefix:")>-1){var n="".concat(t[0].substr(0,t[0].indexOf("prefix:")),"（").concat(t[0].substr(t[0].indexOf("prefix:")+7),"）");return d().createElement(y,{key:t[1],value:t[1]},n)}return d().createElement(y,{key:t[1],value:t[1]},t[0])}e(t[1])}};return d().createElement(d().Fragment,null,d().createElement(v.Select,{mode:"multiple",value:g().isEmpty(r)?u:r,style:{width:300},onChange:function(e){null!=e&&e.length?i(e):u&&(null==u?void 0:u.length)&&i(u)}},Object.entries(c).map((function(e){return d().createElement(b,{key:e[0],label:e[0]},g().isObject(e[1])&&!g().isEmpty(e[1])?Object.entries(e[1]).map((function(e){return m(e)})):null)}))))},E=(v.Select.Option,v.Select.OptGroup,function e(t,n){return t&&g().isObject(t)&&Object.values(t).forEach((function(t){null!=t&&t.length&&t.forEach((function(t){var r;!g().isObject(t)||null!=t&&t.var?(null==t||null===(r=t.var)||void 0===r?void 0:r.length)&&n.push(t.var[0]):e(t,n)}))})),n}),w=function(t){var n,r=t.input,i=(r.onChange,r.value,t.field),l=i.name,c=i.schema,s=void 0===c?{}:c,u=(i.type,t.table),m=a(d().useState(null),2),f=m[0],v=m[1],h=l&&l.substring(l.indexOf("[")+1,l.lastIndexOf("]")),y=a(d().useState([]),2),b=y[0],w=y[1];if(null!=s&&s.logic)try{n=(0,e.use)("form",(function(e){return{logic:e.values.rules&&g().get(e.values.rules[h],s.logic)}})).logic}catch(e){console.log(e)}return d().useEffect((function(){if(n){n=n.type?n.logic:n;var e=E(n,[]);w(e)}}),[n]),d().useEffect((function(){(0,e.api)({name:"core/t/schema/".concat(u)}).fetch("",{}).then((function(e){var t=e.json;v(t)}))}),[u]),d().createElement(d().Fragment,null,null!=f&&f.id?d().createElement(p.C,{is:"TagWrap",tableDataId:null==t?void 0:t.nodeId,tableId:f.id},(function(e){return d().createElement(A,o({},t,e,{table:f,fieldValue:b}))})):null)};function C(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}function x(e,t){if(null==e)return{};var n,r,i=C(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var B=n(379),k=n.n(B),O=n(575);k()(O.Z,{insert:"head",singleton:!1}),O.Z.locals;var S=["input","field"];function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function D(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw a}}}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var T=function(t){var n=t.input,r=n.onChange,i=n.value,l=t.field,c=x(t,S),s=a(d().useState([]),2),u=s[0],m=s[1];return d().useEffect((function(){(0,e.api)({name:"core/systemVariable"}).query({fields:["type","value"],order:{createTime:"DESC"}},{}).then((function(e){var t=e.items;m(t)}))}),[]),d().createElement(F,o({errorTips:[],parentSchema:[],hasLoading:!1,systemVariable:u,value:i,onChange:r,field:l},c))},F=function(e){var t,r,i=e.errorTips,o=e.parentSchema,l=e.hasLoading,c=e.systemVariable,u=e.value,m=e.onChange,f=e.field,v=e.select,h=e.children,y=a(d().useState(!1),2),b=y[0],A=y[1],E=d().useRef(null),w=!(i&&i.length>0),C=u&&g().isPlainObject(u)&&u.bind,x=null==f||null===(t=f.extendFlow)||void 0===t?void 0:t.type,B=x?null:(null==f?void 0:f.limit)||(null==f||null===(r=f.extendFlow)||void 0===r?void 0:r.limit),k=n(879),O=null;u&&g().isPlainObject(u)&&u.bind&&(O=u.initValue);var S=function(e,t){var n,r,i=(s(n={tableData:{processName:"触发设备",groupName:"设备组",icon:""},table:{processName:"触发设备表",groupName:"设备组",icon:""}},"table",{processName:"触发工作表",groupName:"工作表组",icon:""}),s(n,"user",{processName:"触发用户",groupName:"用户组",icon:""}),s(n,"tableRecord",{processName:"触发工作表记录",groupName:"工作表记录组",icon:""}),n),a={},o=D(g().keys(e));try{for(o.s();!(r=o.n()).done;){var l=r.value;a[l]=g().cloneDeep(e[l]);var c=a[l];if(t)if(l==="#$".concat(t))delete a[l].properties;else if(c.nodeType===t){var u,d=D(g().keys(a[l].properties));try{for(d.s();!(u=d.n()).done;){var m=u.value;delete a[l].properties[m].properties,a[l].properties[m].nodeType=t}}catch(e){d.e(e)}finally{d.f()}}else delete a[l];if(i[c.nodeType]&&-1===l.indexOf("#$")){c.title=i[c.nodeType].groupName;var p,f=D(g().keys(c.properties));try{for(f.s();!(p=f.n()).done;){var v=p.value;if(c.properties[v].nodeType){var h,y=D(g().keys(c.properties[v].properties));try{for(y.s();!(h=y.n()).done;){var b=h.value;c.properties[v].properties[b].nodeType=c.properties[v].nodeType}}catch(e){y.e(e)}finally{y.f()}}c.properties[v].nodeType=c.nodeType}}catch(e){f.e(e)}finally{f.f()}delete c.nodeType}-1!==l.indexOf("#$")&&i[l.replace("#$","")]&&(c.title=i[l.replace("#$","")].processName,c.nodeType=l.replace("#$",""))}}catch(e){o.e(e)}finally{o.f()}return a};return d().createElement(d().Fragment,null,d().createElement("div",{style:{fontSize:12,color:"red"}},w?null:"变量[ "+i.join(", ")+" ] 已不存在"),d().createElement("div",{className:"iot-flow-slate-editor-wrap",ref:E},d().createElement("div",{className:"iot-flow-slate-editor-comp"},h&&!C?d().createElement("div",null,h):null,d().createElement("div",{className:"iot-flow-slate-editor",style:{display:h&&!C?"none":"block"}},d().createElement(p.C,{is:"CodeEditor.VariableEditor",schema:function(){var e,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r={type:"object",properties:{}},i=D(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]);try{for(i.s();!(e=i.n()).done;){var a=e.value,o=S(a.properties,n);g().isEmpty(o)||(r.properties[a.id]={title:a.title,type:a.type,properties:S(a.properties,n)})}}catch(e){i.e(e)}finally{i.f()}if(!n){r.properties["#$systemVariable"]={title:_r("系统变量"),type:"object",properties:{}},r.properties["#$time"]={title:_r("系统时间"),type:"string",format:"datetime"};var l,c=D(t);try{for(c.s();!(l=c.n()).done;){var s=l.value;r.properties["#$systemVariable"].properties[s.uid]={title:s.name,type:s.type},"date"===s.type&&(r.properties["#$systemVariable"].properties[s.uid].type="string",r.properties["#$systemVariable"].properties[s.uid].format="datetime")}}catch(e){c.e(e)}finally{c.f()}}return r}(o,c,x)||[],placement:"right",panelWidth:500,value:O,onChange:function(e){var t=function(e,t){return e&&e.length?e.filter((function(e){return e.variable||e.text})).map((function(e){if(g().isString(e))return e;if(e.text)return e.text;var n,r,i={defineSchema:{type:e.variable.type,format:e.variable.format},name:e.variable.title,value:e.variable.path,type:t||(null===(n=e.variable)||void 0===n||null===(r=n.defineSchema)||void 0===r?void 0:r.nodeType)||e.variable.type};return-1!==e.variable.path.indexOf("#$systemVariable")?i.type="systemVariable":-1!==e.variable.path.indexOf("#$time")&&(i.type="systemTime"),i.value=e.variable.path.replace&&e.variable.path.replace(".models","").replace(".nodes",""),i})):null}(null==e?void 0:e.origin,x);t&&t.length>0?m("single"===v?{bind:!0,value:t[0],initValue:g().cloneDeep(e)}:{bind:!0,value:t,initValue:g().cloneDeep(e)}):m(null)},limit:B,nodeType:x,select:v,hasLoading:l,panelVisible:b,panelTargetRef:E}))),d().createElement("div",{className:"iot-flow-slate-editor-icon",style:{width:"32px",height:"32px"},dangerouslySetInnerHTML:{__html:k},onClick:function(){A(!b)}})))},L=function(e){var t=e.children,n=e.onChange,r=e.value,i=e.field,a=(e.error,null==i?void 0:i.extendFlow),o=null==i?void 0:i.type,l=null==a?void 0:a.show,c=null==a?void 0:a.onlySelect,s=null!=a&&a.mode?a.mode:"single";if(r&&g().isPlainObject(r)&&r.bind&&g().isPlainObject(r)){var u=r.value;g().isArray(u),g().isPlainObject(u)}var m=c?d().createElement(Input,{placeholder:"仅支持变量",disabled:!0}):t,p=d().createElement(T,{input:{onChange:n,value:r},field:i,select:"single"},m),f=d().createElement(d().Fragment,null,d().createElement(T,{input:{onChange:n,value:r},field:i,select:"multiple"},m));return l?"input"==o?d().createElement(T,{input:{onChange:n,value:r},field:i}):"multiple"==s?f:p:t},M=function(e){var t,n=e.label,r=e.meta,i=e.input,a=e.field,l=e.children,c=a.attrs||{},s=r.touched&&(r.error||r.submitError),u=a.description||a.help,m={required:a.required},p=a.option&&a.option.groupSize||c.groupSize||{labelCol:{sm:{span:24}},wrapperCol:{sm:{span:24}}};!((null==i?void 0:i.value)&&g().isPlainObject(i.value)&&(null==i||null===(t=i.value)||void 0===t?void 0:t.bind))&&s&&(m.validateStatus="error",m.help=s);var f=P(P(P({},m),p),{},{labelAlign:"left"}),h=l||d().createElement(Input,o({},i,c));return d().createElement(v.Form.Item,o({label:n?d().createElement(d().Fragment,null,d().createElement("span",null,n),u?d().createElement(v.Tooltip,{placement:"bottom",title:u},d().createElement(QuestionCircleOutlined,{className:"label-des"})):null):null},f),d().createElement(L,o({},i,c,{field:a}),h),a.formText?d().createElement("span",{className:"ant-form-text"}," ",a.formText):null)},N=function(t){var n,r,i,a=t.input,l=t.field,c=(0,e.use)("form").form,s="number",u=null==c||null===(n=c.data)||void 0===n||null===(r=n.warning)||void 0===r?void 0:r.rules,m=null==l?void 0:l.key.substring((null==l?void 0:l.key.indexOf("["))+1,null==l?void 0:l.key.lastIndexOf("]")),f={fieldType:"inputNumber"},h={type:"object",properties:{delay:P(P({title:_r("延时提醒时长(s)"),type:"number",minimum:1,description:_r("若设置延时提醒时长，产生报警，经过设定时长后进行第一次报警提醒")},f),{},{field:{component:function(e){var t=e.input,n=(e.type,e.select,t.value),r=n||g().isNumber(n)?n:null;return d().createElement(v.InputNumber,o({style:{width:"100%"}},t,{onChange:function(e){t.onChange(e)},value:r}))},extendFlow:{show:!0,limit:["number"]}}})}},y=function(e){return a.onChange(e.delay)},b={delay:function(e){try{return e||0===e?JSON.parse(e):void 0}catch(t){return e}}(a.value)};return null!=a&&a.value&&g().isString(a.value)&&(b={delay:null===(i=u[m])||void 0===i?void 0:i.delaySetting}),d().useMemo((function(){return d().createElement("div",{className:"delay-schema"},d().createElement(p.C,{is:"I18nSchemaForm",formKey:"model.".concat(JSON.stringify(s)),schema:h,initialValues:b,group:function(e){return d().createElement(M,o({},e,{label:null}))},component:function(e){return e.children},onChange:y}))}),[s])};v.Select.Option;const R=function(t){var n,r=t.field.schema,i=t.input,a=i.value,o=i.onChange,l=(0,e.use)("settings").settings,c=(null==l||null===(n=l.warning)||void 0===n?void 0:n.warningkind)||[];return d().createElement(v.Select,{mode:"multiple",value:a||void 0,style:{width:"100%"},placeholder:_t1(r.title)+"...",onChange:function(e){o(e)},options:null!=c&&c.length?c.map((function(e){return{label:e.name,value:e.id}})):[]})};function W(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||i(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function U(e,t,n){return t&&V(e.prototype,t),n&&V(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Y(e,t){return Y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Y(e,t)}function H(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Y(e,t)}function K(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return z(e)}function $(e){return $=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$(e)}const Z=ReactDnD,G=ReactDnDHTML5Backend,J=icons;var X=n(406);k()(X.Z,{insert:"head",singleton:!1}),X.Z.locals;var Q=["isOver","connectDragSource","connectDropTarget","moveRow"];function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=$(e);if(t){var i=$(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return K(this,n)}}var re=-1,ie=function(e){H(n,e);var t=ne(n);function n(){return q(this,n),t.apply(this,arguments)}return U(n,[{key:"render",value:function(){var e=this.props,t=e.isOver,n=e.connectDragSource,r=e.connectDropTarget,i=(e.moveRow,x(e,Q)),a=te(te({},i.style),{},{cursor:"move"}),l=i.className;return t&&(i.index>re&&(l+=" drop-over-downward"),i.index<re&&(l+=" drop-over-upward")),n(r(d().createElement("tr",o({},i,{className:l,style:a}))))}}]),n}(d().Component),ae={beginDrag:function(e){return re=e.index,{index:e.index}}},oe=(0,Z.DropTarget)("row",{drop:function(e,t){var n=t.getItem().index,r=e.index;n!==r&&(e.moveRow(n,r),t.getItem().index=r)}},(function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver()}}))((0,Z.DragSource)("row",ae,(function(e){return{connectDragSource:e.dragSource()}}))(ie)),le=function(e){H(r,e);var t=ne(r);function r(e){var n;return q(this,r),s(z(n=t.call(this,e)),"components",{body:{row:oe}}),s(z(n),"swapArr",(function(e,t,n){return e.splice(n,0,e.splice(t,1)[0]),e})),s(z(n),"moveRow",(function(e,t){var r=n.state.data,i=n.swapArr(W(r),e,t);n.props.setDataSources(W(i)||[]),n.setState({data:W(i)})})),n.state={data:e.dataSource},n}return U(r,[{key:"render",value:function(){var e,t,r=this,i=d().createElement(v.Table,o({},this.props,{className:"DragSortingTable warning-table",columns:this.props.columns,dataSource:this.state.data,components:this.components,onRow:function(e,t){return{index:t,moveRow:r.moveRow}},locale:{emptyText:d().createElement(v.Empty,{description:_t1("暂无数据"),image:n(753)})}}));return d().createElement(d().Fragment,null,null!==(e=this.props)&&void 0!==e&&e.warnSetting?i:d().createElement(Z.DndProvider,{backend:G.HTML5Backend,key:"".concat(null===(t=this.props)||void 0===t?void 0:t.type,"_").concat(Math.random())},i))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.dataSource;if(n!=t.data)return{data:n}}}]),r}(d().Component),ce=function(e){var t=e.input,n=(e.label,e.field);return d().createElement(v.Checkbox,{value:t.value,checked:t.value,onChange:function(e){return t.onChange(e.target.checked)}},d().createElement("span",{style:{color:"rgba(0, 0, 0, 0.45)"}},null==n?void 0:n.descriptions))},se={type:"object",properties:{name:{title:_r("类型名称"),type:"string",description:_r("定义报警类型的名称")},audio:{title:_r("报警声音"),type:"string",description:_r("仅支持MP3、WAV格式"),fieldType:"media_modal",field:{uploadType:"audio"}},alert:{title:_r("报警提醒"),type:"boolean",description:_r("勾选后报警产生会进行声音提醒及数量增加")},handle:{title:_r("报警处理"),type:"boolean",description:_r("勾选报警消息可进行报警确认及处理的操作")},show:{title:_r("是否显示"),type:"boolean",description:_r("勾选后报警类型显示在页面中，否则不显示")},processed:{title:_r("处理状态"),type:"string",enum:["已处理","未处理","null"],enum_title:[_r("已处理"),_r("未处理"),_r("不选择")]},status:{title:_r("确认状态"),type:"string",enum:["已确认","未确认","null"],enum_title:[_r("已确认"),_r("未确认"),_r("不选择")]},isimpact:{title:_r("作用范围"),type:"boolean"}},form:["name","audio",{key:"alert",component:ce},{key:"show",component:ce},{key:"handle",component:ce}],required:["name"]},ue={type:"object",properties:{name:{title:_r("分组名称"),type:"string",description:"定义报警分组的名称"},table:{type:"array",title:_r("设备表"),fieldType:"table",field:{func:"device"},items:{},description:"不选则为全设备表"},tableData:{type:"array",title:_r("设备"),items:{},fieldType:"tableData",field:{func:"device",depend:"table"}}},form:["*","name","table","tableData"],required:["name"]},de=function(e){var t,n,r,i=e.visible,o=e.setVisible,l=e.addWarningKind,c=e.initData,s=e.setEditData,m=e.data,f=e.type,g=e.schema,h=useI18n(),y=h.t,b=(h.i18n,a((0,u.useState)(null),2)),A=b[0],E=b[1],w=a((0,u.useState)(!1),2),C=w[0],x=w[1];switch(f){case"warningKind":t=y("种类信息"),n="WarningKind",r=se;break;case"warningFilter":t=y("分组信息"),n="WarningFilter",r=ue;break;case"logLevel":t=y("日志级别"),n="logLevel",r=g;break;case"lanageManage":t=y("添加语言"),n="lanageManage",r=g;break;default:t=y("种类信息"),n="WarningKind",r=g}return d().createElement(v.Modal,{title:t,visible:i,onOk:function(){if(A&&A.name){o(!1);var e=Object.keys(A).reduce((function(e,t){return"null"!=A[t]&&(e[t]=A[t]),e}),{});l(e)}},destroyOnClose:!0,okButtonProps:{disabled:C},onCancel:function(){o(!1),s(null)},width:"70%"},f&&r?d().createElement(p.C,{is:"I18nSchemaForm",formKey:n,schema:r,onChange:function(e){if("lanageManage"!==f?e.name&&-1==e.name.indexOf(" "):e.name){var t=null!=m&&m.length?m.filter((function(t){return t.name==e.name})):[];c&&c.name==e.name?(x(!1),E(e)):t.length>0?("warningKind"==f?v.message.error(y("报警类型名称已存在")):"warningFilter"==f?v.message.error(y("报警分组名称已存在")):"logLevel"==f?v.message.error(y("日志级别名称已存在")):"lanageManage"==f&&v.message.error(y("语言显示名称已存在")),x(!0)):(x(!1),E(e))}else x(!0)},initialValues:c,component:me}):null)},me=function(e){var t=e.children,n=e.handleSubmit;return d().createElement(v.Form,{onSubmit:n}," ",t," ")};const pe=function(t){var n,r=t.input.onChange,i=t.type,o=t.hiddenTable,l=t.style,c=void 0===l?{}:l,s=t.warnSetting,m=void 0!==s&&s,f=useI18n(),h=f.t,y=(f.i18n,e.app.context.store),b=a(d().useState(!1),2),A=b[0],E=b[1],w=a(d().useState(null),2),C=w[0],x=w[1],B=a(d().useState(null),2),k=B[0],O=B[1],S=(0,e.use)("settings").settings,_=null==S?void 0:S.warning,j=null==S?void 0:S.log,P=null==S?void 0:S.i18n;switch(i){case"warningKind":default:n=null==_?void 0:_.warningkind;break;case"warningFilter":n=null==_?void 0:_.warningFilter;break;case"logLevel":n=null==j?void 0:j.logLevel;break;case"lanageManage":n=null==P?void 0:P.lanageManage}var D,I=a(d().useState(n||[]),2),T=I[0],F=I[1];d().useEffect((function(){var e;switch(i){case"warningKind":default:e=null==_?void 0:_.warningkind;break;case"warningFilter":e=null==_?void 0:_.warningFilter;break;case"logLevel":e=null==j?void 0:j.logLevel;break;case"lanageManage":e=null==P?void 0:P.lanageManage}F(e)}),[i,JSON.stringify(_),JSON.stringify(j),JSON.stringify(P)]),"warningKind"==i?D=[{title:h("类型名称"),dataIndex:"name",editable:!0,width:120},{title:h("报警提醒"),dataIndex:"alert",render:function(e){return h(e?"提醒":"不提醒")},width:80},{title:h("报警处理"),dataIndex:"handle",render:function(e){return h(e?"需处理":"无需处理")},width:80},{title:h("是否显示"),dataIndex:"show",render:function(e){return h(e?"显示":"不显示")},width:80},{title:h("报警声音"),dataIndex:"audio",render:function(e,t){return d().createElement("span",{style:{display:"inline-block",overflow:"hidden",textOverflow:"ellipsis"}},e)},width:120},{title:h("操作"),dataIndex:"operation",render:function(e,t){return d().createElement("div",{style:{textAlign:"center",width:"3rem"}},d().createElement("a",{style:{marginRight:"1rem"},onClick:function(){return N(t)}},d().createElement(p.Icon,{type:"edit"})),t.fix?d().createElement(v.Tooltip,{title:h("内置种类不可删除")}," ",d().createElement(p.Icon,{type:"delete"})," "):d().createElement(v.Popconfirm,{title:h("确认删除?"),onConfirm:function(){return M(t.id)}},d().createElement("a",null,d().createElement(p.Icon,{type:"delete"}))))},width:80}]:"warningFilter"==i?D=[{title:h("分组名称"),dataIndex:"name",editable:!0,width:150},{title:h("设备表"),dataIndex:"table",render:function(e){return null!=e&&e.length?e.map((function(e){return(null==e?void 0:e.name)||(null==e?void 0:e.title)})).join("，"):""},width:150},{title:h("设备"),dataIndex:"tableData",render:function(e){return null!=e&&e.length?e.map((function(e){return(null==e?void 0:e.name)||(null==e?void 0:e.title)||(null==e?void 0:e.id)})).join("，"):""},width:150},{title:h("操作"),dataIndex:"operation",render:function(e,t){return d().createElement("div",{style:{textAlign:"center"}},d().createElement("a",{style:{marginRight:"1rem"},onClick:function(){return N(t)}},d().createElement(p.Icon,{type:"edit"})),t.fix?d().createElement(v.Tooltip,{title:h("内置种类不可删除")}," ",d().createElement(p.Icon,{type:"delete"})," "):d().createElement(v.Popconfirm,{title:h("确认删除?"),onConfirm:function(){return M(t.id)}},d().createElement("a",null,d().createElement(p.Icon,{type:"delete"}))))},width:80}]:"logLevel"==i?D=[{title:h("日志级别"),dataIndex:"name",editable:!0},{title:h("日志类型"),dataIndex:"logType",render:function(e,t){var n=[];return e&&Object.entries(e).forEach((function(e){e[1]&&(n=[].concat(W(n),[e[0]]))})),e?d().createElement(v.Tooltip,{title:n.join("，")},d().createElement("div",{style:{width:"500px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}},n.join("，"))):""}},{title:h("操作"),dataIndex:"operation",render:function(e,n){return d().createElement("div",{style:{textAlign:"center"}},d().createElement("a",{style:{marginRight:"1rem"},onClick:function(){return N(n)}},d().createElement(p.Icon,{type:"edit"})),d().createElement(v.Popconfirm,{title:h("确认删除?"),onConfirm:function(){M(n.id),g().isFunction(null==t?void 0:t.getAction)&&t.getAction(n)}},d().createElement("a",null,d().createElement(p.Icon,{type:"delete"}))))}}]:"lanageManage"==i&&(D=[{title:h("序号"),editable:!0,render:function(e,t,n){return d().createElement("span",null,n+1)}},{title:h("语言"),dataIndex:"changelanguage"},{title:h("显示名称"),dataIndex:"name"},{title:h("默认语言"),dataIndex:"commonlanguage",render:function(e,t){return e?d().createElement(J.CheckCircleTwoTone,null):d().createElement(J.CloseCircleFilled,null)}},{title:h("配置语言"),dataIndex:"contentlanguage",render:function(e,t){return e?d().createElement(J.CheckCircleTwoTone,null):d().createElement(J.CloseCircleFilled,null)}},{title:h("操作"),dataIndex:"operation",render:function(e,n){return d().createElement("div",{style:{textAlign:"center"}},d().createElement("a",{style:{marginRight:"1rem"},onClick:function(){return N(n)}},d().createElement(p.Icon,{type:"edit"})),d().createElement(v.Popconfirm,{title:h("确认删除?"),onConfirm:function(){M(n.id),g().isFunction(null==t?void 0:t.getAction)&&t.getAction(n)}},d().createElement("a",null,d().createElement(p.Icon,{type:"delete"}))))}}]),(0,u.useEffect)((function(){return r(T)}),[T]);var L,M=function(e){return F(T.filter((function(t){return t.id!==e})))},N=function(e){E(!0),O(e),x(e),g().isFunction(null==t?void 0:t.getAction)&&t.getAction(e)};switch(i){case"warningKind":default:L=h("添加报警类型");break;case"warningFilter":L=h("添加报警分组");break;case"logLevel":L=h("添加日志级别");break;case"lanageManage":L=h("添加语言")}return d().createElement("div",null,d().createElement(v.Button,{type:"primary",onClick:function(){E(!0),x(null),O(null),"logLevel"!=i&&"lanageManage"!=i||g().isFunction(null==t?void 0:t.getAction)&&t.getAction({})},style:te(te({},c),{},{marginBottom:10})},L),i&&!o?d().createElement(le,{warnSetting:m,size:"small",type:i,bordered:!0,setDataSources:F,dataSource:T,columns:D,pagination:!1}):null,d().createElement(de,{initData:C,setEditData:O,visible:A,setVisible:E,data:T,addWarningKind:function(t){var n=g().clone(T)||[];k?(n[g().findIndex(n,(function(e){return e.id==k.id}))]=t,F(n)):(n.push(te({id:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},t)),F(n),O(null),o&&(0,e.api)({name:"core/setting"}).fetch("",{method:"PATCH",body:JSON.stringify({warning:te(te({},_),{},{warningkind:n})})}).then((function(e){e.json,v.message.success(h("添加成功")),y.dispatch({type:"@@iot/GET_SETTINGS"})})).catch((function(e){v.message.error(e.message)})))},type:i,schema:null==t?void 0:t.schema}))},fe=function(t){var n=useI18n(),r=n.t,i=(n.i18n,t.option),a=t.fields,o=((0,e.use)("form",(function(e){return{values:e.values}})).values,a.filter((function(e){return"base"==(null==e?void 0:e.schema.driver)}))),l=a.filter((function(e){return"tip"==(null==e?void 0:e.schema.driver)})),c=a.filter((function(e){return"senior"==(null==e?void 0:e.schema.driver)})),s=a.filter((function(e){return!(null!=e&&e.schema.driver||"base"==(null==e?void 0:e.schema.driver)&&"tip"==(null==e?void 0:e.schema.driver)&&"senior"==(null==e?void 0:e.schema.driver))})),u={fontSize:14,fontWeight:"bold",marginBottom:".5rem",textAlign:"center"};return d().createElement(d().Fragment,null,d().createElement(v.Row,null,d().createElement(v.Col,{className:"ant-col-xs-24 ant-col-sm-5",style:u},r("基础配置")),d().createElement(v.Col,null)),o.map((function(e){return(0,m.fieldBuilder)(e,i)})),d().createElement(v.Row,null,d().createElement(v.Col,{className:"ant-col-xs-24 ant-col-sm-5",style:u},r("提醒配置")),d().createElement(v.Col,null)),l.map((function(e){return(0,m.fieldBuilder)(e,i)})),d().createElement(v.Row,null,d().createElement(v.Col,{className:"ant-col-xs-24 ant-col-sm-5",style:u},r("高级配置")),d().createElement(v.Col,null)),c.map((function(e){return(0,m.fieldBuilder)(e,i)})),s.map((function(e){return(0,m.fieldBuilder)(e,i)})))},ge=function(e){var t,n=e.input,r=useI18n(),i=r.t,o=(r.i18n,(t=n.value)?t%3600==0?{num:t/3600,type:"h"}:t%60==0?{num:t/60,type:"m"}:{num:t,type:"s"}:{}),l=a(d().useState(o.num),2),c=l[0],s=l[1],u=a(d().useState(o.type),2),m=u[0],p=u[1],f=[{value:"s",label:i("秒")},{value:"m",label:i("分钟")},{value:"h",label:i("小时")}];return d().useEffect((function(){n.onChange(c*{s:1,m:60,h:3600}[m])}),[c,m]),d().createElement(d().Fragment,null,d().createElement(v.InputNumber,{min:1,max:99999,value:c,onChange:s}),d().createElement(v.Select,{style:{width:100,marginLeft:10},options:f,value:m,onChange:p}))};var ve=["年","月","星期","日","时","分","秒"],he=function(e){var t=e.executionType,n=t.execution,r=void 0===n?{}:n,i=t.specifyConditions,a=void 0===i?{}:i,o=["secondCycle","minuteCycle","hourCycle","dayCycle","weekCycle","monthCycle","yearCycle"],l=[];o.reduce((function(e,t,n){return a[t]?1==n?(l.push(a[e]||r[e]||"*"),l.push(a[t]||r[t]||"*"),t):(l.push(a[t]),t):a[e]&&1==n?(l.push(a[e]||"*"),l.push(a[t]||r[t]||"*"),t):1==n?r[e]||r[t]?(l.push(r[e]||"*"),l.push(r[t]||"*"),t):(l.push("*"),l.push("*"),t):r[o[n-1]]||"yearCycle"==o[n]?(l.push(r[t]||"*"),t):(l.push(r[t]||"*"),"")}));var c=[];return l.map((function(e){return c.unshift(e)})),c.map((function(e,t){var n=_t1(ve[t]);return e.indexOf(",")>-1?e.split(",").join("".concat(n,"、"))+n:e.indexOf("-")>-1?_t1("从")+e+n:e+n==_t1("*星期")?"":"*"==e?_t1("每")+n:n==_t1("星期")?n+e:e+n})).join(" ")};function ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}v.Select.Option,v.Select.OptGroup;var Ae=function(e){var t=e.input,n=(e.label,e.field);return n.name,n.option,d().createElement(v.Checkbox,{value:t.value,checked:t.value,onChange:function(e){t.onChange(e.target.checked)}})},Ee=function(e,t,n){return e?d().createElement(v.Tooltip,{title:"已禁用"},d().createElement("span",{style:{color:Ce}},t||"")):t||""},we={低:"blue",中:"orange",高:"red"},Ce="rgb(170, 167, 167)",xe={key:"rules",itemsRender:p.C.lazy("Form.Items.Card"),cardRender:function(e){var t=e.title,n=e.item,r=e.actions,i=e.error,a=i?d().createElement(v.Tooltip,{title:i},d().createElement(v.Typography.Text,{type:"danger"},Ee(null==n?void 0:n.disable,null==n?void 0:n.warningname))):n.name||t;return d().createElement(v.Card,{title:a,extra:d().createElement(v.Tag,{color:we[n.level]},n.level||"-"),actions:r},d().createElement("div",{style:{overflow:"hidden",wordBreak:"keep-all",whiteSpace:"nowrap",textOverflow:"ellipsis",color:null!=n&&n.disable?Ce:""}},Ee(null==n?void 0:n.disable,null==n?void 0:n.description)||_t1("未填写..")))},searchEnable:!0,searchFields:["warningname","description"],group:p.C.lazy("Form.CollapseGroup")},Be=function(t){var n,r=t.field,i=r.schema,a=r.key,o=r.option.form,l=t.input,c=l.value,s=l.onChange,u=(0,e.use)("settings").settings,m=(null==u||null===(n=u.warning)||void 0===n?void 0:n.warningkind)||[],p=a&&a.split(".")[0];return d().createElement("div",{style:{display:"flex"}},d().createElement(v.Select,{mode:"multiple",value:c||void 0,style:{maxWidth:300},placeholder:_t1(i.title)+"...",onChange:function(e){s(e),p&&(o.change(p+".alert",!0),o.change(p+".handle",!0))},options:null!=m&&m.length?m.map((function(e){return{label:e.name,value:e.id}})):[]}),d().createElement(pe,{input:{onChange:function(){}},type:"warningKind",hiddenTable:!0,style:{marginLeft:"10px"}}))};const ke=function(e,n){var r=e.id,i={name:"warning",title:_r("报警信息"),type:"object",properties:{rules:{title:_r("报警规则"),description:_r("可定义报警逻辑、报警描述、报警类型，上传报警声音等详细信息"),type:"array",field:{validate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[],n=!1,r=(null==e?void 0:e.length)&&e.map((function(e){return-1!=t.indexOf(e.warningname)?(n=!0,_r("报警规则名称不能重复")):(t.push(e.warningname),null)}));return n?r:null}},items:{type:"object",properties:{id:{title:"ID",type:"string",export:!1},warningname:{title:_r("报警规则名称"),type:"string",field:{validate:function(e,t,n){return(t.rules||[]).filter((function(t){return t.warningname==e})).length>1?_r("报警规则名称不能重复"):null}},fieldType:"xi18n_input",driver:"base"},level:{title:_r("报警级别"),type:"string",enum:["低","中","高"],driver:"base"},type:{title:_r("报警类型"),type:"array",items:{},fieldType:"warningType",export:{read:function(e){var n,r=t().context.store.getState().settings,i=(null==r||null===(n=r.warning)||void 0===n?void 0:n.warningkind)||[],a=g().find(i,(function(t){return t.id==e}));return(null==a?void 0:a.name)||e},write:function(e){var n,r=t().context.store.getState().settings,i=(null==r||null===(n=r.warning)||void 0===n?void 0:n.warningkind)||[],a=g().find(i,(function(t){return t.name==e}));return(null==a?void 0:a.id)||e}},field:{component:function(e){return d().createElement(Be,e)}},description:_r("按类型管理报警消息，类型支持用户在【通用配置】中自定义"),driver:"base"},listType:{title:_r("范围限定"),type:"string",description:"",enum:["black","white"],enum_title:[_r("黑名单"),_r("白名单")],enum_type:"tab",field:{effect:function(e,t){var n=e.name,r=e.value,i=(null==n?void 0:n.split(".")[0])||"";setTimeout((function(){"black"==r?(t.setFieldData(i+".blackList",{display:!0}),t.setFieldData(i+".whiteList",{display:!1}),t.change(i+".whiteList",null)):"white"==r?(t.setFieldData(i+".whiteList",{display:!0}),t.setFieldData(i+".blackList",{display:!1}),t.change(i+".blackList",null)):(t.setFieldData(i+".whiteList",{display:!1}),t.setFieldData(i+".blackList",{display:!1}))}))}},driver:"senior"},blackList:{title:_r("黑名单设备"),type:"array",items:{properties:{id:{type:"string"},name:{type:"string"}}},fieldType:"tableData",description:"报警规则针对选定的黑名单设备不生效",field:{table:r,depend:"table",func:"device",mode:"multiple"},driver:"senior"},whiteList:{title:_r("白名单设备"),type:"array",items:{properties:{id:{type:"string"},name:{type:"string"}}},fieldType:"tableData",field:{table:r,depend:"table",func:"device",mode:"multiple"},driver:"senior"},audio:{title:_r("报警声音"),type:"string",description:_r("仅支持MP3、WAV格式"),field:{component:function(e){return d().createElement(h,o({},e,{field:be(be({},e.field),{},{schema:be(be({},e.field.schema),{},{type:"type"})})}))}},driver:"tip"},timesOfPlay:{title:_r("播放次数"),type:"number",minimum:1,description:_r("报警声音播放次数，不填为仅一次"),driver:"tip"},alert:{title:_r("报警提醒"),type:"boolean",description:_r("开启后报警声音提醒及报警数据量的更新"),driver:"tip"},handle:s({title:_r("报警处理"),type:"boolean",field:{component:Ae},description:_r("开启后可对报警信息进行报警确认及报警处理的操作"),driver:"tip"},"field",{effect:function(e,t){var n=e.name,r=e.value,i=(null==n?void 0:n.split(".")[0])||"";setTimeout((function(){r?t.setFieldData(i+".timeoutSetting",{display:!0}):(t.setFieldData(i+".timeoutSetting",{display:!1}),t.change(i+".timeoutSetting",null))}))}}),description:{title:_r("报警描述"),type:"string",description:_r("若需要展示设备名称，请输入{{tableDataName}}"),field:{descriptionType:"bottom"},fieldType:"xi18n_input",driver:"base"},interval:{title:_r("报警间隔(s)"),type:"number",minimum:1,description:_r("在定义的时间范围内，对同一设备同一条报警规则产生的报警进行合并，只展示一条报警消息"),driver:"senior"},triggerLimit:{title:_r("报警次数"),type:"number",minimum:1,driver:"senior",description:_r("配置报警次数后，触发报警条件产生的报警提示信息达到设定次数，将不会信的产生报警消息，当报警恢复后，重新计算次数")},deadZone:{title:_r("报警死区"),type:"number",minimum:1,description:_r("定义报警恢复数值与报警数值之间的波动范围"),driver:"senior"},disable:{title:_r("禁用"),type:"boolean",description:_t1("禁用后当前报警规则不生效"),driver:"senior"},extraTags:{type:"array",title:_r("关注数据"),description:_r("用于保存除报警规则数据点外，报警产生时其他数据点的实时值"),items:{title:_r("节点"),type:"object",properties:{id:{type:"string",title:_r("数据点"),fieldType:"tags-select",field:{tableId:r,tableDataId:null==n?void 0:n.id}}}},driver:"senior"},delayFull:{type:"number",title:_r("报警触发周期"),field:{component:ge},description:"周期内，每一次的报警满足报警条件，经过周期后的第一次上数仍然触发报警，才产生报警信息",driver:"senior"},delay:{title:_r("延时提醒时长(s)"),minimum:1,description:_r("若设置延时提醒时长，产生报警，经过设定时长后进行第一次报警提醒"),field:{extendFlow:{show:!0,limit:["number"],mode:"single"},component:N},driver:"senior"},logic:{title:_r("报警逻辑"),type:"object",fieldType:"model-logic",properties:{},field:{tableDataId:(null==n?void 0:n.id)||null,tableId:(null==n?void 0:n._table)||null,validate:function(e){},effect:function(e,t){var n,r=e.name,i=e.value;i=null!==(n=i)&&void 0!==n&&n.type?i.logic:i;var a=(null==r?void 0:r.split(".")[0])||"";setTimeout((function(){var e=E(i,[]),n=null!=e&&e.length?e.filter((function(e){return e.indexOf("var.")>-1})):[],r=null!=n&&n.length?n.map((function(e){return e.substr(e.indexOf(".")+1)})):void 0;null!=r&&r.length?t.setFieldData(a+".fieldName",{display:!0}):(t.setFieldData(a+".fieldName",{display:!1}),t.change(a+".fieldName",null))}))}},driver:"base"},fieldName:{title:_r("报警数值数据"),type:"array",items:{},description:_r("自定义报警中报警数值列显示的数据点，默认显示报警逻辑中的所有数据点"),field:{table:r,func:"device"},driver:"base"},timeoutSetting:{title:_r("超时处理"),type:"object",properties:{},field:{component:function(e){var t=useI18n(),n=t.t;return t.i18n,d().createElement(p.C,o({is:"UserOverTime"},e,{initValue:!1,customOption:[{key:n("天"),value:"d"},{key:n("小时"),value:"h"},{key:n("分"),value:"m"}]}))}},description:"产生的报警信息超过设定时间后，默认为已处理状态",driver:"senior"},executionSetting:{title:_r("报警有效期"),type:"object",properties:{},field:{component:function(e){var t,n=useI18n(),r=n.t,i=(n.i18n,e.input),l=a(d().useState((null==i||null===(t=i.value)||void 0===t?void 0:t.executionType)||{}),2),c=l[0],s=l[1];return d().createElement(v.Card,null,d().createElement("div",{style:{padding:"1rem 0"}},d().createElement(v.Checkbox,{onChange:function(e){i.onChange(be(be({},i.value),{},{disable:!e.target.checked}))},checked:!(null!=i&&i.value.disable)},r("启用"))),d().createElement("div",{style:null!=i&&i.value.disable?{display:"none"}:{}},d().createElement(p.C,o({is:"ExecutionType"},e,{input:{onChange:function(e){!function(e){var t=function(e){var t=e.executionType,n=t.execution,r=void 0===n?{}:n,i=t.specifyConditions,a=void 0===i?{}:i,o=(e.planSetting,["secondCycle","minuteCycle","hourCycle","dayCycle","monthCycle","weekCycle","yearCycle"]),l=[];return a&&o.reduce((function(e,t,n){return a&&a[t]?1==n?(l.push(a[e]||r[e]||"*"),l.push(a[t]||r[t]||"*"),t):(l.push(a[t]),t):a&&a[e]&&1==n?(l.push(a[e]||"*"),l.push(a[t]||r[t]||"*"),t):1==n?r[e]||r[t]?(l.push(r[e]||"*"),l.push(r[t]||"*"),t):(l.push("*"),l.push("*"),t):r[o[n-1]]||"yearCycle"==o[n]?(l.push(r[t]||"*"),t):(l.push(r[t]||"*"),"")})),_.isEmpty(l)||(e.cronExpression=l.reduce((function(e,t,n){return 5==n&&"*"!=l[n-2]||5==n&&"*"==t?e+" ?":e+" "+t}))),_.isEmpty(r)&&_.isEmpty(a)&&(e.cronExpression="* * * * * ? *"),e}({executionType:e});s(null==t?void 0:t.executionType),i.onChange(be(be({},null==i?void 0:i.value),t))}(e)},value:c}})),d().createElement("div",{style:{marginTop:"1rem"}},he({executionType:c}))))}},driver:"senior",description:_r("配置有效期后，只会在有效期间产生报警信息")},delayTriggerLimit:{title:_r("报警计次"),type:"number",minimum:1,driver:"senior"}},form:["warningname","level","type","description",{key:"logic",resultType:"boolean"},{key:"fieldName",component:function(e){return d().createElement(w,o({},e,{field:be(be({},e.field),{},{func:"device",schema:be(be({},e.field.schema),{},{logic:"logic",device:"device"})})}))}},"listType","blackList","whiteList","audio","timesOfPlay","alert","handle","extraTags","delayFull","delay","delayTriggerLimit","interval","deadZone","timeoutSetting","triggerLimit","executionSetting","disable"],required:["level","type","logic","description","warningname"],formRender:function(e,t){return d().createElement(fe,{fields:e,option:t})}}}},listFields:r?[]:["restrainWarning"],form:r?[xe]:["restrainWarning",xe],formEffect:function(e){e.useField("rules",(function(t){var n=t.value;if(n&&n.length>0){var r=!1,i=n.map((function(e){return g().isEmpty(e)||e.id?e:(r=!0,be({id:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},e))}));r&&e.change("rules",i)}}))}};return r||(i.properties=be({restrainWarning:{type:"boolean",title:_r("抑制报警"),description:_r("对设备的所有报警规则进行抑制，报警规则抑制后，设备不会产生报警")}},i.properties)),i},Oe={name:"airiot.plugin.warning",plugins:{name:_r("报警设置"),key:"warning",pluginGroup:_r("通用表功能"),description:{content:_r("【报警设置】表功能应用后，可实现复杂报警规则的定义。如当数据点的数据值超过某个范围或者设备掉线，需要产生报警时，可应用此功能。应用后，表的TAB会相应的增加一个"),config:[{name:_r("报警规则"),info:_r("可定义报警逻辑、报警描述、报警类型，上传报警声音等详细信息")}]},useSetting:function(e){var t=e.data;return{schema:ke(t)}},useRecordSetting:function(e){e.table,e.setting;var t=e.record,n=e.data;return e.saveSetting,{schema:ke(n,t)}}}},Se=Recoil;var _e=function(t){var n=useI18n(),r=n.t,i=(n.i18n,(0,e.use)("warning.data"),a((0,e.use)("warning.typeCount"),2)),o=i[0],l=(i[1],a((0,e.use)("warning.count"),2)),c=l[0],s=(l[1],a((0,e.use)("warning.processedCount"),2)),u=s[0],m=(s[1],t.isAlarm),f=t.noAlarm,g=t.warnTypeNum,h=t.offsetX,y=void 0===h?-20:h,b=t.offsetY,A=void 0===b?-20:b,E=t.width,w=void 0===E?50:E,C=t.height,x=void 0===C?50:C,B=t.badgeX,k=void 0===B?-10:B,O=t.badgeY,S=void 0===O?0:O,_=d().createElement(d().Fragment,null,d().createElement("div",null,r("需处理报警条数"),":",d().createElement("span",{style:{color:"red"}},u)),d().createElement("div",null,r("报警信息总条数"),":",d().createElement("span",{style:{color:"red"}},c)),d().createElement("div",null,r("不同设备/报警规则报警条数"),":",d().createElement("span",{style:{color:"red"}},o))),j=o>0?m:f,P={color:o>0?"red":"#fff",fontSize:w-20,marginTop:A,marginLeft:y,width:w+"px",height:x+"px"},D={marginTop:A,marginLeft:y,width:w+"px",height:x+"px"},I=d().createElement(p.Icon,{type:"bell",style:P});(m||f)&&(I=d().createElement("img",{style:D,src:j})),o<=0&&!f&&(I=d().createElement(p.Icon,{type:"bell",style:P}));var T=o;return g&&("processed"==g&&(T=u),"all"==g&&(T=c)),d().createElement(v.Popover,{placement:"bottom",content:_},d().createElement("div",{style:{height:48}},d().createElement(v.Badge,{size:"small",count:T,offset:[k,S]},I)))};const je=function(t){return(0,e.use)("navigate"),d().createElement("div",{style:{width:50,textAlign:"center"}},d().createElement("a",{onClick:function(){null!=t&&t.editMode||e.app.go("/app/model/Warning/list")},style:{display:"block",height:55}},d().createElement(_e,t)))},Pe=function(t){var n=(0,e.use)("ws"),r=n.onData,i=n.subscribe,o=a((0,e.use)("warning.add"),2),l=(o[0],o[1]);return d().useEffect((function(){return i("warning",{})}),[]),r((function(e){!e||!g().isPlainObject(e)||null!=e&&e.recoveryTime||l(e)})),null};var De=0;const Ie=function(t){var n,r,i,o=useI18n(),l=o.t,c=(o.i18n,window.localStorage),s=(0,e.use)("settings").settings,m=a((0,u.useState)(!1),2),f=m[0],h=m[1],y=null==s||null===(n=s.warning)||void 0===n?void 0:n.audio,b=null==s||null===(r=s.warning)||void 0===r?void 0:r.warningkind,A=(0,e.use)("warning.data"),E=a((0,e.use)("warning.unread"),2),w=E[0],C=E[1],x=(null==w?void 0:w.length)||0;d().useEffect((function(){switch(null==A?void 0:A.state){case"hasValue":return void C(A.contents.items);case"loading":return;case"hasError":throw l("出错了")}}),[A]);var B=(0,u.useRef)(null),k=B.current,O=w,S=a(d().useState(!1),2),_=S[0],j=S[1];(0,u.useEffect)((function(){var e=c.getItem("muted");e&&"false"==e&&h(!1),e&&"true"==e&&h(!0)}),[]),!f&&P&&k.play(),d().useEffect((function(){if(k&&O.length>0&&!1===_){var e=O.slice(De,De+1)[0];if(j(!0),e){if(null!=e&&e.level&&(null==e||!e.audio)){var t,n={低:"low_audio",中:"middle_audio",高:"tall_audio"}[null==e?void 0:e.level];e.audio=(null==s||null===(t=s.warning)||void 0===t?void 0:t[n])||y,e.timesOfPlay=1}(function(e,t,n,r){var i,a,o=t||1;if(g().isString(r)){var l,c=null!=b&&b.length?b.filter((function(e){return(null==e?void 0:e.id)==r})):[];i=null!=c&&c.length?null===(l=c[0])||void 0===l?void 0:l.audio:""}else if(g().isArray(r)&&null!=r&&r.length){var s=null!=b&&b.length?b.filter((function(e){return r.some((function(t){return t===e.id}))})).filter((function(e){return e.audio})):[];i=null!=s&&s.length?s[0].audio:""}g().isString(n)?a=n:g().isObject(n)&&(null!=n&&n.url?a.audio:null!=n&&n.select&&(a=null==n?void 0:n.select));var u=a||i||y;return new Promise((function(t,n){var r=0;e.src=u,e.autoplay=!0,e.addEventListener("ended",(function(){if(++r!=o&&e.play().catch((function(){})),r==o)return e.pause(),t(!0)}))}))})(k,null==e?void 0:e.timesOfPlay,null==e?void 0:e.audio,null==e?void 0:e.type).then((function(e){e&&(De+=1,j(!1))})).catch((function(e){j(!1)}))}else j(!1)}}),[null==O?void 0:O.length,JSON.stringify(O),_]),d().useEffect((function(){O&&null!=O&&O.length&&k&&k.play()}),[null==O?void 0:O.length]);var P=x>0,D=d().createElement("div",{style:{width:100,height:25,display:"flex",alignItems:"center"}},d().createElement(p.Icon,{type:"sound",style:{fontSize:20,marginRight:10}}),d().createElement(v.Switch,{checkedChildren:l("开"),unCheckedChildren:l("关"),size:"small",checked:!f,onClick:function(e){c.setItem("muted",!f),h(!f),e&&k.play()}}));return null!=s&&null!==(i=s.warning)&&void 0!==i&&i.alarm_sound?d().createElement("div",{style:{position:"fixed",right:0,display:"flex",alignItems:"center",textAlign:"left",width:25,color:"#fff",paddingLeft:9,background:"lightcoral",height:50,lineHeight:50,top:80,borderRadius:"25px 0 0 25px",zIndex:999,overflow:"hidden"}},!1===(null==t?void 0:t.editMode)&&d().createElement(Pe,null),d().createElement(v.Popover,{title:l("报警声音开关"),placement:"left",content:D,trigger:"click"},d().createElement(p.Icon,{type:"setting"})),d().createElement("audio",{id:"audio",ref:B,muted:f})):null},Te=xadminModel,Fe=moment;var Le=n.n(Fe);function Me(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Y(e,t)}function Ne(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}const Re=ReactDOM;var We=n.n(Re);const ze=d().createContext(null);var qe=function(e){return e.scrollTop},Ve="unmounted",Ue="exited",Ye="entering",He="entered",Ke="exiting",$e=function(e){function t(t,n){var r;r=e.call(this,t,n)||this;var i,a=n&&!n.isMounting?t.enter:t.appear;return r.appearStatus=null,t.in?a?(i=Ue,r.appearStatus=Ye):i=He:i=t.unmountOnExit||t.mountOnEnter?Ve:Ue,r.state={status:i},r.nextCallback=null,r}Me(t,e),t.getDerivedStateFromProps=function(e,t){return e.in&&t.status===Ve?{status:Ue}:null};var n=t.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==Ye&&n!==He&&(t=Ye):n!==Ye&&n!==He||(t=Ke)}this.updateStatus(!1,t)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var e,t,n,r=this.props.timeout;return e=t=n=r,null!=r&&"number"!=typeof r&&(e=r.exit,t=r.enter,n=void 0!==r.appear?r.appear:t),{exit:e,enter:t,appear:n}},n.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===Ye){if(this.props.unmountOnExit||this.props.mountOnEnter){var n=this.props.nodeRef?this.props.nodeRef.current:We().findDOMNode(this);n&&qe(n)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Ue&&this.setState({status:Ve})},n.performEnter=function(e){var t=this,n=this.props.enter,r=this.context?this.context.isMounting:e,i=this.props.nodeRef?[r]:[We().findDOMNode(this),r],a=i[0],o=i[1],l=this.getTimeouts(),c=r?l.appear:l.enter;e||n?(this.props.onEnter(a,o),this.safeSetState({status:Ye},(function(){t.props.onEntering(a,o),t.onTransitionEnd(c,(function(){t.safeSetState({status:He},(function(){t.props.onEntered(a,o)}))}))}))):this.safeSetState({status:He},(function(){t.props.onEntered(a)}))},n.performExit=function(){var e=this,t=this.props.exit,n=this.getTimeouts(),r=this.props.nodeRef?void 0:We().findDOMNode(this);t?(this.props.onExit(r),this.safeSetState({status:Ke},(function(){e.props.onExiting(r),e.onTransitionEnd(n.exit,(function(){e.safeSetState({status:Ue},(function(){e.props.onExited(r)}))}))}))):this.safeSetState({status:Ue},(function(){e.props.onExited(r)}))},n.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},n.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(r){n&&(n=!1,t.nextCallback=null,e(r))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},n.onTransitionEnd=function(e,t){this.setNextCallback(t);var n=this.props.nodeRef?this.props.nodeRef.current:We().findDOMNode(this),r=null==e&&!this.props.addEndListener;if(n&&!r){if(this.props.addEndListener){var i=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback],a=i[0],o=i[1];this.props.addEndListener(a,o)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},n.render=function(){var e=this.state.status;if(e===Ve)return null;var t=this.props,n=t.children,r=(t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef,C(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return d().createElement(ze.Provider,{value:null},"function"==typeof n?n(e,r):d().cloneElement(d().Children.only(n),r))},t}(d().Component);function Ze(){}$e.contextType=ze,$e.propTypes={},$e.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Ze,onEntering:Ze,onEntered:Ze,onExit:Ze,onExiting:Ze,onExited:Ze},$e.UNMOUNTED=Ve,$e.EXITED=Ue,$e.ENTERING=Ye,$e.ENTERED=He,$e.EXITING=Ke;const Ge=$e;var Je=function(e,t){return e&&t&&t.split(" ").forEach((function(t){return r=t,void((n=e).classList?n.classList.remove(r):"string"==typeof n.className?n.className=Ne(n.className,r):n.setAttribute("class",Ne(n.className&&n.className.baseVal||"",r)));var n,r}))},Xe=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))||this).appliedClasses={appear:{},enter:{},exit:{}},t.onEnter=function(e,n){var r=t.resolveArguments(e,n),i=r[0],a=r[1];t.removeClasses(i,"exit"),t.addClass(i,a?"appear":"enter","base"),t.props.onEnter&&t.props.onEnter(e,n)},t.onEntering=function(e,n){var r=t.resolveArguments(e,n),i=r[0],a=r[1]?"appear":"enter";t.addClass(i,a,"active"),t.props.onEntering&&t.props.onEntering(e,n)},t.onEntered=function(e,n){var r=t.resolveArguments(e,n),i=r[0],a=r[1]?"appear":"enter";t.removeClasses(i,a),t.addClass(i,a,"done"),t.props.onEntered&&t.props.onEntered(e,n)},t.onExit=function(e){var n=t.resolveArguments(e)[0];t.removeClasses(n,"appear"),t.removeClasses(n,"enter"),t.addClass(n,"exit","base"),t.props.onExit&&t.props.onExit(e)},t.onExiting=function(e){var n=t.resolveArguments(e)[0];t.addClass(n,"exit","active"),t.props.onExiting&&t.props.onExiting(e)},t.onExited=function(e){var n=t.resolveArguments(e)[0];t.removeClasses(n,"exit"),t.addClass(n,"exit","done"),t.props.onExited&&t.props.onExited(e)},t.resolveArguments=function(e,n){return t.props.nodeRef?[t.props.nodeRef.current,e]:[e,n]},t.getClassNames=function(e){var n=t.props.classNames,r="string"==typeof n,i=r?(r&&n?n+"-":"")+e:n[e];return{baseClassName:i,activeClassName:r?i+"-active":n[e+"Active"],doneClassName:r?i+"-done":n[e+"Done"]}},t}Me(t,e);var n=t.prototype;return n.addClass=function(e,t,n){var r=this.getClassNames(t)[n+"ClassName"],i=this.getClassNames("enter").doneClassName;"appear"===t&&"done"===n&&i&&(r+=" "+i),"active"===n&&e&&qe(e),r&&(this.appliedClasses[t][n]=r,function(e,t){e&&t&&t.split(" ").forEach((function(t){return r=t,void((n=e).classList?n.classList.add(r):function(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")}(n,r)||("string"==typeof n.className?n.className=n.className+" "+r:n.setAttribute("class",(n.className&&n.className.baseVal||"")+" "+r)));var n,r}))}(e,r))},n.removeClasses=function(e,t){var n=this.appliedClasses[t],r=n.base,i=n.active,a=n.done;this.appliedClasses[t]={},r&&Je(e,r),i&&Je(e,i),a&&Je(e,a)},n.render=function(){var e=this.props,t=(e.classNames,C(e,["classNames"]));return d().createElement(Ge,o({},t,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},t}(d().Component);Xe.defaultProps={classNames:""},Xe.propTypes={};const Qe=Xe;function et(e,t){var n=Object.create(null);return e&&u.Children.map(e,(function(e){return e})).forEach((function(e){n[e.key]=function(e){return t&&(0,u.isValidElement)(e)?t(e):e}(e)})),n}function tt(e,t,n){return null!=n[t]?n[t]:e.props[t]}function nt(e,t){return et(e.children,(function(n){return(0,u.cloneElement)(n,{onExited:t.bind(null,n),in:!0,appear:tt(n,"appear",e),enter:tt(n,"enter",e),exit:tt(n,"exit",e)})}))}function rt(e,t,n){var r=et(e.children),i=function(e,t){function n(n){return n in t?t[n]:e[n]}e=e||{},t=t||{};var r,i=Object.create(null),a=[];for(var o in e)o in t?a.length&&(i[o]=a,a=[]):a.push(o);var l={};for(var c in t){if(i[c])for(r=0;r<i[c].length;r++){var s=i[c][r];l[i[c][r]]=n(s)}l[c]=n(c)}for(r=0;r<a.length;r++)l[a[r]]=n(a[r]);return l}(t,r);return Object.keys(i).forEach((function(a){var o=i[a];if((0,u.isValidElement)(o)){var l=a in t,c=a in r,s=t[a],d=(0,u.isValidElement)(s)&&!s.props.in;!c||l&&!d?c||!l||d?c&&l&&(0,u.isValidElement)(s)&&(i[a]=(0,u.cloneElement)(o,{onExited:n.bind(null,o),in:s.props.in,exit:tt(o,"exit",e),enter:tt(o,"enter",e)})):i[a]=(0,u.cloneElement)(o,{in:!1}):i[a]=(0,u.cloneElement)(o,{onExited:n.bind(null,o),in:!0,exit:tt(o,"exit",e),enter:tt(o,"enter",e)})}})),i}var it=Object.values||function(e){return Object.keys(e).map((function(t){return e[t]}))},at=function(e){function t(t,n){var r,i=(r=e.call(this,t,n)||this).handleExited.bind(z(r));return r.state={contextValue:{isMounting:!0},handleExited:i,firstRender:!0},r}Me(t,e);var n=t.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(e,t){var n=t.children,r=t.handleExited;return{children:t.firstRender?nt(e,r):rt(e,n,r),firstRender:!1}},n.handleExited=function(e,t){var n=et(this.props.children);e.key in n||(e.props.onExited&&e.props.onExited(t),this.mounted&&this.setState((function(t){var n=o({},t.children);return delete n[e.key],{children:n}})))},n.render=function(){var e=this.props,t=e.component,n=e.childFactory,r=C(e,["component","childFactory"]),i=this.state.contextValue,a=it(this.state.children).map(n);return delete r.appear,delete r.enter,delete r.exit,null===t?d().createElement(ze.Provider,{value:i},a):d().createElement(ze.Provider,{value:i},d().createElement(t,r,a))},t}(d().Component);at.propTypes={},at.defaultProps={component:"div",childFactory:function(e){return e}};const ot=at;function lt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ct(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lt(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const st=function(t){var n=(0,e.use)("data.context"),r=useI18n(),i=r.t,a=(r.i18n,t.item),o=t.value,l=t.wrap,c=t.callback,s=null==a?void 0:a.tableData,u=(null==a||a.table,null==a?void 0:a.time),m=null==a?void 0:a.fields,p=o?o.map((function(e){var t=function(e,t){return g().isBoolean(e)?e?1:0:g().isNumber(e)?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return g().isNumber(e)?Math.round(e*Math.pow(10,t))/Math.pow(10,t):e}(e,void 0!==t?t:3):e?e.toString():"-"}(e.value,null==e?void 0:e.fixed)+"".concat((null==e?void 0:e.unit)||"");return null!=e&&e.name&&null!=(null==e?void 0:e.value)?d().createElement("span",{style:{marginRight:5,cursor:"pointer"},onClick:function(){}},e.name,":",t):""})).filter(Boolean):"";return p?d().createElement(l,null,d().createElement("span",{onClick:function(){var e=null==m?void 0:m[0];if(e)if(g().isFunction(c)&&c(),n&&!g().isEmpty(n)){var t,r=n.setParams,o=n.showModal;r({timeRange:{type:"between",range:{gte:moment(u).subtract(15,"minutes"),lte:moment(u).add(15,"minutes")}},tags:[{data:{name:"".concat(s.name||(null==s?void 0:s.id),".").concat(e.name),value:"".concat(s.id,".").concat(e.id),origin:ct(ct({},e),{},{node:s,table:null==a||null===(t=a.table)||void 0===t?void 0:t.id,tableData:s})},tableData:s,fixed:3}]}),o(!0)}else v.message.error(i("未加载数据分析模块"))}},p)):""};var ut=["item","callback"];v.Typography.Text,v.Typography.Link;const dt=function(t){var n,r,i,o,l=t.item,c=t.callback,s=x(t,ut),u=a(d().useState(null==l?void 0:l.status),2),m=u[0],f=u[1],g=useI18n(),h=g.t;g.i18n;try{var y;null===(y=(0,e.use)("model.getItems"))||void 0===y||y.getItems}catch(e){}var b,A=(0,e.use)("warnings.confirm").confirm,E=(0,e.use)("warning.tabBadge"),w=l&&l.department&&l.department,C=w&&w.map((function(e){return e.name})).toString(),B=(0,e.use)("settings").settings,k=(null==B||null===(n=B.warning)||void 0===n?void 0:n.warningkind)||[];if(l){if(_.isString(l.type)){var O=k.filter((function(e){return e.id==e.type}))||[],S=O&&O.length>0?O[0].name:l.type;b=S&&S.indexOf("-")>0?"":S||""}else if(_.isArray(l.type)&&_.isArray(k)){var j=k.filter((function(e){return l.type.some((function(t){return t===e.id}))}));b=null!=j&&j.length?j.map((function(e){return null==e?void 0:e.name})).join(","):""}}else b="";return d().useEffect((function(){f(null==l?void 0:l.status)}),[null==l?void 0:l.status]),l&&l.tableData?d().createElement("div",s,d().createElement("div",{className:"warning-info"},d().createElement("div",null,d().createElement("b",null,h("报警时间")),": ",null!=l&&l.time?Le()(l.time).format("YYYY-MM-DD HH:mm:ss"):""),d().createElement("div",null,d().createElement("b",null,h("报警部门")),": ",C),d().createElement("div",null,d().createElement("b",null,h("报警设备")),": ",(null==l||null===(r=l.tableData)||void 0===r?void 0:r.name)||(null==l||null===(i=l.tableData)||void 0===i?void 0:i.title)||(null==l||null===(o=l.tableData)||void 0===o?void 0:o.id)),d().createElement("div",null,d().createElement("b",null,h("报警级别")),": ",l.level),d().createElement("div",null,d().createElement("b",null,h("报警类型")),": ",b||""),l.confirmUser?d().createElement("div",null,d().createElement("b",null,h("处理人")),": ",d().createElement(p.Icon,{name:"user"})," ",l.confirmUser.name):null,l.confirmTime?d().createElement("div",null,d().createElement("b",null,h("处理时间")),": ",Le()(l.confirmTime).format("YYYY-MM-DD hh:mm:ss")):null,l.fields?d().createElement(st,{item:l,value:l.fields,callback:c,wrap:function(e){var t=e.children;return d().createElement("div",{className:"warning-fields"},d().createElement("b",null,h("报警数据")),": ",t)}}):null,d().createElement("div",{style:{textAlign:"center"}},"未确认"!=m&&m?d().createElement(v.Button,{disabled:!0},h("报警已确认")):d().createElement(v.Button,{onClick:function(){A().then((function(e){e&&(f("已确认"),v.message.success("报警信息已确认"),"已处理"==l.processed&&E&&E())}))}},h("确认报警"))))):null};var mt=["children"];function pt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=$(e);if(t){var i=$(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return K(this,n)}}var ft=function(e){H(n,e);var t=pt(n);function n(){return q(this,n),t.apply(this,arguments)}return U(n,[{key:"componentDidMount",value:function(){var e=this;this.timer=setInterval((function(){return e.forceUpdate()}),6e4)}},{key:"componentWillUnmount",value:function(){this.timer&&clearInterval(this.timer)}},{key:"render",value:function(){return d().createElement("span",null,Le()(this.props.time).fromNow())}}]),n}(d().Component),gt=function(e){var t=e.children,n=x(e,mt);return d().createElement(Qe,o({},n,{timeout:1e3,classNames:"warning"}),t)},vt={未确认:"unconfirm",已确认:"confirmed"},ht=function(t){var n,r=t.items,i=(0,e.use)("settings").settings,a=null==i||null===(n=i.warning)||void 0===n?void 0:n.barlistFilter;return r.filter((function(e){return!(e.recoveryTime||null!=a&&a.status&&"已确认"==e.status||null!=a&&a.processed&&"已处理"==e.processed)})).map((function(e){return d().createElement(gt,{key:e.id},d().createElement(yt,{id:e.id,item:e}))}))},yt=function(e){H(n,e);var t=pt(n);function n(){return q(this,n),t.apply(this,arguments)}return U(n,[{key:"render",value:function(){var e=this.props,t=e.item,n=(e.id,t&&t.department&&t.department),r=t&&t.tableData||null,i=n&&n.map((function(e){return e.name})).toString(),a=(null==vt?void 0:vt[null==t?void 0:t.status])||"",o={低:"info",中:"warning",高:"danger"}[(null==t?void 0:t.level)||"中"];return d().createElement(v.Card,null,d().createElement(v.Popover,{trigger:"click",placement:"top",content:d().createElement(dt,{item:t})},d().createElement("div",{className:"content ".concat(a," ").concat(o)},d().createElement("div",{className:"time"},d().createElement(ft,{time:null==t?void 0:t.time})),d().createElement("div",{className:"department"},i),d().createElement("div",{className:"node"},d().createElement("a",null,r&&r.name)),d().createElement("div",{className:"desc"},null==t?void 0:t.desc))))}}]),n}(d().Component);const bt=function(t){var n=a(d().useState({left:0}),2),r=n[0],i=n[1],o=(0,e.use)("model.list"),l=o.loading,c=o.items,s=(o.fields,d().useRef()),u=function(e){return function(){var t=s.current,n=t.querySelectorAll(".warning-bar-list")[0];i({left:Math.max(t.clientWidth-n.clientWidth-100,Math.min(0,r.left+512*e))})}},m=-100,f=s.current;if(f){var g=f.querySelectorAll(".warning-bar-list")[0];m=f.clientWidth-g.clientWidth-100}return l?d().createElement("div",{className:"text-center",style:{padding:10}},d().createElement(p.Icon,{name:"spinner fa-spin fa-4x"})):d().createElement("div",{className:"warning-bar-an",style:{display:"flex",flexDirection:"row",height:"120px",alignItems:"center"}},d().createElement("div",{className:"arr-icon"+(r.left>=0?" disable":""),onClick:u(1)},d().createElement(p.Icon,{name:"left"})),d().createElement("div",{className:"warning-bar-list-container",ref:s},d().createElement(ot,{className:"warning-bar-list",style:{left:r.left}},d().createElement(ht,{items:c}))),d().createElement("div",{className:"arr-icon"+(r.left<=m?" disable":""),onClick:u(-1)},d().createElement(p.Icon,{name:"right"})))},At=function(t){var n=a((0,e.use)("warnings.confirmall"),2),r=(n[0],n[1]),i=useI18n(),o=i.t;return i.i18n,d().createElement(v.Popconfirm,{title:o("您确定要将全部报警信息确认？"),onConfirm:function(){r({})},okText:o("确认全部报警信息"),cancelText:o("取消")},d().createElement(v.Button,{type:"danger",block:!0},o("全部确认")))},Et=function(t){var n=a((0,e.use)("warning.processed.all"),2),r=(n[0],n[1]),i=useI18n(),o=i.t;return i.i18n,confirm=function(){r({type:"processed"})},d().createElement(v.Popconfirm,{title:o("您确定要将全部报警信息处理？"),onConfirm:confirm,okText:o("处理全部报警信息"),cancelText:o("取消")},d().createElement(v.Button,{type:"danger",block:!0},o("全部处理")))},wt=xadminAuth,Ct=function(t){var n,r=a(d().useState(!1),2),i=r[0],o=r[1],l=(0,e.use)("settings").settings;return null!=l&&null!==(n=l.warning)&&void 0!==n&&n.alarm_card?d().createElement(Te.Model,{name:"Warning",modelKey:"warning_bar"},d().createElement(v.Row,{className:"warning_bar",style:{position:"fixed",zIndex:10}},i?[d().createElement(v.Col,{span:22},d().createElement(bt,null)),d().createElement(v.Col,{span:2},d().createElement(wt.HasPermission,{FailureComponent:null,permission:"warning.edit"},d().createElement(At,null),d().createElement(Et,null)),d().createElement(v.Button,{block:!0,onClick:function(){return e.app.go("/app/model/Warning/list")}},"查看全部"))]:null,d().createElement("div",{className:"arr-btn",onClick:function(){return o(!i)}},i?d().createElement(p.Icon,{name:"down"}):d().createElement(p.Icon,{name:"up"})))):null};function xt(e,t,n,r,i,a,o){try{var l=e[a](o),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,i)}function Bt(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){xt(a,r,i,o,l,"next",e)}function l(e){xt(a,r,i,o,l,"throw",e)}o(void 0)}))}}var kt=n(687),Ot=n.n(kt);function St(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _t(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?St(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):St(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var jt=function(t){var n=(0,e.use)("redux").dispatch,r=t.item,i=r.tableData,a=(r.model,r.time),o=t.value,l=o?o.map((function(e){var t=function(e,t){return g().isBoolean(e)?e?1:0:g().isNumber(e)?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return g().isNumber(e)?Math.round(e*Math.pow(10,t))/Math.pow(10,t):e}(e,t&&void 0!==t.fixed?t.fixed:3):e?e.toString():"-"}(e.value);return e.name&&null!=e.value?d().createElement("span",{style:{marginRight:5,cursor:"pointer"},onClick:function(){i&&function(e){var t=e.tableData;t&&n({type:"@@iot/CHANGE_DATA_MODAL",payload:{time:e.time,tableData:t,tag:e.tag,show:!0}})}({time:a,tableData:i,tag:e})}},e.name,":",t):""})).filter(Boolean):"";return l||""},Pt=function(t){var n,r,i=useI18n(),o=i.t,l=(i.i18n,(0,e.use)("warning.tabBadge")),c=function(){return null};try{var s;c=null===(s=(0,e.use)("model.getItems"))||void 0===s?void 0:s.getItems}catch(e){}var u=(0,e.use)("warnings.confirm"),m=u.confirm,p=u.onProcessed,f=a(d().useState(t.item),2),g=f[0],h=f[1],y=(0,e.use)("settings").settings,b=null==y?void 0:y.settings;return d().createElement(d().Fragment,null,null!=b&&null!==(n=b.alarmModal)&&void 0!==n&&n.show_confirm?"未确认"!=g.status&&g.status?d().createElement(v.Button,{size:"small",style:{marginLeft:".2rem"},disabled:!0},o("报警已确认")):d().createElement(v.Button,{size:"small",type:"primary",onClick:function(){m(g).then((function(e){var n;e&&(c(),v.message.success("报警信息已确认"),"已处理"==(null==t||null===(n=t.item)||void 0===n?void 0:n.processed)&&l&&l(),h(_t(_t({},g),{},{status:"已确认"})))}))},style:{marginLeft:".2rem"}},"确认报警"):null,null!=b&&null!==(r=b.alarmModal)&&void 0!==r&&r.show_handle?null==g.processed||"未处理"==g.processed?d().createElement(v.Button,{size:"small",type:"primary",onClick:function(){p(g).then((function(e){var n;e&&(c(),v.message.success("成功处理报警信息"),"已确认"==(null==t||null===(n=t.item)||void 0===n?void 0:n.status)&&l&&l(),h(_t(_t({},g),{},{processed:"已处理"})))}))},style:{marginLeft:".2rem"}},o("处理报警")):d().createElement(v.Button,{style:{marginLeft:".2rem"},size:"small",disabled:!0},o("报警已处理")):null)},Dt=function(t){var n=t.itemTime,r=t.description,i=(0,e.use)("time").time;return d().createElement("span",{style:{marginRight:".5rem"}},Le()(n).from(i),r)},It=function(t){var n,r,i,a=t.item,o=null==a||null===(n=a.node)||void 0===n||null===(r=n.hkvideo)||void 0===r?void 0:r.point,l=(0,e.use)("settings").settings,c=null==l?void 0:l.settings;return d().createElement("div",null,d().createElement("div",{style:{marginBottom:".5rem"}},d().createElement(Dt,{itemTime:a.time,description:a.desc}),null!=c&&null!==(i=c.alarmModal)&&void 0!==i&&i.show_fields?d().createElement("span",{style:{padding:"0 0 1rem .5rem"}},d().createElement(jt,{item:a,value:a.fields})):null,d().createElement("div",null,d().createElement(Pt,{item:a}))),o?d().createElement(p.C,{is:"StreamVideo",videoUid:o,styles:{height:"300px"}}):null)},Tt=function(t){var n,r=a(d().useState([]),2),i=(r[0],r[1]),o=(0,e.use)("ws"),l=o.subscribe,c=o.onData,s=(0,e.use)("settings").settings,u=null==s?void 0:s.settings,m=(null==u||null===(n=u.alarmModal)||void 0===n?void 0:n.limit)||5,p=[];d().useEffect((function(){var t,n,r,a,o,c,s,d,m,p,f,g,v;p=null!=u&&null!==(t=u.alarmModal)&&void 0!==t&&null!==(n=t.table)&&void 0!==n&&n.length?u.alarmModal.table.map((function(e){return e.id})):void 0,f=null!=u&&null!==(r=u.alarmModal)&&void 0!==r&&null!==(a=r.tableData)&&void 0!==a&&a.length?u.alarmModal.tableData.map((function(e){return e.id})):void 0,g=null!=u&&null!==(o=u.alarmModal)&&void 0!==o&&null!==(c=o.department)&&void 0!==c&&c.length?u.alarmModal.department.map((function(e){return e.id})):void 0,v=null!=u&&null!==(s=u.alarmModal)&&void 0!==s&&s.level?null==u||null===(d=u.alarmModal)||void 0===d?void 0:d.level:void 0;var h={sort:{time:-1},skip:0,limit:(null==u||null===(m=u.alarmModal)||void 0===m?void 0:m.limit)||5,project:{status:1,processed:1,tableDataId:1,uid:1,handle:1,time:1,table:1,tableData:1,department:1,parent:1,fields:1,level:1,type:1,confirmUser:1,desc:1,remark:1,"tableData._settings":1,"tableData.hkvideo":1},filter:{level:v,tableId:p,tableDataId:f,departmentId:g},withCount:!0},y=encodeURIComponent(JSON.stringify(h));(0,e.api)({name:"warning/warning?query=".concat(y)}).fetch("",{}).then((function(e){var t;return e.json,i([]),l("warning",{level:null==u||null===(t=u.alarmModal)||void 0===t?void 0:t.level,tableId:p,tableDataId:f,departmentId:g})}))}),[u]),c(function(){var e=Bt(Ot().mark((function e(t){var n;return Ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||!g().isPlainObject(t)){e.next=15;break}if(null!=t&&t.recoveryTime){e.next=15;break}if(!((null==p?void 0:p.length)<m)){e.next=8;break}return p.push(t.id),e.next=6,f(t);case 6:e.next=15;break;case 8:return n=p[0],p.shift(),e.next=12,v.notification.close(n);case 12:return p.push(t.id),e.next=15,f(t);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var f=function(e){var t,n,r,i,a,o;e&&v.notification.open({placement:(null==u||null===(t=u.alarmModal)||void 0===t?void 0:t.placement)||"topRight",key:"".concat(e.id),style:{marginBottom:"10px"},message:d().createElement("div",{style:{marginBottom:".5rem"}},d().createElement("span",{style:{marginRight:".5rem"}},null==e||null===(n=e.table)||void 0===n?void 0:n.title),d().createElement("span",{style:{marginRight:".5rem"}},null==e||null===(r=e.tableData)||void 0===r?void 0:r.name,"（",(null==e||null===(i=e.tableData)||void 0===i?void 0:i.uid)||(null==e||null===(a=e.tableData)||void 0===a?void 0:a.id),"）")),description:d().createElement(It,{item:e}),duration:(null==u||null===(o=u.alarmModal)||void 0===o?void 0:o.statusTime)||30,onClose:function(){h(e)},top:64})},h=function(e){var t=p.indexOf(e.id);-1!=t&&p.splice(t,1)};return null};const Ft=function(t){var n,r=(0,e.use)("settings").settings,i=null==r?void 0:r.warning;return d().createElement(d().Fragment,null,null!=i&&null!==(n=i.alarmModal)&&void 0!==n&&n.show?d().createElement(Tt,t):null)};var Lt={WarningButton:{title:_r("报警铃铛"),category:[_r("页面元素"),_r("报警元素")],icon:n(714),component:function(e){return d().createElement(wt.HasPermission,{FailureComponent:null,permission:"warning.view"},d().createElement(je,e))},initLayout:{width:100,height:100},paramSchema:{type:"object",properties:{warnTypeNum:{title:_r("报警数量"),type:"string",enum:["type","processed","all"],enum_title:[_r("报警分类数"),_r("需处理报警数"),_r("所有报警")]},isAlarm:{title:_r("报警中"),type:"string",field:{uploadType:"img",btnText:"媒体库"},fieldType:"media_modal"},noAlarm:{title:_r("无报警"),type:"string",field:{uploadType:"img",btnText:"媒体库"},fieldType:"media_modal"},width:{title:_r("宽度"),type:"number",description:"默认宽度50"},height:{title:_r("高度"),description:"默认高度50",type:"number"},offsetX:{title:_r("左右偏移"),type:"number"},offsetY:{title:_r("上下偏移"),type:"number"},badgeX:{title:_r("数字左右偏移"),type:"number"},badgeY:{title:_r("数字上下偏移"),type:"number"}}}},WarningAudio:{title:_r("报警声音"),category:[_r("页面元素"),_r("报警元素")],icon:n(785),component:function(e){return d().createElement(wt.HasPermission,{FailureComponent:null,permission:"warning.view"},d().createElement(Ie,e))},initLayout:{width:100,height:100}},WarningBar:{title:_r("报警卡片"),category:[_r("页面元素"),_r("报警元素")],icon:n(739),component:function(e){return d().createElement(wt.HasPermission,{FailureComponent:null,permission:"warning.view"},d().createElement(Ct,e))},initLayout:{width:100,height:100}}},Mt=(0,Se.atom)({key:"warningUnreadAtom",default:[]}),Nt=(0,Se.atom)({key:"warningWsNewUnreadAtom",default:[]}),Rt=(0,Se.atom)({key:"warningStatAtom",default:0}),Wt=(0,Se.atom)({key:"warningProcessedCountAtom",default:0}),zt=(0,Se.atom)({key:"warningCountAtom",default:0}),qt=((0,Se.atom)({key:"warningCountAtom",default:0}),(0,Se.atom)({key:"initWarningAtom",default:[]}));const Vt=function(e){e.id,e.data;var t=e.children;return e.mode,d().createElement(Se.RecoilRoot,null,t)};var Ut=function(t){var n=t.children,r=(t.invalid,t.handleSubmit);return t.onDelete,t.schema,t.submitting,e.app.context._t,d().createElement("form",{className:"form-horizontal",onSubmit:r},d().createElement(v.Card,null,n))},Yt={bg:"transparent",normal:"#000",timeout:"#8e7cc3",offline:"#e69138",warning1:"#4c2f0a",warning2:"#ff6347",warning3:"#f00",warning4:"#333"};const Ht=function(t){var n,r,i=useI18n(),o=i.t,l=(i.i18n,a((0,u.useState)(!1),2)),c=(l[0],l[1],a((0,u.useState)(!1),2)),s=(c[0],c[1],t.input),m=s.value,f=s.onChange,g=a((0,u.useState)(Yt),2),h=g[0],y=g[1],b=(0,e.use)("dashboard.selected.ctx").ctx,A=[{title:o("名称"),dataIndex:"name",key:"name"},{title:o("数值"),dataIndex:"num",key:"num"},{title:o("状态"),dataIndex:"status",key:"status"}],E=[{key:"0",name:o("0号设备"),num:"0.7",status:o("正常"),flag:"normal"},{key:"1",name:o("1号设备"),num:"4",status:o("超时"),flagB:"timeout"},{key:"2",name:o("2号设备"),num:"4",status:o("掉线"),flagB:"offline"},{key:"3",name:o("3号设备"),num:"0.5",status:o("低级报警"),flag:"warning1"},{key:"4",name:o("4号设备"),num:"8.25",status:o("中级报警"),flag:"warning2"},{key:"5",name:o("5号设备"),num:"8.98",status:o("高级报警"),flag:"warning3"},{key:"6",name:o("6号设备"),num:"8.2",status:o("报警恢复"),flag:"warning4"}],w={modelColor:{type:"object",title:_r("颜色定义"),properties:{bg:{type:"string",title:_r("背景色"),fieldType:"color"},normal:{type:"string",title:_r("正常"),fieldType:"color"},timeout:{type:"string",title:_r("超时"),fieldType:"color"},offline:{type:"string",title:_r("掉线"),fieldType:"color"},warning1:{type:"string",title:_r("报警低"),fieldType:"color"},warning2:{type:"string",title:_r("报警中"),fieldType:"color"},warning3:{type:"string",title:_r("报警高"),fieldType:"color"},warning4:{type:"string",title:_r("报警恢复"),fieldType:"color"}}},tableColor:{type:"object",title:_r("颜色定义"),properties:{bg:{type:"string",title:_r("背景色"),fieldType:"color"},color:{type:"string",title:_r("文字颜色"),fieldType:"color"}}}};r="table"===t.type?w.tableColor:w.modelColor,"warning"==t.type&&delete r.properties.bg,"log"==(null==b||null===(n=b.consumerSchema)||void 0===n?void 0:n.name)&&"table"!==t.type&&(r={type:"object",title:_r("颜色定义"),properties:{bg:{type:"string",title:_r("背景色"),fieldType:"color"},normal:{type:"string",title:_r("正常"),fieldType:"color"}}}),(0,u.useEffect)((function(){m&&y(m)}),[m]);return d().createElement(d().Fragment,null,d().createElement(v.Row,null,d().createElement(v.Col,{flex:2},d().createElement(v.Divider,{orientation:"left"},o("颜色填充")),d().createElement(p.C,{is:"I18nSchemaForm",formKey:"tableSchema",schema:r,initialValues:m||h,component:Ut,onChange:function(e){return function(e){f(e)}(e)}})),d().createElement(v.Col,{flex:3,style:{paddingLeft:20}},d().createElement(v.Divider,{orientation:"left"},o("预览")),d().createElement("table",{className:"tableExample"},d().createElement("thead",null,d().createElement("tr",null,A.map((function(e){return d().createElement("td",null,d().createElement("b",null,o(e.title)))})))),d().createElement("tbody",null,E.map((function(e){return d().createElement("tr",{style:{color:(null==m?void 0:m[e.flag])||(null==m?void 0:m.normal)||(null==m?void 0:m.color)}},d().createElement("td",null,d().createElement("span",{style:{backgroundColor:null==m?void 0:m[e.flagB]}},o(e.name))),d().createElement("td",null,d().createElement("span",{style:{backgroundColor:null==m?void 0:m[e.flagB]}},o(e.num))),d().createElement("td",null,o(e.status)))})))))))};function Kt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $t(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kt(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Zt=function(t){var n=t.children,r=(t.invalid,t.handleSubmit),i=(t.showCode,t.submitting),a=(e.app.context._t,useI18n()),o=a.t;return a.i18n,d().createElement(v.Form,{onSubmit:r,labelCol:{span:4}},d().createElement(v.Card,{style:{marginTop:0,borderTop:"none",color:"#333"}},n,d().createElement(v.Row,{style:{display:"flex",justifyContent:"center",alignItems:"center"}},d().createElement(v.Button,{type:"primary",loading:i,onClick:r,htmlType:"submit"},o("提交")))))};const Gt=function(t){var n=useI18n(),r=n.t,i=(n.i18n,e.app.context.store),a=(0,e.use)("settings").settings,o=t.tabKey,l=t.newWarn,c=t.initValues,s=function(t){(0,e.api)({name:"core/setting"}).fetch("",{method:"PATCH",body:JSON.stringify({warning:t})}).then((function(e){e.json,i.dispatch({type:"@@iot/SAVE_SETTINGS",payload:$t($t({},a),{},{warning:t}),success:!0}),i.dispatch({type:"@@iot/GET_SETTINGS"}),v.message.success(r("保存成功"))}))};return d().useMemo((function(){return d().createElement(d().Fragment,null,d().createElement(p.C,{is:"I18nSchemaForm",formKey:"warning-".concat(o),schema:l,component:Zt,onSubmit:s,initialValues:null==c?void 0:c.warning}))}),[l,c])};function Jt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jt(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Qt=function(e){var t=e.input;return e.label,e.field,d().createElement(v.Checkbox,{value:t.value,checked:t.value,onChange:function(e){return t.onChange(e.target.checked)}})},en=function(e){var t=e.input;return e.label,e.field,d().createElement(v.Checkbox,{value:t.value,checked:t.value,onChange:function(e){return t.onChange(e.target.checked)}})},tn=function(e){var t=e.input;return e.label,e.field,d().useEffect((function(){""===t.value&&t.onChange(!0)}),[]),d().createElement(v.Checkbox,{value:t.value,checked:!!t.value,onChange:function(e){return t.onChange(e.target.checked)}})},nn=function(e){var t=useI18n(),n=t.t,r=(t.i18n,e.field.schema),i=e.input,a=i.value,o=i.onChange,l=r&&r.enums||[],c=r&&r.enum_title||[],s=!(!r||!r.values_type)&&"object"==r.values_type,u=l.map((function(e,t){return{id:e,name:c?c[t]:e}}));return d().createElement(v.Select,{mode:"multiple",onChange:function(e){if(s&&c){var t=e.map((function(e){return u.filter((function(t){return t.id==e}))[0]}));o(t)}else o(e)},style:{width:"100%"},placeholder:n("请选择级别"),value:(s&&a?a.map((function(e){return e.id})):a)||void 0},u.map((function(e){return d().createElement(Option,{key:e.id},e.name)})))},rn=function(e){var t=e.input,n=t.onChange,r=t.value;return d().createElement(v.InputNumber,{min:1,onChange:function(e){n(e)},value:r||30})},an=function(t){var n=t.children,r=(t.invalid,t.handleSubmit),i=(t.showCode,t.submitting),a=(e.app.context._t,useI18n()),o=a.t;return a.i18n,d().createElement(v.Form,{onSubmit:r},d().createElement(v.Card,{style:{marginTop:0,borderTop:"none",color:"#333"}},n,d().createElement(v.Row,{style:{display:"flex",justifyContent:"center",alignItems:"center"}},d().createElement(v.Button,{type:"primary",loading:i,onClick:r,htmlType:"submit"},o("确定")))))},on=function(t){var n=t.tabKey,r=t.setInitValues,i=useI18n(),o=i.t,l=(i.i18n,a(d().useState(!1),2)),c=l[0],s=l[1],u=(0,e.use)("settings").settings,m=null==u?void 0:u.warning,f=(e.app.context.store,{type:"object",properties:{show:{type:"boolean",title:_r("显示实时报警弹窗")},limit:{type:"number",title:_r("显示数量")},statusTime:{type:"number",title:_r("停留时间"),description:_r("S，默认30s")},department:{type:"array",title:_r("部门"),fieldType:"tableData",field:{func:"dataAuth",style:{minWidth:130},placeholder:_r("选择部门")},items:{},width:130},table:{type:"array",title:_r("设备表"),fieldType:"table",field:{func:"device"},items:{},description:_r("不选则为全部设备表")},tableData:{type:"array",title:_r("设备"),items:{},fieldType:"tableData",field:{func:"device",depend:"table"}},level:{title:_r("级别"),type:"array",items:{},enums:["低","中","高"],enum_title:[_r("低"),_r("中"),_r("高")]},show_fields:{type:"boolean",title:_r("显示报警数值")},show_handle:{type:"boolean",title:_r("显示处理操作")},show_confirm:{type:"boolean",title:_r("显示确认操作")},placement:{type:"string",title:_r("弹出位置"),enum_title:[_r("左上"),_r("右上"),_r("左下"),_r("右下")],enum:["topLeft","topRight","bottomLeft","bottomRight"]}},form:["show",{key:"limit",component:rn},{key:"statusTime",component:rn},"*",{key:"level",component:function(e){return d().createElement(nn,e)}},"show_fields","show_handle","show_confirm"]}),g=function(e){r(Xt(Xt({},u),{},{warning:Xt(Xt({},u.warning),{},{alarmModal:e})})),s(!1)};return d().createElement(d().Fragment,null,d().createElement(v.Modal,{title:o("显示配置"),visible:c,onCancel:function(){return s(!1)},footer:null},d().useMemo((function(){return f?d().createElement(p.C,{is:"I18nSchemaForm",formKey:"warning-".concat(n),schema:f,onSubmit:g,component:an,initialValues:null==m?void 0:m.alarmModal}):null}),[n,f,m])),d().createElement(v.Button,{type:"primary",onClick:function(){s(!0)}},o("显示配置")))};function ln(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function cn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ln(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ln(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var sn=v.Tabs.TabPane,un=function(e){var t=e.input,n=t.value,r=t.onChange,i=useI18n(),a=i.t,o=(i.i18n,function(e,t){r(cn(cn({},n),{},s({},e,t.target.checked)))});return d().createElement(d().Fragment,null,d().createElement(v.Checkbox,{checked:n.status,onChange:function(e){return o("status",e)}},a("已确认")),d().createElement(v.Checkbox,{checked:n.processed,onChange:function(e){return o("processed",e)}},a("已处理")))},dn=function(e){e.label;var t=e.meta,n=e.input,r=e.field,i=e.children,a=r.attrs||{},l=t.touched&&t.error,c=cn(cn({extra:r.description||r.help},{labelCol:{sm:{span:0}},wrapperCol:{sm:{span:24}}}),{},{required:r.required,labelAlign:"right"});l&&(c.validateStatus="error",c.help=l);var s=i||d().createElement(Input,o({},n,a));return d().createElement(v.Col,null,d().createElement(v.Form.Item,o({colon:!1,label:d().createElement(d().Fragment,null)},c),s))},mn=function(t){var n,r=(0,e.use)("settings"),i=r.settings,o=r.saveSettings,l=null==i||null===(n=i.warning)||void 0===n?void 0:n.warningExpand,c=a(d().useState(l),2),s=c[0],u=c[1];return d().createElement(v.Card,{className:"warning-plugin-tab"},d().createElement(p.C,{is:"SchemaEditor",ignoreConfig:["fieldScript","createShow","editShow","listFields","editableFields","batchChangeFields","filterByRes","canOrder","disabled","tableFixed","metricStore"],schema:s,input:{onChange:function(e){u(e),o(cn(cn({},i),{},{warning:cn(cn({},null==i?void 0:i.warning),{},{warningExpand:e})})),v.message.success(_t1("系统设置保存成功！"))}}}))},pn=function(t){var r,i=useI18n(),l=i.t,c=(i.i18n,[{key:"warningkind",title:l("报警类型")},{key:"warningFilter",title:l("报警分组")},{key:"otherWarn",title:l("其他配置")},{key:"warningStatus",title:l("报警状态")},{key:"warningExpand",title:l("报警扩展")}]),s=a(d().useState("warningkind"),2),u=s[0],m=s[1],f=(0,e.use)("settings").settings,g=a(d().useState(f),2),h=g[0],y=g[1],b=a(d().useState(),2),A=b[0],E=b[1],w=function(){(0,e.api)({name:"core/setting"}).fetch("").then((function(e){var t=e.json;y(t)}))};return d().useEffect((function(){w()}),[]),d().useEffect((function(){var e;"warningkind"==u&&(e={type:"object",properties:{warningkind:{title:_r("报警类型"),type:"array",items:{type:"object",properties:{id:{title:"id",type:"string"},name:{title:_r("报警名称"),type:"string"},alert:{title:_r("报警提醒"),type:"boolean"}}}}},form:[{key:"warningkind",component:function(e){return d().createElement(pe,o({warnSetting:!0},e,{type:"warningKind"}))}}]}),"warningFilter"==u&&(e={type:"object",properties:{warningFilter:{title:_r("报警分组"),type:"array",items:{type:"object",properties:{id:{title:"id",type:"string"},name:{title:_r("分组名称"),type:"string"},table:{type:"array",title:_r("设备表"),fieldType:"table",field:{func:"device"},items:{},description:_r("不选则为全部设备表")},tableData:{type:"array",title:_r("设备"),items:{},fieldType:"tableData",field:{func:"device",depend:"table"}}}}}},form:[{key:"warningFilter",component:function(e){return d().createElement(pe,o({warnSetting:!0},e,{type:"warningFilter"}))}}]}),"otherWarn"==u&&(e={type:"object",properties:{audio:{type:"string",title:_r("报警声音地址"),description:_r("整体报警提醒消息的声音配置，仅支持MP3、WAV格式"),divider:"audio",fieldType:"media_modal",field:{uploadType:"audio"}},low_audio:{type:"string",title:_r("低级报警声音"),description:_r("低级报警提醒消息的声音配置，仅支持MP3、WAV格式, 建议上传mp3格式，wav格式比特率高于128kbs时无法播放"),divider:"audio",fieldType:"media_modal",field:{uploadType:"audio"}},middle_audio:{type:"string",title:_r("中级报警声音"),description:_r("中级报警提醒消息的声音配置，仅支持MP3、WAV格式, 建议上传mp3格式，wav格式比特率高于128kbs时无法播放"),divider:"audio",fieldType:"media_modal",field:{uploadType:"audio"}},tall_audio:{type:"string",title:_r("高级报警声音"),description:_r("高级报警提醒消息的声音配置，仅支持MP3、WAV格式, 建议上传mp3格式，wav格式比特率高于128kbs时无法播放"),divider:"audio",fieldType:"media_modal",field:{uploadType:"audio"}},alarm_sound:{type:"boolean",title:_r("报警声音启用状态"),description:_r("勾选后显示报警声音开关按钮"),divider:"audio"},show_all:{type:"boolean",title:_r("显示全部报警页"),description:_r("勾选后显示全部报警分类页"),divider:"show_tab"},show_need:{type:"boolean",title:_r("显示需处理报警页"),description:_r("勾选后显示需处理报警分类页"),divider:"show_tab"},show_recovery:{type:"boolean",title:_r("显示报警恢复页"),description:_r("勾选后显示报警恢复分类页"),divider:"show_tab"},alarm_card:{type:"boolean",title:_r("实时报警卡片"),description:_r("勾选后显示实时报警卡片"),divider:"show_tab"},barlistFilter:{type:"object",title:_r("实时报警列表数据过滤"),field:{component:un},properties:{}},alarm_modal:{type:"boolean",title:_r("显示实时报警弹窗"),description:_r("勾选后显示实时报警弹窗"),divider:"show_tab"}},form:["audio","low_audio","middle_audio","tall_audio",{key:"alarm_sound",component:Qt},{key:"show_all",component:tn},{key:"show_need",component:tn},{key:"show_recovery",component:tn},{key:"alarm_card",component:en},"barlistFilter",{key:"alarm_modal",component:function(e){return d().createElement(on,o({},e,{tabKey:u,setInitValues:y}))}}]}),"warningStatus"==u&&(e={type:"object",properties:{colors:{type:"object",title:_r("表格配置"),properties:{}}},form:[{key:"colors",group:dn,component:function(e){return d().createElement(Ht,o({type:"warning"},e))}}]}),E(e),w()}),[u]),d().createElement(p.Page,{className:"warn-base-setting",title:d().createElement("span",null," ",d().createElement(p.Icon,{svg:n(755)}),l("通用配置"))},d().createElement(Z.DndProvider,{backend:G.HTML5Backend,key:"warningsetting_"},d().createElement(v.Tabs,{defaultActiveKey:null===(r=c[0])||void 0===r?void 0:r.key,onChange:function(e){m(e)}},c.map((function(e){return d().createElement(sn,{tab:e.title,key:null==e?void 0:e.key},"warningExpand"==u?d().createElement(mn,t):d().createElement(Gt,{tabKey:u,newWarn:A,initValues:h}))})))))};function fn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function gn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fn(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const vn=function(t){var n=useI18n(),r=n.t,i=(n.i18n,a((0,u.useState)(!1),2)),o=i[0],l=i[1],c=a((0,e.use)("warning.stat"),2),s=c[0],m=(c[1],(0,e.use)("model").atoms),p=(0,Se.useSetRecoilState)(m.wheres),f=null!=s&&s.length?g().clone(s):[],h=f&&(null==f?void 0:f.filter((function(e){return e.name&&(null==e?void 0:e.count)})));return h&&h.length?d().createElement(d().Fragment,null,d().createElement(v.Modal,{title:r("设备报警信息统计"),visible:o,footer:null,onCancel:function(){l(!1)}},d().createElement(v.List,{header:d().createElement("div",{style:{display:"flex"}},d().createElement("span",{style:{flex:1}},r("设备信息")),d().createElement("span",{style:{flex:1,textAlign:"right"}},r("报警总数量"))),bordered:!0,dataSource:h,renderItem:function(e){return d().createElement(v.List.Item,{onClick:function(){var t;t={tableId:e.id},p({filter:gn({},t)}),l(!1)},style:{display:"flex",cursor:"pointer"}},d().createElement("span",{style:{flex:1,textAlign:"left"}},r(e.name)),d().createElement(v.Tag,{style:{display:"inline-block"}},e.count))}})),d().createElement(v.Tooltip,{title:r("按设备表统计各个设备表下设备信息产生报警的数量")},d().createElement(v.Button,{onClick:function(){l(!0)}},r("报警统计")))):""},hn=xadminI18n;var yn=["value","field","schema","componentClass","wrap","editable"],bn=["children"];function An(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function En(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?An(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):An(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var wn,Cn=function(e){var t=e.children,n=e.pristine,r=e.invalid,i=e.handleSubmit,a=e.submitting;return d().createElement(v.Form,{onSubmit:i},t,d().createElement(v.Button,{style:{marginTop:"-1rem"},block:!0,type:"submit",loading:a,disabled:n||r,size:"small",onClick:i},(0,hn._t)("Change")))},xn=function(t){var n=(0,e.use)("model.save",t),r=n.item,i=n.field,a=n.schema,o=n.model,l=n.onClose,c=n.saveItem,u=g().find(o.form||[],(function(e){return e&&e.key==i}))||{key:i},m=(o.required||[]).indexOf(i)>=0?{required:[i]}:{};return d().createElement(p.C,{is:"I18nSchemaForm",formKey:"ChangeDataForm",initialValues:r,schema:En({type:"object",properties:s({},i,a),form:[u]},m),option:{group:(0,p.C)("Form.InlineGroup")},onSubmit:function(e){return c(En(En({},e),{},{__partial__:!0}))},onSubmitSuccess:function(){return l()},component:Cn})},Bn=function(t){var n=(0,e.use)("model.list.item",t),r=n.value,i=n.field,l=n.schema,c=n.componentClass,s=n.wrap,u=n.editable,m=x(n,yn),p=t.item,f=a(d().useState(!1),2),g=f[0],h=f[1],y=s||"span",b=u?y:function(e){var t=e.children,n=x(e,bn);return d().createElement(v.Popover,{content:d().createElement(xn,{item:p,field:i,schema:l,onClose:function(){return h(!1)}}),trigger:"click",onVisibleChange:h,visible:g,placement:"right"},d().createElement(y,o({},n,{style:{cursor:"pointer"}}),t))};if(null==p||null==p)return d().createElement(b,null,d().createElement("span",{className:"text-muted"},(0,hn._t)("Null")));if(c){var A=c;return d().createElement(A,o({item:p,value:r,field:i,schema:l,wrap:b},m))}return d().createElement(b,null,null==r||null==r?d().createElement("span",{className:"text-muted"},(0,hn._t)("Null")):r)},kn=function(t){var n,r=(0,e.use)("model.list.header",t),i=r.title,a=r.order,o=r.showText,l=r.canOrder,c=r.changeOrder,s={ASC:d().createElement(p.Icon,{type:"caret-up"}),DESC:d().createElement(p.Icon,{type:"caret-down"})}[a]||"",u=[].concat(W((n=[],l&&(n=[d().createElement(v.Menu.Item,{onClick:function(e){c("ASC")},key:"ASC"},d().createElement(p.Icon,{type:"caret-up"})," ",(0,hn._t)("Sort ASC")),d().createElement(v.Menu.Item,{onClick:function(e){c("DESC")},key:"DESC"},d().createElement(p.Icon,{type:"caret-down"})," ",(0,hn._t)("Sort DESC"))],""!=a&&n.push(d().createElement(v.Menu.Item,{onClick:function(e){c("")}},d().createElement(p.Icon,{type:"close"})," ",(0,hn._t)("Clear order")))),n)),W((0,e.Block)("model.list.header.menu")||[]));return u.filter((function(e){return!g().isNil(e)})).length>0?d().createElement(v.Dropdown,{overlay:d().createElement(v.Menu,{selectedKeys:[a]},d().Children.toArray(u)),trigger:["click"]},d().createElement("a",{style:{cursor:"pointer"}},i," ",s)):!1===o?null:d().createElement("span",null,i," ",s)},On=function(t){return d().createElement("div",{style:{width:"100%",textAlign:"center"}},function(t){var n,r=(0,e.use)("model.actions").renderActions,i=(0,e.use)("model").atoms,a=(0,Se.useRecoilValue)(i.fields);return n=-1==(null==a?void 0:a.indexOf("recoveryTime"))?r(t):r(t).length>3?r(t).splice(2,3):r(t),d().createElement(v.Button.Group,{size:"small",className:"model-list-action"},n)}((0,e.use)("model.list.row",t)))},Sn=(wn=function(t){var n=t.items,r=t.fields,i=t.size,l=t.onRow,c=t.tableProps,s=(0,e.use)("model"),m=s.model,p=s.atoms,f=(0,e.use)("model.actions").actions,g=(0,e.use)("model.batchActions").actions,h=(0,e.use)("model.select"),y=h.selected,b=h.onSelect,A=h.onSelectAll,E=a((0,Se.useRecoilState)(p.option),2),w=E[0],C=(E[1],(null==m?void 0:m.lockedFields)||[]),x=[];r&&r.forEach((function(e){var t=function(e,t){return t.split(".").reduce((function(e,t){return e&&e.properties&&e.properties[t]}),e)}(m,e);if("recoveryTime"==e&&x.push({width:200,key:e,dataIndex:e,title:_r("恢复时间"),render:function(e,t){return moment(e).format("YYYY-MM-DD HH:mm:ss")}}),t){var n=En({field:t,width:t.width||"",fixed:(null==C?void 0:C.indexOf(e))>=0,title:d().createElement(kn,{key:"model-list-header-".concat(e),field:e}),key:e,dataIndex:e,render:function(t,n){return d().createElement(Bn,{item:n,field:e})}},t.column);t.level2?x.length>0&&void 0!==x[x.length-1].children&&x[x.length-1].title==t.level2?x[x.length-1].children.push(n):x.push({title:t.level2,children:[n]}):x.push(n)}})),f&&f.length>0&&x.push({title:"",width:380,fixed:"right",key:"__action__",render:function(e,t){return d().createElement(On,{key:t.id,fields:r,id:t.id})}});var B=g&&g.length>0?{selectedRowKeys:y.map((function(e){return e.id})),onSelect:b,onSelectAll:A,getCheckboxProps:function(e){return"warning"==(null==m?void 0:m.key)?{disabled:"已处理"==(null==e?void 0:e.processed)&&"已确认"==(null==e?void 0:e.status)||"handle"in e&&0==(null==e?void 0:e.handle)}:{}}}:void 0,k=(0,u.useMemo)((function(){return 85*(x&&x.length)+(x&&x.length>0&&x.map((function(e){return e.width-80||0})).reduce((function(e,t){return e+t}))||0)}),[x]);return d().createElement(v.Table,o({columns:x,dataSource:n,bordered:!0,size:(null==w?void 0:w.size)||i||"middle",rowSelection:B,pagination:!1,onRow:l,rowKey:"id"},c,{scroll:{x:k}}))},function(t){var n=(0,e.use)("model.list",(0,e.use)("model",t)),r=(0,e.use)("model").model,i=n.loading,a=n.items,o=wn(n);if(i)return d().createElement(p.Loading,null,a.length>0?o:null);if(a.length>0)return o;var l=(null==r?void 0:r.components)&&(null==r?void 0:r.components.DataEmpty);return l?d().createElement(l,null):d().createElement(p.C,{is:"NoData"})});const _n=Sn;function jn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jn(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}v.Layout.Content,v.Layout.Sider;var Dn=function(t){var n,r,i=useI18n(),o=i.t,l=(i.i18n,t.children),c=t.invalid,s=t.handleSubmit,u=t.submitting,m=t.options,p=t.resetFilter,f=t.tab,g=(e.app.context._t,a(d().useState(!1),2)),h=g[0],y=g[1],b=l;return null!=f&&f.handle&&(b=l.filter((function(e){return"processed"!=e.key}))),d().createElement(v.Form,{className:"ant-advanced-search-form",onFinish:s},d().createElement(v.Card,{style:{marginBottom:".5rem"},bodyStyle:{paddingBottom:0}},d().createElement(v.Row,{gutter:24},(n=b,r=h?null==n?void 0:n.length:4,n.slice(0,r))),m&&m.submitOnChange?null:d().createElement(v.Row,{style:{marginBottom:".5rem"}},d().createElement(v.Col,{span:24,style:{textAlign:"center"}},d().createElement(v.Button,{disabled:c||u,type:"primary",onClick:s},o("搜索"))," ",d().createElement(v.Button,{disabled:u,onClick:p},o("重置")),d().createElement("a",{style:{fontSize:14,marginLeft:"1rem"},onClick:function(){y(!h)}},o(h?"收起":"展开"))))))},In=function(e){var t=e.label,n=e.meta,r=e.input,i=e.field,a=e.children,l=i.attrs||{},c=n.touched&&n.error,s=Pn(Pn({extra:i.description||i.help},{labelCol:{sm:{span:8}},wrapperCol:{sm:{span:16}}}),{},{required:i.required,labelAlign:"right"});c&&(s.validateStatus="error",s.help=c);var u=a||d().createElement(Input,o({},r,l));return d().createElement(v.Col,{span:8,sm:12,xs:24,md:12,lg:8,xl:8,xxl:6},d().createElement(v.Form.Item,o({colon:!1,label:t},s),u))};const Tn=function(e){var t=e.tab,n={name:"submenu",component:function(e){return d().createElement(Dn,o({},e,{tab:t}))},group:In};return d().createElement(p.C,o({is:"Model.BaseFilter"},n))};var Fn=["emptyComponent","items","activePage","maxButtons","changePage"];function Ln(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Mn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ln(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ln(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Nn=v.Layout.Content,Rn=v.Layout.Sider,Wn=d().createContext(),zn=function(e){var t=e.onAdd,n=e.children;return d().createElement(v.Button,{type:"primary",onClick:t},n)},qn=function(t){var n,r=t.activeKey,i=t.setLevel,o=t.level,l=(t.types,t.setActiveKey),c=[_t1("全部"),_t1("高"),_t1("中"),_t1("低")],s=(0,e.use)("model").atoms,u=a((0,Se.useRecoilState)(s.wheres),2),m=u[0],p=u[1],f=null==m||null===(n=m.tabs)||void 0===n?void 0:n.filters,h=a(d().useState(o||_t1("全部")),2),y=h[0],b=h[1];return d().createElement(v.Radio.Group,{value:y,buttonStyle:"solid",onChange:function(e){b(e.target.value),i(e.target.value);var t=e.target.value==_t1("全部")?g().omit({type:{$regex:r}},["level"]):Mn(Mn({type:{$regex:r}},f),{},{level:e.target.value});f&&f.type&&l(f.type),"xcl"==r&&(t=g().omit(Mn(Mn({},t),{},{handle:!0,processed:_t1("未处理")}),["type"])),"quanbu"==r&&(t=g().omit(Mn({},t),["type","handle"])),p({tabs:t})}},c.map((function(e){return d().createElement(v.Radio.Button,{value:e},e)})))},Vn=function(t){var n,r=(0,e.use)("model").model,i=(0,e.use)("model.transI18n",{model:r}).modelI18n,o=(0,e.use)("model.permission").canAdd,l=(0,e.use)("model.event").onAdd,c=(0,e.use)("settings").settings,s=null==c?void 0:c.warning,u=(null==c||null===(n=c.warning)||void 0===n?void 0:n.warningkind)||[],m=g().clone(u),f=a(d().useState(null),2),h=f[0],y=f[1],b=e.app.get("models").Warning,A=(0,e.use)("warning.warningExpand",{schema:b});s&&s.show_need&&m.unshift({name:"需处理报警",id:"xcl",show:!0}),s&&s.show_all&&m.unshift({name:"全部报警",id:"quanbu",show:!0}),s&&s.show_recovery&&m.splice(1,0,{name:"报警恢复",id:"huifu",show:!0});var E,w=null==i?void 0:i.title,C=(null==i?void 0:i.icon)||i.name;return g().isString(C)&&(C=d().createElement(p.Icon,{name:C})),d().createElement(Te.Model,{schema:i},d().createElement(p.Page,{className:"xadmin-model-list-".concat(i.key),title:d().createElement("span",null,C," ",w),subTitle:d().createElement(Te.ModelBlock,{name:"model.list.nav"}),actions:(E=i.components&&i.components.AddButton||(0,p.C)("Model.AddButton")||zn,d().createElement(d().Fragment,null,d().createElement(Te.ModelBlock,{name:"model.list.navbtn"}),o?d().createElement(E,{onAdd:l},d().createElement(p.Icon,{name:"plus"})," ",(0,hn._t)("Add {{object}}",{object:i.title})):null))},d().createElement(Tn,{tab:h}),m&&m.length>0?d().createElement(Hn,{types:m,changeTags:function(e){return y(e)}}):d().createElement(Te.Model,{schema:A,modelKey:"Warning"},d().createElement(Te.ModelBlock,{name:"model.list.sidemenu"},(function(e){return d().createElement(Te.ModelBlock,{name:"model.list.sidepanel"},(function(t){return e||t?d().createElement(v.Layout,null,e?d().createElement(Rn,{width:200,style:{backgroundColor:"transparent",marginRight:".5rem"}},e):null,d().createElement(Nn,null,Yn),t?d().createElement(Rn,{width:200,style:{backgroundColor:"transparent",marginLeft:".5rem"}},t):null):Yn}))})))))},Un=function(t){var n=(0,e.use)("model.pagination",t),r=(n.emptyComponent,n.items),i=n.activePage,a=(n.maxButtons,n.changePage),l=x(n,Fn);return 0==r?null:d().createElement(v.Pagination,o({showSizeChanger:!1,showQuickJumper:r>10,current:i,size:"sm"==t.size?"small":"",className:t.className,pageSize:1,total:r,onChange:a},l))},Yn=function(e){return[d().createElement("div",{key:"model-list-subnav",style:{display:"flex",justifyContent:"space-between",marginBottom:".5rem"}},d().createElement(qn,o({style:{marginLeft:20}},e)),d().createElement(p.C,{is:"Model.ListSubMenu"})),d().createElement(_n,null),d().createElement("div",{key:"model-list-downnav",style:{display:"flex",justifyContent:"space-between",marginTop:".5rem"}},d().createElement(p.C,{is:"Model.ActionBar"}),d().createElement(Un,{showSizeChanger:!1}))]},Hn=function(t){var n,r=t.types,i=t.changeTags,o=useI18n().t,l=(0,e.use)("model"),c=l.atoms,u=l.model,m=a(d().useState(!1),2),f=m[0],h=(m[1],["quanbu","huifu","xcl"]),y=a((0,Se.useRecoilState)(c.wheres),2),b=y[0],A=y[1],E=a((0,Se.useRecoilState)(c.fields),2),w=E[0],C=E[1],x=(0,Se.useSetRecoilState)(c.order),B=(0,Se.useSetRecoilState)(c.skip),k=(0,Se.useSetRecoilState)(c.limit);w=w||(null==u?void 0:u.listFields);var O=null==b||null===(n=b.tabs)||void 0===n?void 0:n.filters,S=(0,e.use)("auth.user").user,_=a(d().useState(null),2),j=_[0],P=_[1],D=a(d().useState(r[0].id),2),I=D[0],T=D[1],F=a(d().useState(o("全部")),2),L=F[0],M=F[1],N=a(d().useState(!0),2),R=N[0],W=N[1],z=a(d().useState(r[0]),2),q=z[0],V=z[1],U=r.filter((function(e){return e&&e.show})),Y=function(e){var t=g().cloneDeep(w),n=null==t?void 0:t.indexOf("recoveryTime");return"huifu"!=e?n>-1&&(null==t||t.splice(n,1)):-1==n&&(null==t||t.splice(1,0,"recoveryTime")),t},H=function(){var t=Bt(Ot().mark((function t(n){var r,i,a;return Ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,e.api)({name:"core/user"}).getOrigin("/".concat(null==S?void 0:S.userId," ")).then((function(e){return e}));case 2:r=t.sent,i=r.pageSetting,a={skip:0,limit:1e4,project:{name:1,permission:1,params:1,showMode:1,chartMode:1,creator:1,default:1,settings:1},filter:{type:"warning"},withCount:!0},(0,e.api)({name:"core/dataRecord"}).fetch("?query="+encodeURIComponent(JSON.stringify(a)),{}).then((function(e){var t=e.json;if(W(!1),t.length){var r=t.filter((function(e){var t,n,r,i;return(null==e||null===(t=e.settings)||void 0===t?void 0:t.default)&&(null==e||null===(n=e.settings)||void 0===n?void 0:n.default.length)>0&&-1!=(null==e||null===(r=e.settings)||void 0===r||null===(i=r.default)||void 0===i?void 0:i.indexOf(S.userId))}))[0]||!1;if(r&&g().isObject(r))return void A(Mn({},r.params))}var a=Y(I);i&&i.warning&&(a=Object.keys(i.warning).reverse()),C(a),A(Mn({},n)),B(0),k(15),x({time:"DESC"})})).catch((function(e){return v.message.error(e.message)}));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();d().useEffect((function(){K();var e={};if(b&&"{}"==JSON.stringify(b))U&&U.length>0&&(e=U[0]&&U[0].id?{tabs:{type:{$regex:U[0].id}}}:{tabs:{handle:!0,processed:"未处理"}}),q&&"全部报警"==q.name?e={tabs:{}}:q&&"需处理报警"==q.name?e={tabs:{handle:!0,processed:"未处理"}}:q&&"报警恢复"==q.name&&(e={tabs:{recoveryTime:{$exists:!0}}});else{if((e=b||{})&&e.tabs&&e.tabs.level&&M(e.tabs.level),e&&e.tabs&&e.tabs.handle&&null!=r&&r.length){var t=r.filter((function(e){return"xcl"==e.id}));(null==t?void 0:t.length)&&T("xcl")}e&&e.tabs&&e.tabs.type&&T(e.tabs.type)}H(e)}),[]);var K=function(){var t=U;if(t&&t.length>0){var n=[];t.forEach((function(t){if(!g().isBoolean(t.handle)||0!=t.handle){var r=JSON.stringify(function(e){var t;return t="全部报警"==e.name?{handle:!0}:"需处理报警"==e.name?{handle:!0,processed:"未处理"}:"报警恢复"==e.name?{recoveryTime:{$exists:!0}}:{type:{$regex:e.id}},Object.assign({limit:15,withoutBody:!0},{filter:t})}(t)),i=(0,e.api)({name:"warning"}).fetch("/warning?query=".concat(r)).then((function(e){var n=e.headers;return{id:t.id,count:n.count}}));n.push(i)}})),Promise.all(n).then((function(e){P(e.reduce((function(e,t){return Mn(Mn({},e),{},s({},t.id,t.count))}),{}))}))}};return R?d().createElement(p.Loading,null):d().createElement(Wn.Provider,{value:K},d().createElement(v.Tabs,{activeKey:O&&O.type||I,onChange:function(e){if(e)if(f)v.message.loading("玩命加载中...",3);else{var t=g().find(U,(function(t){return t.id==e})),n=g().omit(b.filters,["handle","type"]),r=Y(e);M(o("全部")),V(t),T(e),t&&"需处理报警"==t.name?(A({filters:n,tabs:{handle:!0,processed:"未处理"}}),i({handle:!0,processed:"未处理"})):t&&"全部报警"==t.name?(A({filters:n}),i(null)):t&&"报警恢复"==t.name?(A({filters:n,tabs:{recoveryTime:{$exists:!0}}}),i(null)):(A({filters:n,tabs:{type:{$regex:e}}}),i(null)),C(r)}}},(U||[]).map((function(e){var t=g().some(h,(function(t){return t==e.id}))||e.handle,n=d().createElement(v.Badge,{showZero:t,count:(null==j?void 0:j[e.id])||"0",offset:[1,-1],style:{backgroundColor:"#1790FF"}},d().createElement("div",{style:{paddingTop:"10px"}},e&&o(e.name)));return d().createElement(v.Tabs.TabPane,{key:e&&e.id,defaultActiveKey:"all",tab:n},d().createElement(Te.ModelBlock,{name:"model.list.sidemenu"},(function(t){return d().createElement(Te.ModelBlock,{name:"model.list.sidepanel"},(function(n){return t||n?d().createElement(v.Layout,null,t?d().createElement(Rn,{width:200,style:{backgroundColor:"transparent",marginRight:".5rem"}},t):null,d().createElement(Nn,null,d().createElement(Yn,{key:e&&e.id,typeObj:q,types:U,level:L,activeKey:I,setLevel:M,setActiveKey:T})),n?d().createElement(Rn,{width:200,style:{backgroundColor:"transparent",marginLeft:".5rem"}},n):null):d().createElement(Yn,{typeObj:q,setActiveKey:T,types:U,activeKey:I,level:L,setLevel:M})}))})))}))))};const Kn=function(e){return d().createElement(Vt,null,d().createElement(Vn,e))},$n=function(t){var n=t.item,r=useI18n(),i=r.t,o=(r.i18n,a(d().useState(!1),2)),l=o[0],c=o[1],s=function(){return c(!0)},m=function(e){c(!1)};return(0,u.useMemo)((function(){if(n)return d().createElement(d().Fragment,null,d().createElement(v.Button,{onClick:s},i("记录")),d().createElement(v.Modal,{title:i("报警操作记录"),visible:l,width:"85%",footer:[],onCancel:m},l?d().createElement(Te.Model,{name:"Log",modelKey:"warinng-log-".concat(n.id),props:{batchActions:[],itemActions:[function(t){var n=t.item,r=(0,e.use)("navigate");return d().createElement(v.Button,{onClick:function(){return r("/app/model/Log/".concat(null==n?void 0:n.id,"/detail"))}},i("查看详情"))}],initialValues:{wheres:{filters:{type:{$in:["报警确认","报警处理","操作记录"]},warningId:n&&n.id}}}}},d().createElement(p.C,{is:"Model.DataTable"})):null))}),[l,n&&n.id])||""};v.DatePicker.MonthPicker;var Zn=v.DatePicker.RangePicker,Gn=(v.DatePicker.WeekPicker,function(e){H(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=$(t);if(n){var i=$(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return K(this,e)});function i(){var e;q(this,i);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return s(z(e=r.call.apply(r,[this].concat(n))),"onRangeChange",(function(t){e.props.input.onChange(e.getValue(t))})),e}return U(i,[{key:"getValue",value:function(e){var t=this.props.field.datetimeFormat||"YYYY-MM-DD HH:mm:ss";return g().compact(e).length<2?{lte:Le()(g().compact(e)[0]).format(t)}:{gte:Le()(e[0]).format(t),lte:Le()(e[1]).format(t)}}},{key:"render",value:function(){return d().createElement(Zn,{allowEmpty:[!0,!0],showTime:!0,onChange:this.onRangeChange})}}]),i}(d().Component));v.Select.Option;function Jn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jn(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Qn=function(t){var n=t.item,r=(t.value,t.onClose),i=(0,e.use)("model.save").saveItem,o=a(d().useState(null),2),l=o[0],c=o[1],s=a(d().useState([]),2),u=s[0],m=s[1],p=a(d().useState(!1),2),f=p[0],g=p[1];d().useEffect((function(){var t=n&&n.desc;if(t){g(!0);var r=encodeURIComponent(JSON.stringify({sort:{time:-1},skip:0,limit:5,project:{desc:1,remark:1},filter:{desc:t,$and:[{remark:{$exists:!0}},{remark:{$ne:""}}]}}));(0,e.api)({name:"warning/warning"}).fetch("?query=".concat(r),{}).then((function(e){var t=e.json;m(t.map((function(e){return Xn(Xn({},e),{},{value:e.remark})})).filter((function(e){return e.value&&" "!=e.value}))),g(!1)})).catch((function(e){}))}}),[]);var h=function(e){return c(e)},y=(null==n?void 0:n.remark)||"";return d().createElement(d().Fragment,null,d().createElement(v.AutoComplete,{style:{width:200},defaultValue:y,options:u,onSelect:h,onChange:h,loading:f}),d().createElement(v.Button,{onClick:function(){i(Xn(Xn({},n),{},{remark:l,__partial__:!0})).then((function(e){r()}))}},"修改"))};var er=n(162);const tr=XLSX;var nr=n.n(tr);function rr(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t}const ir=function(t){var n=useI18n(),r=n.t,i=(n.i18n,(0,e.use)("model")),o=i.model,l=i.atoms,c=a((0,Se.useRecoilState)(l.ids),2),s=(c[0],c[1],a((0,Se.useRecoilState)(l.fields),2)),u=s[0],m=(s[1],a((0,Se.useRecoilState)(l.items),2)),f=m[0],g=(m[1],a(d().useState(!1),2)),h=g[0],y=g[1],b=function(){var e=Bt(Ot().mark((function e(){var t,n,i,a,l,c,s,d;return Ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:y(!0),t=null==o?void 0:o.properties,n=null==o?void 0:o.title,i=u.filter((function(e){return t[e]})),a=i.map((function(e){return t[e]&&t[e].title})),l=f&&f.length>0?f.map((function(e){return i.map((function(n){var i=t[n],a=e[n],o=null==i?void 0:i.type;if("string"==o&&i.enum&&i.enum.length>0){var l=i.enum.indexOf(a);return i.enum_title&&i.enum_title.length>0?i.enum_title[l]:a}return"object"==o?"attachment"==i.fieldType?r("空"):i.relate&&i.relate.fields?a[i.relate.fields[0].key]:(null==a?void 0:a.name)||(null==a?void 0:a.id):"boolean"==o?a?"true":"false":"array"==o?a&&a.length>0&&a[0].name?a.map((function(e){return e.name})).join("，"):"":"date-time"===i.format?a?moment(a).format("YYYY-MM-DD HH:mm:ss"):"":a}))})):[],c=nr().utils.aoa_to_sheet([a].concat(W(l))),s=nr().utils.book_new(),nr().utils.book_append_sheet(s,c,n),y(!1),d=nr().write(s,{type:"binary",bookType:"xlsx"}),(0,er.saveAs)(new Blob([rr(d)],{type:"application/octet-stream"}),"导出-".concat(n,".xlsx"));case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=!(h||!f);return d().createElement(v.Button,{onClick:b,disabled:!A,style:{marginRight:2.5}},d().createElement(p.Icon,{type:h?"loading":"download"})," ",r("导出"))};var ar=v.Layout.Content,or=v.Layout.Sider,lr=function(t){var n=t.item,r=useI18n(),i=r.t,a=(r.i18n,(0,e.use)("model.getItems").getItems);return d().createElement(v.Popconfirm,{title:i("确认删除？"),onConfirm:function(){var t,r;(0,e.api)({name:"core/t/".concat(null==n||null===(t=n.tableInfo)||void 0===t?void 0:t.id,"/d/").concat(null==n||null===(r=n.tableData)||void 0===r?void 0:r.id)}).fetch("",{method:"DELETE"}).then((function(e){var t,r;e.json,v.message.success(i("删除".concat((null==n||null===(t=n.tableData)||void 0===t?void 0:t.name)||(null==n||null===(r=n.tableData)||void 0===r?void 0:r.id),"成功"))),a()}))},onCancel:function(){},okText:i("确认"),cancelText:i("取消")},d().createElement(v.Button,{danger:!0,icon:d().createElement(p.Icon,{type:"delete"})}))},cr=function(t){t.model,t.deviceModel;var n=(0,e.use)("model.getItems").getItems,r=setInterval((function(){return n()}),18e4);d().useEffect((function(){return function(){return clearInterval(r)}}),[]);var i=(0,p.C)("Model.DataTable"),a=[d().createElement("div",{key:"model-list-subnav",style:{display:"flex",justifyContent:"space-between",marginBottom:".5rem"}},d().createElement(p.C,{is:"Model.Pagination"}),d().createElement(p.C,{is:"Model.ListSubMenu"})),d().createElement(i,{key:"model-list-grid"}),d().createElement("div",{key:"model-list-downnav",style:{display:"flex",justifyContent:"space-between",marginTop:".5rem"}},d().createElement(p.C,{is:"Model.ActionBar"}),d().createElement(p.C,{is:"Model.Pagination"}))];return d().createElement(d().Fragment,null,d().createElement(Te.ModelBlock,{name:"model.list.submenu"}),d().createElement(Te.ModelBlock,{name:"model.list.sidemenu"},(function(e){return d().createElement(Te.ModelBlock,{name:"model.list.sidepanel"},(function(t){return e||t?d().createElement(v.Layout,{style:{backgroundColor:"transparent"}},e?d().createElement(or,{width:200,style:{backgroundColor:"transparent",marginRight:".5rem"}},e):null,d().createElement(ar,null,a),t?d().createElement(or,{width:200,style:{backgroundColor:"transparent",marginLeft:".5rem"}},t):null):a}))})))};const sr=function(t){var n=t.model,r=useI18n(),i=r.t,o=(r.i18n,a(d().useState(!1),2)),l=o[0],c=o[1],s=a(d().useState([]),2),u=s[0],m=s[1];return d().createElement(d().Fragment,null,d().createElement(v.Tooltip,{title:i("掉线报警统计")},d().createElement(v.Button,{onClick:function(){(0,e.api)({name:"core/t/schema"}).query({fields:["device","function"]},{where:{device:{$not:{$regex:{driver:"test"},$exists:!0}}}}).then((function(e){var t=e.items;t&&(m(t.map((function(e){return e.id}))),setTimeout((function(){return c(!0)}),500))}))}}," ",i("无通讯")," ")),d().createElement(v.Modal,{visible:l,width:"80%",onCancel:function(){return c(!1)},bodyStyle:{padding:0},destroyOnClose:!0},d().createElement(v.Card,{title:i("无通讯状态统计")},u&&u.length>0?d().createElement(Te.Model,{name:"tRecord",key:"tRecord"+10*Math.random(),props:{title:_r("无通讯状态统计"),filters:{submenu:["name","id"]},permission:{view:!0,add:!1,edit:!1,delete:!1},initialValues:{wheres:{filters:{tableInfoId:{$in:u}}}},listFields:["tableInfo","tableData","status","connectTime","online"],blocks:{"model.list.submenu.btngroup":function(e){return[d().createElement(ir,null)]}},batchActions:null,fieldRender:{tableData:function(e){var t,n,r=e.item;return(null==r||null===(t=r.tableData)||void 0===t?void 0:t.name)||(null==r||null===(n=r.tableData)||void 0===n?void 0:n.id)||"空"},tableInfo:function(e){var t,n,r,i=e.item;return(null==i||null===(t=i.tableInfo)||void 0===t?void 0:t.title)||(null==i||null===(n=i.tableInfo)||void 0===n?void 0:n.name)||(null==i||null===(r=i.tableInfo)||void 0===r?void 0:r.id)||"空"}},itemActions:[function(e){var t=e.item;return d().createElement(lr,{item:t})}]}},d().createElement(cr,{deviceModel:u,model:n})):d().createElement(p.C,{is:"NoData"}))))},ur=function(t){var n=(0,e.use)("model"),r=n.atoms,i=(n.model,a((0,Se.useRecoilState)(r.selected),2)),o=i[0],l=(i[1],a((0,e.use)("warning.confirm.batch"),2)),c=(l[0],l[1]),s=(0,e.use)("model").modelState,u=(0,e.use)("model.getItems").getItems,m=s&&s.filter,p=o&&!g().isEmpty(o);return d().createElement(wt.HasPermission,{FailureComponent:null,permission:"warning.edit"},d().createElement(v.Button,{type:"primary",onClick:function(){p&&c({getItems:u,type:"@@oilive/CONFIRM_BATCH_WARNING",filter:m,ids:o.map((function(e){return e.id}))})},style:{margin:"5px 10%",width:"80%"},disabled:!p},"批量确认报警"))},dr=function(e){var t=e.input,n=t.value,r=t.onChange,i=a(d().useState(),2),o=i[0],l=i[1];return d().useEffect((function(){n||(r(["已处理","已确认"]),l(["已处理","已确认"]))}),[]),d().createElement(v.Checkbox.Group,{options:["已处理","已确认"],value:n||o,onChange:function(e){return r(e)}})},mr=function(t){var n=t.item,r=useI18n(),i=r.t,a=(r.i18n,(0,e.use)("warning.tabBadge")),o=function(){return null};try{var l;o=null===(l=(0,e.use)("model.getItems"))||void 0===l?void 0:l.getItems}catch(e){}var c=(0,e.use)("warnings.confirm").onProcessed;return n?n&&"handle"in n&&0==n.handle?d().createElement(wt.HasPermission,{FailureComponent:null,permission:"warning.edit"},d().createElement(v.Button,{size:"small",disabled:!0},i("无需处理"))):null==n.processed||"未处理"==n.processed?d().createElement(wt.HasPermission,{FailureComponent:null,permission:"warning.edit"},d().createElement(v.Popconfirm,{title:i("是否处理报警？"),onConfirm:function(){c(n).then((function(e){o(),e&&(v.message.success("成功处理报警信息"),"已确认"==(null==n?void 0:n.status)&&a&&a())}))},okText:i("确认"),cancelText:i("取消")},d().createElement(v.Button,{size:"small",type:"primary",style:{padding:"0 12.1px"}},i("处理")))):d().createElement(wt.HasPermission,{FailureComponent:null,permission:"warning.edit"},d().createElement(v.Button,{size:"small",disabled:!0},n.processed)):""},pr=function(t){var n=t.item,r=(0,e.use)("warning.tabBadge"),i=function(){return null};try{var a;i=null===(a=(0,e.use)("model.getItems"))||void 0===a?void 0:a.getItems}catch(e){}var o=(0,e.use)("warnings.confirm").confirm,l=useI18n(),c=l.t;return l.i18n,n?n&&"handle"in n&&0==n.handle?d().createElement(wt.HasPermission,{FailureComponent:null,permission:"warning.edit"}," ",d().createElement(v.Button,{size:"small",disabled:!0},c("无需确认"))):null==n.status||"未确认"==n.status?d().createElement(wt.HasPermission,{FailureComponent:null,permission:"warning.edit"},d().createElement(v.Popconfirm,{title:c("是否确认报警？"),onConfirm:function(){o().then((function(e){e&&(i(),v.message.success("报警信息已确认"),"已处理"==n.processed&&r&&r())}))},okText:c("确认"),cancelText:c("取消")},d().createElement(v.Button,{size:"small",type:"primary",style:{padding:"0 12.1px"}},c("确认")))):d().createElement(wt.HasPermission,{FailureComponent:null,permission:"warning.edit"},d().createElement(v.Button,{size:"small",disabled:!0},n.status)):""},fr=function(t){var n=(0,e.use)("model"),r=n.modelState,i=n.atoms,o=a((0,Se.useRecoilState)(i.selected),2),l=o[0],c=(o[1],a((0,e.use)("warning.confirm.batch"),2)),s=(c[0],c[1]),u=(0,e.use)("model.getItems").getItems,m=null==r?void 0:r.filter,p=l&&!g().isEmpty(l);return d().createElement(wt.HasPermission,{FailureComponent:null,permission:"warning.edit"},d().createElement(v.Button,{type:"primary",onClick:function(){p&&s({getItems:u,type:"@@oilive/SOLVE_BATCH_WARNING",filter:m,ids:l.map((function(e){return e.id}))})},style:{margin:"5px 10%",width:"80%"},disabled:!p},"批量处理报警"))},gr=function(t){var n,r,i,a,o,l,c,s=useI18n(),u=s.t,m=(s.i18n,t.item),f=(0,e.use)("model.getItems").getItems;return m&&m.tableData&&(n=!(!m.tableData||null==m||null===(r=m.tableData)||void 0===r||null===(i=r._settings)||void 0===i||null===(a=i.warning)||void 0===a||!a.restrainWarning)&&(null==m||null===(o=m.tableData)||void 0===o||null===(l=o._settings)||void 0===l||null===(c=l.warning)||void 0===c?void 0:c.restrainWarning)),d().createElement(v.Tooltip,{title:u(n?"报警抑制中，点击开启报警":"报警开启中，点击抑制报警")},d().createElement(v.Button,{size:"small",onClick:function(){if(m&&m.tableData){var t,n,r,i,a=m.tableData;if(null==a||null==a.id)return;var o=!(null==a||null===(t=a._settings)||void 0===t||!t.warning)&&(null==m||null===(n=m.tableData)||void 0===n||null===(r=n._settings)||void 0===r||null===(i=r.warning)||void 0===i?void 0:i.restrainWarning);new Promise((function(t,n){(0,e.api)({name:"core/t/record"}).fetch("",{method:"POST",body:JSON.stringify({tableData:{id:null==a?void 0:a.id},tableInfo:{id:a._table,title:null==a?void 0:a._table},"warning.restrainWarning":!o})}).then((function(e){v.message.success(u(o?"取消报警抑制":"抑制报警成功")),f()}))})).then((function(e){f()}))}}},n?d().createElement(p.Icon,{name:"close"}):d().createElement(p.Icon,{name:"bell"})))};function vr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}const hr=function(t){var n=useI18n(),r=n.t,i=(n.i18n,(0,e.use)("model",(function(e){return{filter:e.filter,wheres:e.wheres}}))),o=i.model,l=i.filter,c=i.atoms,u=(0,Se.useRecoilValue)(c.wheres),m=(0,Se.useRecoilValue)(c.order),f=(0,Se.useRecoilValue)(c.skip),h=((0,Se.useRecoilValue)(c.limit),(0,e.use)("model.fields",t)),y=h.selected,b=(h.fields,a(d().useState(""),2)),A=b[0],E=b[1];d().useEffect((function(){var t=g().omit(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vr(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},l),"limit","skip"),n=(0,e.api)(o),r=n.convert_where(u),i=n.convert(t);Object.keys(r).length>0&&(i.filter=r),i.sort=function(e){var t={};if(e)for(var n in e)t="DESC"==e[n]?s({},n,-1):s({},n,1);return t}(m),i.skip=f,null==y||!y.length||y.map((function(e){return i.project[e]=1}));var a=encodeURIComponent(JSON.stringify(i)),c=n.getHost()+n.resource+"?query=".concat(a,"&format=xls");c+="&token="+encodeURIComponent(n.getHeaders().Authorization),g().isEmpty(g().omit((0,e.api)({name:"media"}).getHeaders(),"Content-Type")["x-request-project"])||(c=c+"&x-request-project="+g().omit((0,e.api)({name:"media"}).getHeaders(),"Content-Type")["x-request-project"]),"front"!==(null===e.app||void 0===e.app?void 0:e.app.module)&&(c+="&x-access-path=admin"),E(c)}),[o,l,u,y]);var w=null==A?void 0:A.replace("format=xls","format=pdf"),C=d().createElement(v.Menu,{items:[{key:"1",label:d().createElement("a",{target:"_blank",href:w},r("导出PDF"))}]});return d().createElement(wt.HasPermission,{FailureComponent:null,permission:"warning.export"},d().createElement(v.Dropdown,{overlay:C,placement:"bottomLeft"},d().createElement(v.Button,{href:A,disabled:!A,style:{marginRight:2.5},target:"_blank"},d().createElement(p.Icon,{name:"download"})," ",r("导出报警"))))};var yr=["setVisible","onSubmit","IconOnClick","onSelect","onAdd","setInitData","onSearch"];function br(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ar(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?br(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):br(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}v.Layout.Header,v.Layout.Footer;var Er=v.Layout.Sider,wr=v.Layout.Content,Cr=function(t){var n,r,i,o=useI18n(),l=o.t,c=(o.i18n,t.input),s=(c.value,c.onChange),u=t.input,m=t.field,p=(m.name,m.schema),f=void 0===p?{}:p,g=a(d().useState({data:[],loading:!1}),2),h=g[0],y=g[1],b={table:l("设备表"),tableData:l("设备"),globalRule:l("全局规则"),tableTag:l("设备表数据点"),tableDataTag:l("设备数据点")};if(null!=f&&f.descSetting)try{i=(0,e.use)("form",(function(e){return{descSetting:e.values.descSetting}})).descSetting}catch(e){console.log(e)}return d().useEffect((function(){var e;null!==(e=i)&&void 0!==e&&e.length&&s(i)}),[JSON.stringify(i)]),d().useEffect((function(){(0,e.api)({name:"warning/warning/desc"}).fetch("",{}).then((function(e){var t=e.json;y({data:t,loading:!1})})).catch((function(e){y(Ar(Ar({},h),{},{loading:!1}))}))}),[]),d().createElement(v.Select,{allowClear:!0,mode:"multiple",labelInValue:!0,loading:h.loading,style:{width:"100%"},placeholder:l("请选择报警描述"),optionFilterProp:"label",value:null!=u&&null!==(n=u.value)&&void 0!==n&&n.length?u.value:void 0,showSearch:!0,onChange:function(e){s(e.map((function(e){return null==e?void 0:e.value})))},filterOption:function(e,t){return t.value.toLowerCase().indexOf(e.toLowerCase())>=0}},(null==h||null===(r=h.data)||void 0===r?void 0:r.length)&&h.data.map((function(e){return d().createElement(v.Select.Option,{key:"".concat(null==e?void 0:e.id,"-").concat(Math.random()),value:"".concat(null==e?void 0:e.id,"-").concat(null==e?void 0:e.title,"-").concat(null==e?void 0:e.type,"-").concat(e.description),label:e.description},d().createElement("span",{style:{color:"#999"}},null==e?void 0:e.title,"/"),null==b?void 0:b[null==e?void 0:e.type],"/",null==e?void 0:e.description)})))},xr=function(){var t=useI18n(),n=t.t,r=(t.i18n,a(d().useState(!1),2)),i=r[0],o=r[1],l=a(d().useState(!1),2),c=l[0],s=l[1],u=a(d().useState(null),2),m=u[0],p=u[1],f=a(d().useState(null),2),g=f[0],h=f[1],y=a(d().useState([]),2),b=y[0],A=y[1],E=a(d().useState([]),2),w=E[0],C=E[1],x=a(d().useState(null),2),B=x[0],k=x[1],O=a(d().useState(!1),2),S=O[0],_=O[1],j=function(t){t.item;var n=t.key;k(n),_(!0),(0,e.api)({name:"warning/warning"}).fetch("/archiveSetting/"+n,{}).then((function(e){var t=e.json;p(t),_(!1)}))},P=function(t){var n={project:{disabled:1}};Object.keys(kr.properties).forEach((function(e){n.project[e]=1}));var r=encodeURIComponent(JSON.stringify(n));s(!0),(0,e.api)({name:"warning/warning"}).fetch("/archiveSetting?query="+r,{}).then((function(e){var t=e.json;C(t);var n=g&&t.filter((function(e){return-1!==e.name.indexOf(g)}))||t;A(n),s(!1)}))};return d().createElement(d().Fragment,null,d().createElement("div",{onClick:function(e){P(),o(!0),p({}),k(null)}},n("周期归档定义")),d().createElement(Or,{title:n("周期归档定义"),width:"62%",visible:i,currentKey:B,setCurrentKey:k,onSelect:j,IconOnClick:function(t,r){"stop"===t?(r.disabled=!r.disabled,(0,e.api)({name:"warning/warning"}).fetch("/archiveSetting/"+r.id,{method:"PATCH",body:JSON.stringify(r)}).then((function(e){200==e.status&&(P(),v.message.success(n("".concat(r.disabled?"禁用":"启用","成功"))))}))):(0,e.api)({name:"/warning/warning/archiveSetting"}).delete(r.id).then((function(e){"OK"==e.status&&(v.message.success(n("删除成功")),P(),A([]),k(null),p({}))}))},menuData:b,schema:kr,onSubmit:function(t){var r,i,a;t&&(null!=t&&null!==(r=t.condition)&&void 0!==r&&r.length&&(t.condition.indexOf("已处理")>-1&&(t.processed="已处理"),t.condition.indexOf("已确认")>-1&&(t.status="已确认")),null!=t&&null!==(i=t.desc)&&void 0!==i&&i.length&&(t.descSetting=null==t?void 0:t.desc,t.desc=t.desc.map((function(e){return e.substr(e.lastIndexOf("-")+1)}))),null!=t&&null!==(a=t.department)&&void 0!==a&&a.length&&jr(null==t?void 0:t.department).forEach((function(e){t["".concat(e.id,"Id")]={$in:e.children.map((function(e){return e.id}))}})),(0,e.api)({name:"warning/warning"}).fetch("/archiveSetting".concat(t.id?"/"+t.id:""),{method:t.id?"PATCH":"POST",body:JSON.stringify(t)}).then((function(e){var r=e.status,i=e.json;200==r&&(v.message.success(n("保存成功")),P(),k([i.InsertedID||t.id]),j({key:i.InsertedID||t.id}))})).catch((function(e){var t=e.json;return v.message.error(t.name)})))},setInitData:p,initData:m,onSearch:function(e){var t=e.target.value;h(t);var n=w.filter((function(e){return-1!==e.name.indexOf(t)}));A(n)},setVisible:o,loading:c,conentLoading:S}))},Br=function(t){var n,r,i=t.children,a=(t.change,t.invalid),o=t.handleSubmit,l=t.submitting,c=(t.onCancel,t.limits,t.schema),s=t.currentValue,u=t.setVisible,m=useI18n(),p=m.t,f=(m.i18n,(0,e.use)("form",(function(e){return{values:e&&e.values}}))),g=f.form,h=f.values.id;return d().useEffect((function(){c.formEffect&&c.formEffect(g)}),[c]),d().createElement(v.Form,{onSubmit:o},d().createElement("div",{style:{width:"80%",margin:"20px auto"}},i),d().createElement("div",{style:{textAlign:"right",margin:"40px 50px 0px 0px"}},d().createElement(v.Form.Item,null,d().createElement("br",null),null!=s&&s.current&&0==(null==s||null===(n=s.current)||void 0===n||null===(r=n.condition)||void 0===r?void 0:r.length)?d().createElement(v.Popconfirm,{title:p("当前归档条件为空，将忽略确认及处理操作的状态，对满足其他条件的报警进行归档，为了防止出现失误，请谨慎操作！"),overlayStyle:{width:300},onConfirm:o,okText:p("确定"),cancelText:p("取消")},d().createElement(v.Button,{type:"primary",loading:l,disabled:a},p(h?"修改":"添加"))):d().createElement(v.Button,{type:"primary",onClick:o,loading:l,disabled:a},p(h?"修改":"添加")),d().createElement(v.Button,{style:{marginLeft:15},onClick:function(){return u(!1)}},(0,hn._t)("Cancel")))),d().createElement("br",null))},kr={type:"object",properties:{name:{title:_r("周期名称"),type:"string"},interval:{title:_r("归档周期"),type:"number",description:_r("以天为单位,可自定义天数")},type:{title:_r("归档类型"),type:"array",items:{},fieldType:"warningType",description:_r("不选则为全部类型")},range:{title:_r("归档范围"),type:"string",enum:["dept","table","tableData","desc"],enum_title:[_r("部门"),_r("设备表"),_r("设备"),_r("描述")]},department:{type:"array",title:_r("部门"),fieldType:"tableData",field:{func:"dataAuth",style:{minWidth:200},placeholder:_r("选择部门")},items:{}},table:{type:"array",title:_r("设备表"),fieldType:"table",field:{func:"device"},items:{},description:_r("不选则为全部设备表")},tableData:{type:"array",title:_r("设备"),items:{},fieldType:"tableData",field:{func:"device"}},desc:{title:_r("报警描述"),width:200,field:{component:function(e){return d().createElement(Cr,o({},e,{field:Ar(Ar({},e.field),{},{schema:Ar(Ar({},e.field.schema),{},{descSetting:"descSetting"})})}))}}},condition:{type:"array",title:_r("归档条件"),items:{}}},formEffect:function(e){e.useField("range",(function(t){var n=["table","department","tableData","desc"];n.forEach((function(t){return e.setFieldData(t,{display:!1})})),"dept"===t.value?(e.setFieldData("department",{display:!0}),n.filter((function(e){return"department"!=e})).forEach((function(t){return e.change(t,null)}))):"table"===t.value?(e.setFieldData("table",{display:!0}),n.filter((function(e){return"table"!=e})).forEach((function(t){return e.change(t,null)}))):"tableData"===t.value?(e.setFieldData("tableData",{display:!0}),n.filter((function(e){return"tableData"!=e})).forEach((function(t){return e.change(t,null)}))):"desc"==t.value&&(e.setFieldData("desc",{display:!0}),n.filter((function(e){return"desc"!=e})).forEach((function(t){return e.change(t,null)})))}))},form:[{key:"name",validate:function(e){return e&&e.length>10?"归档周期名字不得超过10个字符":null}},{key:"interval",validate:function(e){return e<1||e&&-1!=e.toString().indexOf(".")?"归档周期不能是负数或0或小数":null}},"*",{key:"condition",component:dr}],required:["name","interval"]},Or=function(e){var t=e.setVisible,r=e.onSubmit,i=e.IconOnClick,a=e.onSelect,l=(e.onAdd,e.setInitData),c=e.onSearch,s=x(e,yr),u=useI18n(),m=u.t,f=(u.i18n,s.title),h=s.width,y=s.menuData,b=s.visible,A=s.schema,E=s.initData,w=s.loading,C=s.currentKey,B=s.setCurrentKey,k=s.conentLoading,O=d().useRef();return d().createElement(d().Fragment,null,d().createElement(v.Modal,{title:f,visible:b,footer:null,destroyOnClose:!0,width:h,className:"ArchiveModel",onCancel:function(){t(!1),l&&l({})}},f==m("周期归档定义")?d().createElement(v.Layout,{style:{padding:10,height:550},className:"warn-archive-model"},d().createElement(Er,{width:250,style:{borderRight:"1px solid #f0f0f0",overflow:"auto"}},d().createElement("div",{style:{width:"220px",margin:"10px auto"}},d().createElement(v.Input,{placeholder:m("模糊搜索周期名称..."),onChange:c})),w?d().createElement(p.Loading,null):d().createElement(v.Menu,{mode:"inline",onSelect:a,selectedKeys:C},y.map((function(e){return d().createElement(v.Menu.Item,{key:e.id},d().createElement("span",{style:{display:"flex",justifyContent:"space-between"}},m(e.name)||"xxx",d().createElement("span",{style:{lineHeight:"40px"}},d().createElement(v.Popconfirm,{title:m("确认".concat(e.disabled?"启用":"禁用","当前归档周期？请谨慎操作")),overlayStyle:{width:230},onConfirm:function(){return i("stop",e)},okText:m("确定"),cancelText:m("取消")},d().createElement(J.StopOutlined,{style:{color:e.disabled?"red":"#36af57",cursor:"pointer"}})),d().createElement(wt.HasPermission,{FailureComponent:null,permission:"warningarchive.delete"},d().createElement(v.Popconfirm,{title:m("确认删除当前归档周期？请谨慎操作"),overlayStyle:{width:230},onConfirm:function(){return i("delete",e)},okText:m("确定"),cancelText:m("取消")},d().createElement(J.DeleteOutlined,{style:{cursor:"pointer"}}))))))})))),d().createElement(v.Layout,null,d().createElement(wr,{style:{padding:10}},k?d().createElement(p.Loading,null):d().createElement(d().Fragment,null,d().createElement(v.Button,{type:"primary",style:{marginBottom:10},onClick:function(){l({condition:["已处理","已确认"]}),B(null)}},m("添加定义")),g().isEmpty(E)?d().createElement("div",{style:{textAlign:"center",marginTop:30}},d().createElement("span",{style:{padding:"15px",color:"#E38A0F",textAlign:"center",background:"#F2EAD7",borderRadius:"4px"}},d().createElement(p.Icon,{svg:n(139)}),d().createElement("span",{style:{marginLeft:5}},m("快去添加周期归档或者选择已有周期归档进行编辑"))),d().createElement(p.C,{is:"NoData"})):d().createElement(p.C,{is:"I18nSchemaForm",formKey:"ArchiveDefinition"+JSON.stringify(E),schema:A,initialValues:E,component:function(e){return d().createElement(Br,o({},e,{currentValue:O,setVisible:t}))},onSubmit:function(e){r(e),O.current=null},onChange:function(e){return O.current=e}}))))):d().createElement(p.C,{is:"I18nSchemaForm",formKey:"ArchiveDefinition",schema:A,initialValues:E,component:function(e){return d().createElement(Br,o({},e,{currentValue:O,setVisible:t}))},onSubmit:function(e){r(e),O.current=null},onChange:function(e){return O.current=e}})))},Sr=function(e){var t=g().cloneDeep(e);return t.properties=g().omit(t.properties,"interval"),t.properties=g().omit(t.properties,"name"),t.properties.time={type:"object",title:_r("归档时间"),format:"date-time",description:_r("若只选择一个时间点，默认将时间点之前的报警信息全部归档"),properties:{}},t.properties.condition={type:"array",title:_r("归档条件"),items:{}},t.form=[{key:"time",component:Gn},{key:"type",component:R},"*",{key:"condition",component:dr}],t.required=["time"],t},jr=function(e){var t={};return e.forEach((function(e,n){var r=e.table.id;t[r]||(t[r]={id:r,children:[]}),t[r].children.push(e)})),Object.values(t)},Pr=function(){var t=useI18n(),n=t.t,r=(t.i18n,a(d().useState(!1),2)),i=r[0],l=r[1],c=(0,e.use)("model.getItems").getItems,u=d().useRef(),m=Sr(kr);return d().createElement(d().Fragment,null,d().createElement("div",{onClick:function(){return l(!0)}},n("一键归档")),m?d().createElement(Or,{title:n("一键归档"),visible:i,schema:m,setVisible:l,component:function(e){return d().createElement(Br,o({},e,{currentValue:u,setVisible:l}))},onSubmit:function(t){!function(t){var n={};if(t){var r,i,a,o,u,d;if(null!=t&&null!==(r=t.department)&&void 0!==r&&r.length){var m,p=jr(null==t?void 0:t.department),f=[];p.forEach((function(e){f=[].concat(W(f),[s({},"".concat(e.id,"Id"),{$in:e.children.map((function(e){return e.id}))})])})),null!==(m=f)&&void 0!==m&&m.length&&(n.$or=f)}null!=t&&null!==(i=t.table)&&void 0!==i&&i.length&&(n.tableId={$in:t.table.map((function(e){return e.id}))}),null!=t&&null!==(a=t.tableData)&&void 0!==a&&a.length&&(n.tableDataId={$in:t.tableData}),null!=t&&null!==(o=t.type)&&void 0!==o&&o.length&&(n.type={$in:t.type}),null!=t&&null!==(u=t.desc)&&void 0!==u&&u.length&&(n.desc={$in:t.desc.map((function(e){return e.substr(e.lastIndexOf("-")+1)}))}),null!=t&&t.time&&(Object.keys(t.time).length<2?n.time={$lte:t.time.lte}:n.time={$gte:t.time.gte,$lte:t.time.lte}),null!=t&&null!==(d=t.condition)&&void 0!==d&&d.length&&(t.condition.indexOf("已处理")>-1&&(n.processed="已处理"),t.condition.indexOf("已确认")>-1&&(n.status="已确认"))}(0,e.api)({name:"warning/warning"}).fetch("/instantArchive?query="+JSON.stringify({filter:n}),{}).then((function(e){var t=e.json;v.message.success(t),l(!1),setTimeout((function(){return c()}),800)}))}(t),u.current=null},onChange:function(e){return u.current=e}}):null)};const Dr=function(){var t=useI18n(),n=t.t,r=(t.i18n,d().createElement(v.Menu,null,d().createElement(v.Menu.Item,{key:"one"},d().createElement(Pr,null)),d().createElement(v.Menu.Item,{key:"def"},d().createElement(xr,null))));return d().createElement(v.Dropdown.Button,{type:"primary",style:{marginLeft:0,marginRight:10},className:"warningArchive",onClick:function(){return e.app.go("/app/model/WarningArchive/list")},overlay:r},d().createElement(v.Tooltip,{placement:"bottomRight",title:n("对于已处理的报警可以进行一键归档或者周期归档的操作，减少报警管理页面的数据量")},d().createElement("span",null,n("归档信息"))))};function Ir(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Tr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ir(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ir(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Fr=function(){var e=Sr(kr);return d().createElement(p.C,{is:"ClearLogBtn",btnModule:"warning",onceSchema:e,cycleSchema:kr})};const Lr={Warning:{title:_r("报警信息"),type:"object",initQuery:!1,userPageFields:!0,noLocalStorageFilter:!0,icon:d().createElement(p.Icon,{svg:n(640)}),name:"warning",resource:"warning/warning",permission:{view:!0,edit:!0,delete:!0},rolePermission:[{key:"warning.view",title:_r("查看")},{key:"warning.edit",title:_r("确认/处理")},{key:"warning.export",title:_r("导出")}],blocks:{"model.list.navbtn":function(e){return e.model,[d().createElement(p.C,{is:"FiltersHistory",defaultFilterFlag:!0}),d().createElement(wt.HasPermission,{FailureComponent:null,permission:"warningarchive.view"},d().createElement(Dr,null)),d().createElement(Fr,null),d().createElement(vn,null),d().createElement(sr,null)]},"model.list.submenu.btngroup":function(e){return e.model,d().createElement(hr,null)}},batchActions:[function(e){return d().createElement(ur,e)},function(e){return d().createElement(fr,e)}],properties:{id:{type:"string",title:_r("报警ID"),width:180},table:{title:_r("设备表"),type:"object",fieldType:"table",properties:{},width:120,field:{func:"device"}},department:{type:"array",title:_r("所属部门"),fieldType:"tableData",field:{func:"dataAuth",style:{minWidth:130},placeholder:_r("选择部门")},items:{},width:130,related:"department"},tableData:{title:_r("设备"),type:"object",fieldType:"tableData",properties:{},width:130,field:{func:"device"}},tableDataId:{type:"string",title:_r("设备编号"),width:100},time:{type:"string",format:"date-time",title:_r("报警时间"),width:180},type:{type:"string",title:_r("报警类型"),transform:function(t){var n,r,i,a,o=null===e.app||void 0===e.app||null===(n=e.app.context)||void 0===n||null===(r=n.store)||void 0===r?void 0:r.getState(),l=((null==o||null===(i=o.settings)||void 0===i||null===(a=i.warning)||void 0===a?void 0:a.warningkind)||[]).reduce((function(e,t){return Tr(Tr({},e),{},s({},t.id,t.name))}),{}),c=t;try{c=JSON.parse(t).map((function(e){return l[e]?l[e]:e})).join(",")}catch(e){}return c},width:100},processed:{type:"string",title:_r("处理动作"),enum:[_r("未处理"),_r("已处理")],enumColor:["warning","success"],width:95},status:{type:"string",title:_r("确认动作"),enum:[_r("未确认"),_r("已确认")],enumColor:["warning","success"],width:95},desc:{type:"string",title:_r("报警描述"),width:200},remark:{type:"string",title:_r("报警处理"),width:250},level:{type:"string",title:_r("级别"),enum:[_r("低"),_r("中"),_r("高")],width:70},confirmTime:{type:"string",format:"date-time",title:_r("确认时间"),width:200},confirmUser:{type:"object",title:_r("确认人"),relateTo:"User",properties:{},width:100},handleTime:{type:"string",format:"date-time",title:_r("处理时间"),width:200},handleUser:{type:"object",title:_r("处理人"),relateTo:"User",properties:{},width:100},fields:{type:"array",title:_r("报警数值"),items:{title:_r("数值"),type:"object",properties:{}},width:180}},listFields:["time","table","tableData","tableDataId","department","fields","level","type","confirmUser","confirmTime","handleTime","handleUser","desc","remark"],orders:{time:"DESC"},filters:{nav:["id","time","table","tableData",{key:"department",component:function(e){return d().createElement(p.C,o({is:"Common.SelectTableRecord"},e,{filter:{function:{$regex:"dataAuth"}}}))}},"confirmUser","desc"],submenu:["id","time","status","processed","tableDataId","desc"]},fieldRender:{fields:st,type:function(t){var n,r=t.value,i=(0,e.use)("settings").settings,a=useI18n(),o=a.t,l=(a.i18n,(null==i||null===(n=i.warning)||void 0===n?void 0:n.warningkind)||[]);if(!r)return o("空");if(g().isString(r)){var c=l.filter((function(e){return e.id==r}))||[],s=c&&c.length>0?c[0].name:r;return s&&s.indexOf("-")>0?"":s||""}if(g().isArray(r)&&g().isArray(l)){var u=l.filter((function(e){return r.some((function(t){return t===e.id}))}));return null!=u&&u.length?u.map((function(e){return null==e?void 0:e.name})).join(","):""}},tableDataId:function(e){var t,n=e.item,r=useI18n(),i=r.t;return r.i18n,(null==n||null===(t=n.tableData)||void 0===t?void 0:t.id)||i("空")},table:function(e){var t,n,r,i=e.item,a=useI18n(),o=a.t;return a.i18n,(null==i||null===(t=i.table)||void 0===t?void 0:t.title)||(null==i||null===(n=i.table)||void 0===n?void 0:n.name)||(null==i||null===(r=i.table)||void 0===r?void 0:r.id)||o("空")},department:function(e){var t,n=e.item,r=null==n||null===(t=n.tableData)||void 0===t?void 0:t._department;return g().isEmpty(r)||!g().isPlainObject(r)||g().isEmpty(Object.values(r))?_t1("空"):g().flattenDeep(Object.values(r)).map((function(e){return null==e?void 0:e.name})).join("")},remark:function(e){var t=e.item,n=e.value,r=e.wrap,i=a(d().useState(!1),2),l=i[0],c=i[1];return d().createElement(v.Popover,{content:d().createElement(Qn,{item:t,onClose:function(){return c(!1)}}),trigger:"click",onVisibleChange:c,visible:l,placement:"right"},d().createElement(r,o({},e,{style:{cursor:"pointer"}}),n||d().createElement("span",{class:"text-muted"},(0,hn._t)("Null"))," ",d().createElement(p.Icon,{type:"edit"})))}},components:{DataEmpty:function(e){return d().createElement(v.Empty,{description:_t1("暂无数据"),image:n(753)})},ListPage:function(e){return/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)&&(0,p.C)("Mobile.Nodes")?d().createElement(p.C,o({is:"Mobile.Warning"},e)):d().createElement(Kn,e)}},projectFields:["status","processed","tableData","tableData._settings","handle"],form:["*"],batchChangeFields:["status","processed"],itemActions:["warning_submit","warning_processed","warning_log","warning_display","warning_record"],refresh:{submenu:[3,5,10]},defaultPageSize:15}};var Mr={warning_submit:{component:function(e){var t=e.item;return d().createElement(pr,{item:t})},description:_r("确认")},warning_processed:{component:function(e){var t=e.item;return d().createElement(mr,{item:t})},description:_r("处理")},warning_log:{component:function(e){var t=e.item;return d().createElement($n,{item:t})},description:_r("记录")},warning_display:{component:function(e){var t=e.item;return d().createElement(gr,{item:t})},description:_r("抑制报警")},warning_record:{component:function(t){var n=t.item,r=useI18n(),i=r.t;return r.i18n,n&&n.tableData?d().createElement(v.Button,{onClick:function(){var t,r;return e.app.go("/app/table/".concat(null==n||null===(t=n.table)||void 0===t?void 0:t.id,"/").concat(null==n||null===(r=n.tableData)||void 0===r?void 0:r.id,"/edit"))}},i("设备")):null},description:_r("设备")}};function Nr(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function Rr(e){return!!e&&!!e[xi]}function Wr(e){var t;return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===Bi}(e)||Array.isArray(e)||!!e[Ci]||!!(null===(t=e.constructor)||void 0===t?void 0:t[Ci])||Yr(e)||Hr(e))}function zr(e,t,n){void 0===n&&(n=!1),0===qr(e)?(n?Object.keys:ki)(e).forEach((function(r){n&&"symbol"==typeof r||t(r,e[r],e)})):e.forEach((function(n,r){return t(r,n,e)}))}function qr(e){var t=e[xi];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:Yr(e)?2:Hr(e)?3:0}function Vr(e,t){return 2===qr(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Ur(e,t,n){var r=qr(e);2===r?e.set(t,n):3===r?e.add(n):e[t]=n}function Yr(e){return bi&&e instanceof Map}function Hr(e){return Ai&&e instanceof Set}function Kr(e){return e.o||e.t}function $r(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=Oi(e);delete t[xi];for(var n=ki(t),r=0;r<n.length;r++){var i=n[r],a=t[i];!1===a.writable&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(t[i]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[i]})}return Object.create(Object.getPrototypeOf(e),t)}function Zr(e,t){return void 0===t&&(t=!1),Jr(e)||Rr(e)||!Wr(e)||(qr(e)>1&&(e.set=e.add=e.clear=e.delete=Gr),Object.freeze(e),t&&zr(e,(function(e,t){return Zr(t,!0)}),!0)),e}function Gr(){Nr(2)}function Jr(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function Xr(e){var t=Si[e];return t||Nr(18,e),t}function Qr(){return hi}function ei(e,t){t&&(Xr("Patches"),e.u=[],e.s=[],e.v=t)}function ti(e){ni(e),e.p.forEach(ii),e.p=null}function ni(e){e===hi&&(hi=e.l)}function ri(e){return hi={p:[],l:hi,h:e,m:!0,_:0}}function ii(e){var t=e[xi];0===t.i||1===t.i?t.j():t.g=!0}function ai(e,t){t._=t.p.length;var n=t.p[0],r=void 0!==e&&e!==n;return t.h.O||Xr("ES5").S(t,e,r),r?(n[xi].P&&(ti(t),Nr(4)),Wr(e)&&(e=oi(t,e),t.l||ci(t,e)),t.u&&Xr("Patches").M(n[xi].t,e,t.u,t.s)):e=oi(t,n,[]),ti(t),t.u&&t.v(t.u,t.s),e!==wi?e:void 0}function oi(e,t,n){if(Jr(t))return t;var r=t[xi];if(!r)return zr(t,(function(i,a){return li(e,r,t,i,a,n)}),!0),t;if(r.A!==e)return t;if(!r.P)return ci(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var i=4===r.i||5===r.i?r.o=$r(r.k):r.o,a=i,o=!1;3===r.i&&(a=new Set(i),i.clear(),o=!0),zr(a,(function(t,a){return li(e,r,i,t,a,n,o)})),ci(e,i,!1),n&&e.u&&Xr("Patches").N(r,n,e.u,e.s)}return r.o}function li(e,t,n,r,i,a,o){if(Rr(i)){var l=oi(e,i,a&&t&&3!==t.i&&!Vr(t.R,r)?a.concat(r):void 0);if(Ur(n,r,l),!Rr(l))return;e.m=!1}else o&&n.add(i);if(Wr(i)&&!Jr(i)){if(!e.h.D&&e._<1)return;oi(e,i),t&&t.A.l||ci(e,i)}}function ci(e,t,n){void 0===n&&(n=!1),!e.l&&e.h.D&&e.m&&Zr(t,n)}function si(e,t){var n=e[xi];return(n?Kr(n):e)[t]}function ui(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function di(e){e.P||(e.P=!0,e.l&&di(e.l))}function mi(e){e.o||(e.o=$r(e.t))}function pi(e,t,n){var r=Yr(t)?Xr("MapSet").F(t,n):Hr(t)?Xr("MapSet").T(t,n):e.O?function(e,t){var n=Array.isArray(e),r={i:n?1:0,A:t?t.A:Qr(),P:!1,I:!1,R:{},l:t,t:e,k:null,o:null,j:null,C:!1},i=r,a=_i;n&&(i=[r],a=ji);var o=Proxy.revocable(i,a),l=o.revoke,c=o.proxy;return r.k=c,r.j=l,c}(t,n):Xr("ES5").J(t,n);return(n?n.A:Qr()).p.push(r),r}function fi(e){return Rr(e)||Nr(22,e),function e(t){if(!Wr(t))return t;var n,r=t[xi],i=qr(t);if(r){if(!r.P&&(r.i<4||!Xr("ES5").K(r)))return r.t;r.I=!0,n=gi(t,i),r.I=!1}else n=gi(t,i);return zr(n,(function(t,i){r&&function(e,t){return 2===qr(e)?e.get(t):e[t]}(r.t,t)===i||Ur(n,t,e(i))})),3===i?new Set(n):n}(e)}function gi(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return $r(e)}var vi,hi,yi="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),bi="undefined"!=typeof Map,Ai="undefined"!=typeof Set,Ei="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,wi=yi?Symbol.for("immer-nothing"):((vi={})["immer-nothing"]=!0,vi),Ci=yi?Symbol.for("immer-draftable"):"__$immer_draftable",xi=yi?Symbol.for("immer-state"):"__$immer_state",Bi=("undefined"!=typeof Symbol&&Symbol.iterator,""+Object.prototype.constructor),ki="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,Oi=Object.getOwnPropertyDescriptors||function(e){var t={};return ki(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t},Si={},_i={get:function(e,t){if(t===xi)return e;var n=Kr(e);if(!Vr(n,t))return function(e,t,n){var r,i=ui(t,n);return i?"value"in i?i.value:null===(r=i.get)||void 0===r?void 0:r.call(e.k):void 0}(e,n,t);var r=n[t];return e.I||!Wr(r)?r:r===si(e.t,t)?(mi(e),e.o[t]=pi(e.A.h,r,e)):r},has:function(e,t){return t in Kr(e)},ownKeys:function(e){return Reflect.ownKeys(Kr(e))},set:function(e,t,n){var r=ui(Kr(e),t);if(null==r?void 0:r.set)return r.set.call(e.k,n),!0;if(!e.P){var i=si(Kr(e),t),a=null==i?void 0:i[xi];if(a&&a.t===n)return e.o[t]=n,e.R[t]=!1,!0;if(function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}(n,i)&&(void 0!==n||Vr(e.t,t)))return!0;mi(e),di(e)}return e.o[t]===n&&(void 0!==n||t in e.o)||Number.isNaN(n)&&Number.isNaN(e.o[t])||(e.o[t]=n,e.R[t]=!0),!0},deleteProperty:function(e,t){return void 0!==si(e.t,t)||t in e.t?(e.R[t]=!1,mi(e),di(e)):delete e.R[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=Kr(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty:function(){Nr(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){Nr(12)}},ji={};zr(_i,(function(e,t){ji[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),ji.deleteProperty=function(e,t){return ji.set.call(this,e,t,void 0)},ji.set=function(e,t,n){return _i.set.call(this,e[0],t,n,e[0])};var Pi=function(){function e(e){var t=this;this.O=Ei,this.D=!0,this.produce=function(e,n,r){if("function"==typeof e&&"function"!=typeof n){var i=n;n=e;var a=t;return function(e){var t=this;void 0===e&&(e=i);for(var r=arguments.length,o=Array(r>1?r-1:0),l=1;l<r;l++)o[l-1]=arguments[l];return a.produce(e,(function(e){var r;return(r=n).call.apply(r,[t,e].concat(o))}))}}var o;if("function"!=typeof n&&Nr(6),void 0!==r&&"function"!=typeof r&&Nr(7),Wr(e)){var l=ri(t),c=pi(t,e,void 0),s=!0;try{o=n(c),s=!1}finally{s?ti(l):ni(l)}return"undefined"!=typeof Promise&&o instanceof Promise?o.then((function(e){return ei(l,r),ai(e,l)}),(function(e){throw ti(l),e})):(ei(l,r),ai(o,l))}if(!e||"object"!=typeof e){if(void 0===(o=n(e))&&(o=e),o===wi&&(o=void 0),t.D&&Zr(o,!0),r){var u=[],d=[];Xr("Patches").M(e,o,u,d),r(u,d)}return o}Nr(21,e)},this.produceWithPatches=function(e,n){if("function"==typeof e)return function(n){for(var r=arguments.length,i=Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return t.produceWithPatches(n,(function(t){return e.apply(void 0,[t].concat(i))}))};var r,i,a=t.produce(e,n,(function(e,t){r=e,i=t}));return"undefined"!=typeof Promise&&a instanceof Promise?a.then((function(e){return[e,r,i]})):[a,r,i]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){Wr(e)||Nr(8),Rr(e)&&(e=fi(e));var t=ri(this),n=pi(this,e,void 0);return n[xi].C=!0,ni(t),n},t.finishDraft=function(e,t){var n=(e&&e[xi]).A;return ei(n,t),ai(void 0,n)},t.setAutoFreeze=function(e){this.D=e},t.setUseProxies=function(e){e&&!Ei&&Nr(20),this.O=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));var i=Xr("Patches").$;return Rr(e)?i(e,t):this.produce(e,(function(e){return i(e,t)}))},e}(),Di=new Pi,Ii=Di.produce;Di.produceWithPatches.bind(Di),Di.setAutoFreeze.bind(Di),Di.setUseProxies.bind(Di),Di.applyPatches.bind(Di),Di.createDraft.bind(Di),Di.finishDraft.bind(Di);const Ti=Ii;function Fi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Li(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fi(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Mi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ni=new Map,Ri=function(e,t){if(e){var n="selector.".concat(null==e?void 0:e.key).concat(t?"."+t:"");if(Ni.has(n))return Ni.get(n);var r=(0,Se.selector)({key:n,get:function(n){var r=(0,n.get)(e);return t?g().get(r,t):r},set:function(n,r){var i=n.set,a=(0,n.get)(e),o=r;return t&&(o=g().set(Li({},a),t,r)),i(e,o)}});return Ni.set(n,r),r}};function Wi(){return(0,Se.useRecoilState)(Ri.apply(void 0,arguments))}var zi=(0,Se.selectorFamily)({key:"warningStatSelector",get:function(t){return function(){var t=Bt(Ot().mark((function t(n){var r;return Ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.get,t.next=3,(0,e.api)({name:"warning/warning/stats"}).fetch("",{}).then((function(e){return e.json})).catch((function(e){return[]}));case 3:return r=t.sent,t.abrupt("return",r||[]);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),qi=((0,Se.selectorFamily)({key:"warning_data_selector",get:function(t){return Bt(Ot().mark((function t(){var n,r,i,a,o,l,c;return Ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={},t.prev=1,t.next=4,(0,e.api)(e.app.get("models").Warning).fetch("/stats/latest").then((function(e){return e.json}));case 4:return r=t.sent,i=null==r?void 0:r.length,a={withoutBody:!0},o={filter:{processed:"未处理"},withoutBody:!0},t.next=10,(0,e.api)(e.app.get("models").Warning).fetch("?query=".concat(JSON.stringify(a))).then((function(e){var t;return(null==e||null===(t=e.headers)||void 0===t?void 0:t.count)-0}));case 10:return l=t.sent,t.next=13,(0,e.api)(e.app.get("models").Warning).fetch("?query=".concat(JSON.stringify(o))).then((function(e){var t;return(null==e||null===(t=e.headers)||void 0===t?void 0:t.count)-0}));case 13:c=t.sent,n={unread:r,typeCount:i,count:l,processedCount:c},t.next=20;break;case 17:t.prev=17,t.t0=t.catch(1),e.app.error(t.t0);case 20:return t.abrupt("return",n);case 21:case"end":return t.stop()}}),t,null,[[1,17]])})))}}),(0,Se.selectorFamily)({key:"warning_confirm_batch_selector",get:function(e){return function(e){return e.get,[]}},set:function(t){return function(n,r){var i=n.set,a=n.get,o=t||r,l=o.type,c=(o.filter,o.ids),s=o.getItems;try{e.app.get("models").Warning;var u="@@oilive/CONFIRM_BATCH_WARNING"==l?"?type=status":"?type=processed";(0,e.api)({name:"warning/warning/batch"}).fetch(u,{method:"PATCH",body:JSON.stringify(c)}).then((function(e){200==e.status&&v.message.success("批量确认报警信息成功"),s()}));var d=a(qt),m=r;return t&&(m=Ti(d,(function(e){g().set(e,t,r)}))),i(qt,m)}catch(e){}}}})),Vi=(0,Se.selectorFamily)({key:"confirm_all_warning_selector",get:function(e){return function(e){return e.get,[]}},set:function(t){return function(n,r){var i=n.set,a=(n.get,function(){return null});try{var o;a=null===(o=(0,e.use)("model.getItems",props))||void 0===o?void 0:o.getItems}catch(e){}try{var l=t||(null==r?void 0:r.type);(0,e.api)({name:"warning/warning/all"}).fetch("",{method:"PATCH",body:JSON.stringify(l)}).then((function(e){"200"==e.status&&v.message.success("成功确认全部报警信息")})),i(Mt,[]),i(Nt,[]),i(Rt,0),i(Wt,0),a()}catch(t){v.message.error("操作出现问题"),e.app.error(t)}}}}),Ui=(0,Se.selectorFamily)({key:"processed_all_warning_selector",get:function(e){return function(e){return e.get,[]}},set:function(t){return function(n,r){var i=n.set,a=(n.get,function(){return null}),o=t||(null==r?void 0:r.type);try{var l;a=null===(l=(0,e.use)("model.getItems",props))||void 0===l?void 0:l.getItems}catch(e){}try{(0,e.api)({name:"warning/warning/all"}).fetch("?type=".concat(o),{method:"PATCH"}).then((function(e){"200"==e.status&&v.message.success("成功处理全部报警信息")})),i(Nt,[]),a()}catch(t){v.message.error("操作出现问题"),e.app.error(t)}}}}),Yi=(0,Se.selectorFamily)({key:"warning_add_data_selector",get:function(e){return function(){var e=Bt(Ot().mark((function e(t){var n;return Ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.get,n={},e.abrupt("return",n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},set:function(e){return function(t,n){var r,i=t.set,a=t.get,o=a(Mt),l=a(Wt),c=a(zt),s=a(Mt),u=a(Nt),d=a(Rt);return e?(g().merge(g().cloneDeep(o),e),r=s.some((function(t){var n,r;return(null==t||null===(n=t.tableData)||void 0===n?void 0:n.id)==(null==e||null===(r=e.tableData)||void 0===r?void 0:r.id)&&(null==t?void 0:t.ruleid)==(null==e?void 0:e.ruleid)}))):(g().merge(g().cloneDeep(o),n),r=s.some((function(e){var t,r;return(null==e||null===(t=e.tableData)||void 0===t?void 0:t.id)==(null==n||null===(r=n.tableData)||void 0===r?void 0:r.id)&&(null==e?void 0:e.ruleid)==(null==n?void 0:n.ruleid)}))),console.log(zt,Wt,"更新报警数量"),i(Wt,l+1),i(zt,c+1),r||i(Rt,d+1),i(Nt,[].concat(W(u),[n])),i(Mt,[].concat(W(s),[n]))}}});const Hi={"warning.stat":function(){return Wi(zi())},"warning.confirm.batch":function(e){return Wi(qi(e))},"warning.processed.all":function(e){return Wi(Ui(e))},"warnings.confirmall":function(e){return Wi(Vi(e))},"warning.unread":function(){return Wi(Mt)},"warning.count":function(){return Wi(zt)},"warning.typeCount":function(){return Wi(Rt)},"warning.processedCount":function(){return Wi(Wt)},"warning.add":function(e){return Wi(Yi(e))},"warnings.confirm":function(){var t=(0,e.use)("auth.user").user,n=e.app.get("models").Warning,r=function(){var r=Bt(Ot().mark((function r(i){var a;return Ot().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=(0,e.api)(n).save({id:null==i?void 0:i.id,status:"已确认",confirmUser:{id:null==t?void 0:t.userId,name:null==t?void 0:t.username}},!0).then((function(e){return e})),Li({confirmUser:{id:null==t?void 0:t.userId,name:null==t?void 0:t.username}},a),r.abrupt("return",a);case 3:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),i=function(){var r=Bt(Ot().mark((function r(i){var a;return Ot().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=(0,e.api)(n).save({id:null==i?void 0:i.id,processed:"已处理",handleUser:{id:null==t?void 0:t.userId,name:t.username}},!0).then((function(e){return e})),Li({handleUser:{id:null==t?void 0:t.userId,name:t.username}},a),r.abrupt("return",a);case 3:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}();return{confirm:r,onProcessed:i}},"warning.ws":function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4?arguments[4]:void 0,l=a(d().useState([]),2),c=l[0],s=l[1],u=(0,e.use)("settings").settings,m=null==u?void 0:u.warning,p=(0,e.use)("ws"),f=p.onData,v=p.subscribe,h=a((0,e.use)("warning.unread"),2),y=h[0],b=h[1],A=d().useRef();d().useEffect((function(){if(!n)return null!=A&&A.current&&g().isFunction(A.current)&&A.current(),A.current=v("warning",t);var i={sort:{time:-1},skip:0,limit:o||15,project:{status:1,processed:1,uid:1,tableDataId:1,handle:1,time:1,table:1,tableData:1,department:1,fields:1,level:1,type:1,confirmUser:1,desc:1,remark:1,"tableData._settings":1,"tableData.hkvideo":1,recoveryTime:1},withCount:!0};g().isEmpty(r)||(i.filter=r.filter);var a=encodeURIComponent(JSON.stringify(i));(0,e.api)({name:"warning/warning?query=".concat(a)}).fetch("",{}).then((function(e){var n=e.json;return s(n),null!=A&&A.current&&g().isFunction(A.current)&&A.current(),A.current=v("warning",t)}))}),[JSON.stringify(t),n,JSON.stringify(r),JSON.stringify(o)]),d().useEffect((function(){return function(){null!=A&&A.current&&g().isFunction(A.current)&&A.current()}}),[]);var E=function(e){return e.fields?e.fields.map((function(e){var t=function(e,t){return g().isBoolean(e)?e?1:0:g().isNumber(e)?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return g().isNumber(e)?Math.round(e*Math.pow(10,t))/Math.pow(10,t):e}(e,void 0!==t?t:3):e?e.toString():"-"}(e.value,null==e?void 0:e.fixed)+"".concat((null==e?void 0:e.unit)||"");return null!=e&&e.name&&null!=(null==e?void 0:e.value)?d().createElement("span",{style:{marginRight:5,cursor:"pointer"},onClick:function(){node&&onShow({time,node,tag:e})}},e.name,":",t):""})).filter(Boolean):""};return f((function(e){if(e&&g().isPlainObject(e)&&(null==e||!e.recoveryTime))if("realtime"==i){var t=g().cloneDeep(c)||[];(null==c?void 0:c.length)<o?g().isArray(t)&&t.unshift(e):(g().isArray(t)&&t.unshift(e),t.pop());var n=t.map((function(e){var t,n;return Li(Li({},e),{},{time:moment(e.time).format("YYYY-MM-DD HH:mm:ss"),fields:E(e),type:null!=m&&null!==(t=m.warningkind)&&void 0!==t&&t.length?null===(n=m.warningkind.filter((function(t){return e.type==t.id}))[0])||void 0===n?void 0:n.name:""})}));s(n)}else b([].concat(W(y),[e])),s([].concat(W(c),[e]))})),{data:c}},"warning.data":(Ki=Bt(Ot().mark((function t(){var n,r,i,o,l,c,s,u,d,m,p,f,g,v,h,y;return Ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=(0,e.use)("warning.typeCount"),(r=a(n,2))[0],i=r[1],o=(0,e.use)("warning.count"),(l=a(o,2))[0],c=l[1],s=(0,e.use)("warning.processedCount"),(u=a(s,2))[0],d=u[1],m={},t.prev=4,t.next=7,(0,e.api)(e.app.get("models").Warning).fetch("/stats/latest").then((function(e){return e.json}));case 7:return p=t.sent,f=null==p?void 0:p.length,g={withoutBody:!0},v={filter:{processed:"未处理"},withoutBody:!0},t.next=13,(0,e.api)(e.app.get("models").Warning).fetch("?query=".concat(JSON.stringify(g))).then((function(e){var t;return(null==e||null===(t=e.headers)||void 0===t?void 0:t.count)-0}));case 13:return h=t.sent,t.next=16,(0,e.api)(e.app.get("models").Warning).fetch("?query=".concat(JSON.stringify(v))).then((function(e){var t;return(null==e||null===(t=e.headers)||void 0===t?void 0:t.count)-0}));case 16:y=t.sent,m={unread:p,typeCount:f,count:h,processedCount:y},i(f),c(h),d(y),t.next=26;break;case 23:t.prev=23,t.t0=t.catch(4),e.app.error(t.t0);case 26:return t.abrupt("return",m);case 27:case"end":return t.stop()}}),t,null,[[4,23]])}))),function(){return Ki.apply(this,arguments)}),"warning.schema":function(e,t){return{rules:ke({table:e,tableData:t})}},"warning.warningExpand":function(t){var n,r=t.schema,i=(0,e.use)("settings").settings;return function(e,t){var n,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Mi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Mi(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw a}}}}(g().keys((null==t?void 0:t.properties)||[]));try{for(r.s();!(n=r.n()).done;){var i,a=n.value;e.properties&&t.properties&&(e.properties[a]=t.properties[a],e.form.push(a),null!==(i=e.properties[a])&&void 0!==i&&i.filterFields&&e.filters.submenu.push(a))}}catch(e){r.e(e)}finally{r.f()}return e}(r,null==i||null===(n=i.warning)||void 0===n?void 0:n.warningExpand)},"warning.tabBadge":function(){return d().useContext(Wn)}};var Ki,$i=function(){var e=useI18n(),n=e.t,r=(e.i18n,a(use("warning.data"),2)),i=r[0],o=r[1],l=a(use("warning.unread"),1)[0];return d().useEffect((function(){o(i)}),[i]),d().createElement("a",{onClick:function(){return t().go("/app/model/Warning/list")}},l&&l.length?d().createElement(p.Icon,{type:"bell",style:{color:"red"}}):d().createElement(p.Icon,{type:"bell",style:{color:"green"}}),d().createElement("span",{className:"nav-text"},n("报警处理")," ",d().createElement(v.Badge,{count:l.length})))};const Zi={"dashboard.main":function(){return d().createElement(v.Card,{bodyStyle:{padding:15},title:_t1("最新报警信息")},d().createElement(Te.Model,{name:"Warning"},d().createElement(p.C,{is:"Model.DataTable",size:"small"})," ",d().createElement("br",null),d().createElement("div",{key:"model-list-subnav",style:{display:"flex",justifyContent:"space-between",marginBottom:".5rem"}},d().createElement(p.C,{is:"Model.Pagination"}),d().createElement(p.C,{is:"Model.ListSubMenu"}))))},mainmenu:function(){return d().createElement(wt.HasPermission,{FailureComponent:null,permission:"warning.view"},d().createElement($i,null))},main:function(){var e,t,n,r=null===(e=window.location.href)||void 0===e||null===(t=e.split("?"))||void 0===t?void 0:t[1],i=!0;return r&&(null===(n=r.split("&"))||void 0===n||n.forEach((function(e){var t,n;"loadwarning"===(null===(t=e.split("="))||void 0===t?void 0:t[0])&&"false"===(null===(n=e.split("="))||void 0===n?void 0:n[1])&&(i=!1)}))),d().createElement(d().Fragment,null,d().createElement(Pe,null),i&&d().createElement(wt.HasPermission,{FailureComponent:null,permission:"warning.view"},d().createElement(Ie,null),d().createElement(Ct,null),d().createElement(Ft,null)))}};const Gi={WarningPopover:dt,"Warning.BellButton":je,"Warning.Audio":Ie,"Warning.Bar":Ct,Notification:Ft,WarningExportBtn:pr,KindSelect:R,TimeRanges:function(e){var t=useI18n(),n=t.t,r=(t.i18n,e.input),i=r.onChange,a=r.value,o=[{key:n("天"),value:"d"},{key:n("周"),value:"w"},{key:n("分钟"),value:"m"},{key:n("小时"),value:"h"}];return d().createElement(v.Space,null,d().createElement(v.Input,{style:{width:160},placeholder:n("数值"),type:"number",onChange:function(e){e.target.value>=0&&i({unit:a.unit,count:parseInt(e.target.value)})},value:a.count||null,addonAfter:d().createElement(v.Select,{style:{width:75},onChange:function(e){return i({count:a.count,unit:e})},value:a.unit},o.map((function(e){return d().createElement(v.Select.Option,{value:e.value},e.key)})))}))},ProcessedSelect:function(e){var t=e.input,n=t.value,r=t.onChange;return d().createElement(v.Select,{mode:"multiple",allowClear:!0,style:{width:"100%"},onChange:function(e){r(e)},value:n||void 0},["未处理","已处理"].map((function(e){return d().createElement(v.Select.Option,{key:e},e)})))},StatusSelect:function(e){var t=e.input,n=t.value,r=t.onChange;return d().createElement(v.Select,{mode:"multiple",allowClear:!0,style:{width:"100%"},onChange:function(e){r(e)},value:n||void 0},["未确认","已确认"].map((function(e){return d().createElement(v.Select.Option,{key:e},e)})))},PropListPane:N,WarningKind:pe},Ji=JSON.parse('{"报警处理":"Alarm processing","最新报警信息":"Latest alarm information","设备表":"Equipment List","设备":"Equipment","全局规则":"Global Rules","设备表数据点":"Equipment table data points","设备数据点":"Device data points","请选择报警描述":"Please select an alarm description","删除成功":"Successfully deleted","保存成功":"Successfully saved","周期归档定义":"Cycle Archive Definition","当前归档条件为空，将忽略确认及处理操作的状态，对满足其他条件的报警进行归档，为了防止出现失误，请谨慎操作！":"The current archiving condition is empty. The status of confirmation and processing operations will be ignored, and alarms that meet other conditions will be archived. To prevent errors, please operate with caution!","确定":"Determine","取消":"Cancel","修改":"Modify","添加":"Add to","周期名称":"Cycle Name","归档周期":"Archive cycle","以天为单位,可自定义天数":"In days, customizable days","归档类型":"Archived Type ","不选则为全部类型":"If not selected, all types will be selected","归档范围":"Archive Scope","部门":"Department","描述":"Describe","部门选择":"Department selection","所属部门":"Department","不选则为全部部门":"If not selected, all departments will be selected","不选则为全部设备表":"If not selected, all devices will be listed","报警描述":"Alarm Description","归档条件":"Archive conditions","模糊搜索周期名称...":"Fuzzy search cycle name","确认删除当前归档周期？请谨慎操作":"Are you sure to delete the current archive cycle? Please operate with caution","添加定义":"Add Definition","快去添加周期归档或者选择已有周期归档进行编辑":"Quickly add a cycle archive or select an existing cycle archive for editing","归档时间":"Archive time","若只选择一个时间点，默认将时间点之前的报警信息全部归档":"If only one time point is selected, all alarm information before the time point will be archived by default","一键归档":"One click archiving","对于已处理的报警可以进行一键归档或者周期归档的操作，减少报警管理页面的数据量":"For processed alarms, one click archiving or periodic archiving can be performed to reduce the amount of data on the alarm management page","归档信息":"Archived Information ","请选择设备":"Please select a device","无需确认":"No confirmation required","是否确认报警？":"Confirm the alarm?","确认":"Confirm","导出PDF":"Export PDF","导出报警":"Export alarms","无需处理":"No processing required","是否处理报警？":"Is the alarm handled?","处理":"Handle","取消报警抑制":"Cancel alarm suppression","抑制报警成功":"Successfully suppressed alarm","报警抑制中，点击开启报警":"In alarm suppression, click to turn on the alarm","报警开启中，点击抑制报警":"When the alarm is on, click to suppress the alarm","报警管理":"Alarm management","通用配置":"General configuration","规则管理":"Rule Management","恢复成功":"Recovery was successful","恢复":"Recovery","批量恢复成功":"Batch recovery successful","批量恢复报警":"Batch Recovery Alarm","批量删除成功":"Successfully deleted in bulk","批量删除报警":"Batch Delete Alarm","报警归档信息":"Alarm Archive Information","查看":"See","删除":"Delete","报警ID":"Alarm ID","表名称":"Table Name","名称":"Name","编号":"Number","报警时间":"Alarm time","设备编号":"Equipment number","报警类型":"Alarm type","处理动作":"Processing actions","确认动作":"Confirm Action","级别":"Level","确认时间":"Confirmation time","确认人":"Confirmed by","处理时间":"Processing time ","处理人":"Processed by","报警数值":"Alarm value","数值":"Numerical value","空":"Empty","设备配置信息":"Device configuration information","状态":"State","通信时间":"Communication time","在线":"On-line","数据点名称":"Data point name","数据点标识":"Data point identification","设备表名称":"Equipment Table Name","设备名称":"Device Name","数据点":"Data point","个":"Individual","分":"Branch","秒":"Second","选择":"Choice","请先选择类型":"Please select a type first","报警规则管理":"Alarm Rule Management","规则名称":"Rule Name","规则类型":"Rule Type","报警级别":"Alarm level","时长":"Duration","单位":"Company","应用范围":"Application scope","数据点类型":"Data point type","数据":"Data","分钟":"Minute","报警信息":"Alarm information","确认/处理":"Confirmation/Processing","导出":"Export","未处理":"Unprocessed","已处理":"Processed","未确认":"Unconfirmed","已确认":"Confirmed","低":"Low","中":"In","高":"High","记录":"Record","抑制报警":"Suppress alarms","确认删除？":"Confirm deletion?","掉线报警统计":"Offline alarm statistics","无通讯":"No communication","无通讯状态统计":"No communication status statistics","搜索":"Search","重置":"Reset","收起":"Pack up","展开":"Open","恢复时间":"Recovery time","全部":"Whole","报警操作记录":"Alarm operation record","查看详情":"View Details","设备报警信息统计":"Equipment alarm information statistics","设备信息":"Device Information","报警总数量":"Total number of alarms","按设备表统计各个设备表下设备信息产生报警的数量":"Count the number of alarms generated by device information in each device table according to the device table","报警统计":"Alarm statistics","0号设备":"Equipment 0","正常":"Normal","1号设备":"Equipment 1","超时":"Overtime","2号设备":"Equipment 2","掉线":"Offline","3号设备":"Equipment 3","低级报警":"Low alarm ","4号设备":"Equipment 4","中级报警":"Intermediate alarm","5号设备":"Equipment 5","高级报警":"Advanced alarm","6号设备":"Equipment 6","报警恢复":"Alarm recovery","颜色定义":"Color Definition","背景色":"Background color","报警低":"Alarm low","报警中":"In alarm","报警高":"Alarm high","文字颜色":"Text color","颜色填充":"Color Fill","预览":"Preview","提交":"Submit","系统设置保存成功":"System settings saved successfully","类型名称":"Type Name","定义报警类型的名称":"Define the name of the alarm type","报警声音":"Alarm sound","仅支持MP3、WAV格式":"Only supports MP3 and WAV formats","报警提醒":"Alarm reminder","勾选后报警产生会进行声音提醒及数量增加":"After checking, the alarm will generate an audible reminder and increase the quantity","勾选报警消息可进行报警确认及处理的操作":"Tick the alarm message to perform alarm confirmation and processing operations","是否显示":"Display or not","勾选后报警类型显示在页面中，否则不显示":"After checking, the alarm type will be displayed on the page, otherwise it will not be displayed","处理状态":"Processing status","不选择":"Do not select","确认状态":"Confirm Status","作用范围":"Scope of action","分组名称":"Group Name","提醒":"Remind","不提醒":"Do not remind","需处理":"Need to handle","显示":"Display","不显示":"Do not display","操作":"Operation","内置种类不可删除":"The built-in category cannot be deleted","确认删除?":"Confirm deletion?","添加成功":"Successfully added","添加报警类型":"Add Alarm Type","添加报警分组":"Add Alarm Group","报警类型名称已存在":"Alarm type name already exists","报警分组名称已存在":"Alarm group name already exists","种类信息":"Category information","分组信息":"Group information","请选择级别":"Please select a level","显示实时报警弹窗":"Display real-time alarm pop-up","显示数量":"Display quantity","停留时间":"Residence time","S，默认30s":"S. Default 30s","显示报警数值":"Display alarm values","显示处理操作":"Display processing operations","显示确认操作":"Display confirmation operation","弹出位置":"Eject position","左上":"Upper Left","右上":"Upper Right","左下":"Lower Left","右下":"Lower right","显示配置":"Display Configuration","添加规则":"Add Rule","报警分组":"Alarm grouping","其他配置":"Other configurations","报警状态":"Alarm status","报警名称":"Alarm Name","报警声音地址":"Alarm sound address","报警提醒消息的声音配置，仅支持MP3、WAV格式":"The sound configuration of alarm reminder messages only supports MP3 and WAV formats","报警声音启用状态":"Alarm sound enable status","勾选后显示报警声音开关按钮":"After checking, display the alarm sound switch button","显示全部报警页":"Display all alarm pages","勾选后显示全部报警分类页":"After checking, display all alarm classification pages","显示需处理报警页":"Display the alarm page that needs to be processed","勾选后显示需处理报警分类页":"After checking, display the alarm classification page that needs to be processed","显示报警恢复页":"Display alarm recovery page","勾选后显示报警恢复分类页":"After checking, display the alarm recovery classification page","实时报警卡片":"Real time alarm card","勾选后显示实时报警卡片":"Display real-time alarm card after checking","实时报警列表数据过滤":"Real time alarm list data filtering","勾选后显示实时报警弹窗":"Show real-time alarm pop-up after checking","表格配置":"Table Configuration","您确定要将全部报警信息确认？":"Are you sure you want to confirm all alarm information?","确认全部报警信息":"Confirm all alarm information","全部确认":"Confirm All","您确定要将全部报警信息处理？":"Are you sure you want to process all alarm information?","处理全部报警信息":"Process all alarm information","全部处理":"Process All","出错了":"Error ","开":"Open","关":"Shut","报警声音开关":"Alarm sound switch","需处理报警条数":"Number of alarms to be processed","报警信息总条数":"Total number of alarm messages","不同设备/报警规则报警条数":"Number of alarms for different devices/alarm rules","未加载数据分析模块":"Data analysis module not loaded","报警部门":"Alarm department","报警设备":"Alarm equipment","报警数据":"Alarm data","确认报警":"Confirm alarm","报警已确认":"Alarm confirmed","上传成功":"Upload successful","上传失败！":"Upload failed!","上传报警声音":"Upload alarm sound","报警铃铛":"Alarm bell","页面元素":"Page Elements","报警元素":"Alarm element","报警数量":"Number of alarms","报警分类数":"Number of alarm categories","需处理报警数":"Number of alarms to be processed","所有报警":"All alarms","无报警":"No alarm","宽度":"Width","高度":"Height","左右偏移":"Left and right offset","上下偏移":"Up and down offset","数字左右偏移":"Number left and right offset","数字上下偏移":"Number Up and Down Offset","报警卡片":"Alarm card","处理报警":"Handling alarms","报警已处理":"Alarm processed","天":"Day","周":"Week","小时":"Hour","系统变量":"System variables","系统时间":"System time","延时提醒时长(s)":"Delay reminder duration (s)","若设置延时提醒时长，产生报警，经过设定时长后进行第一次报警提醒":"If the delay reminder duration is set, an alarm will be generated, and after the set duration, the first alarm reminder will be triggered","基础配置":"Basic configuration","提醒配置":"Reminder Configuration","高级配置":"Advanced configuration","报警设置":"Alarm settings","通用表功能":"Universal Table Function","【报警设置】表功能应用后，可实现复杂报警规则的定义。如当数据点的数据值超过某个范围或者设备掉线，需要产生报警时，可应用此功能。应用后，表的TAB会相应的增加一个":"After the application of the alarm settings table function, complex alarm rules can be defined. This function can be applied when an alarm needs to be generated when the data value of a data point exceeds a certain range or the device is disconnected. After application, a corresponding TAB will be added to the table","报警规则":"Alarm Rules","可定义报警逻辑、报警描述、报警类型，上传报警声音等详细信息":"Can define alarm logic, alarm description, alarm type, upload detailed information such as alarm sound","未填写..":"Not filled in","报警规则名称不能重复":"Alarm rule name cannot be duplicate","报警规则名称":"Alarm Rule Name","按类型管理报警消息，类型支持用户在【通用配置】中自定义":"Manage alarm messages by type, which supports user customization in the General Configuration","范围限定":"Scope limitation","黑名单":"Blacklist","白名单":"Whitelist","黑名单设备":"Blacklist devices","白名单设备":"Whitelist devices","播放次数":"Playback count","报警声音播放次数，不填为仅一次":"Number of times the alarm sound is played, not filled in as only once","开启后报警声音提醒及报警数据量的更新":"Alarm sound reminder and update of alarm data volume after activation","开启后可对报警信息进行报警确认及报警处理的操作":"After activation, alarm confirmation and processing can be performed on the alarm information","若需要展示设备名称，请输入{{tableDataName}}":"If you need to display the device name, please enter {{tableDataName}}","报警间隔(s)":"Alarm interval (s)","在定义的时间范围内，对同一设备同一条报警规则产生的报警进行合并，只展示一条报警消息":"Merge alarms generated by the same device and alarm rule within a defined time range, displaying only one alarm message","报警次数":"Number of alarms","配置报警次数后，触发报警条件产生的报警提示信息达到设定次数，将不会信的产生报警消息，当报警恢复后，重新计算次数":"After configuring the number of alarms, if the alarm prompt information generated by triggering the alarm condition reaches the set number, it will not be believed to generate an alarm message. After the alarm is restored, the number of times will be recalculated","报警死区":"Alarm Deadband","定义报警恢复数值与报警数值之间的波动范围":"Define the fluctuation range between the alarm recovery value and the alarm value","禁用":"Disabled","禁用后当前报警规则不生效":"The current alarm rule will not take effect after disabling","关注数据":"Follow data","用于保存除报警规则数据点外，报警产生时其他数据点的实时值":"Used to save real-time values of data points other than alarm rule data points at the time of alarm generation","节点":"Node","报警触发周期":"Alarm triggering cycle","报警逻辑":"Alarm logic","请选择数据点或资产属性其中一个值":"Please select one of the values for the data point or asset attribute","报警数值数据":"Alarm value data","自定义报警中报警数值列显示的数据点，默认显示报警逻辑中的所有数据点":"Customize the data points displayed in the alarm value column in the alarm, and display all data points in the alarm logic by default","超时处理":"Timeout handler ","报警有效期":"Alarm validity period","启用":"Enable","配置有效期后，只会在有效期间产生报警信息":"After configuring the validity period, only alarm messages will be generated during the validity period","对设备的所有报警规则进行抑制，报警规则抑制后，设备不会产生报警":"Suppress all alarm rules of the device, and once the alarm rules are suppressed, the device will not generate an alarm","从":"From","*星期":"*Week","每":"Each","星期":"Week"}'),Xi={zh_Hans:{translation:JSON.parse('{"报警处理":"报警处理","最新报警信息":"最新报警信息","设备表":"设备表","设备":"设备","全局规则":"全局规则","设备表数据点":"设备表数据点","设备数据点":"设备数据点","请选择报警描述":"请选择报警描述","删除成功":"删除成功","保存成功":"保存成功","周期归档定义":"周期归档定义","当前归档条件为空，将忽略确认及处理操作的状态，对满足其他条件的报警进行归档，为了防止出现失误，请谨慎操作！":"当前归档条件为空，将忽略确认及处理操作的状态，对满足其他条件的报警进行归档，为了防止出现失误，请谨慎操作！","确定":"确定","取消":"取消","修改":"修改","添加":"添加","周期名称":"周期名称","归档周期":"归档周期","以天为单位,可自定义天数":"以天为单位,可自定义天数","归档类型":"归档类型","不选则为全部类型":"不选则为全部类型","归档范围":"归档范围","部门":"部门","描述":"描述","部门选择":"部门选择","所属部门":"所属部门","不选则为全部部门":"不选则为全部部门","不选则为全部设备表":"不选则为全部设备表","报警描述":"报警描述","归档条件":"归档条件","模糊搜索周期名称...":"模糊搜索周期名称...","确认删除当前归档周期？请谨慎操作":"确认删除当前归档周期？请谨慎操作","添加定义":"添加定义","快去添加周期归档或者选择已有周期归档进行编辑":"快去添加周期归档或者选择已有周期归档进行编辑","归档时间":"归档时间","若只选择一个时间点，默认将时间点之前的报警信息全部归档":"若只选择一个时间点，默认将时间点之前的报警信息全部归档","一键归档":"一键归档","对于已处理的报警可以进行一键归档或者周期归档的操作，减少报警管理页面的数据量":"对于已处理的报警可以进行一键归档或者周期归档的操作，减少报警管理页面的数据量","归档信息":"归档信息","请选择设备":"请选择设备","无需确认":"无需确认","是否确认报警？":"是否确认报警？","确认":"确认","导出PDF":"导出PDF","导出报警":"导出报警","无需处理":"无需处理","是否处理报警？":"是否处理报警？","处理":"处理","取消报警抑制":"取消报警抑制","抑制报警成功":"抑制报警成功","报警抑制中，点击开启报警":"报警抑制中，点击开启报警","报警开启中，点击抑制报警":"报警开启中，点击抑制报警","报警管理":"报警管理","通用配置":"通用配置","规则管理":"规则管理","恢复成功":"恢复成功","恢复":"恢复","批量恢复成功":"批量恢复成功","批量恢复报警":"批量恢复报警","批量删除成功":"批量删除成功","批量删除报警":"批量删除报警","报警归档信息":"报警归档信息","查看":"查看","删除":"删除","报警ID":"报警ID","表名称":"表名称","名称":"名称","编号":"编号","报警时间":"报警时间","设备编号":"设备编号","报警类型":"报警类型","处理动作":"处理动作","确认动作":"确认动作","级别":"级别","确认时间":"确认时间","确认人":"确认人","处理时间":"处理时间","处理人":"处理人","报警数值":"报警数值","数值":"数值","空":"空","设备配置信息":"设备配置信息","状态":"状态","通信时间":"通信时间","在线":"在线","数据点名称":"数据点名称","数据点标识":"数据点标识","设备表名称":"设备表名称","设备名称":"设备名称","数据点":"数据点","个":"个","分":"分","秒":"秒","选择":"选择","请先选择类型":"请先选择类型","报警规则管理":"报警规则管理","规则名称":"规则名称","规则类型":"规则类型","报警级别":"报警级别","时长":"时长","单位":"单位","应用范围":"应用范围","数据点类型":"数据点类型","数据":"数据","分钟":"分钟","报警信息":"报警信息","确认/处理":"确认/处理","导出":"导出","未处理":"未处理","已处理":"已处理","未确认":"未确认","已确认":"已确认","低":"低","中":"中","高":"高","记录":"记录","抑制报警":"抑制报警","确认删除？":"确认删除？","掉线报警统计":"掉线报警统计","无通讯":"无通讯","无通讯状态统计":"无通讯状态统计","搜索":"搜索","重置":"重置","收起":"收起","展开":"展开","恢复时间":"恢复时间","全部":"全部","报警操作记录":"报警操作记录","查看详情":"查看详情","设备报警信息统计":"设备报警信息统计","设备信息":"设备信息","报警总数量":"报警总数量","按设备表统计各个设备表下设备信息产生报警的数量":"按设备表统计各个设备表下设备信息产生报警的数量","报警统计":"报警统计","0号设备":"0号设备","正常":"正常","1号设备":"1号设备","超时":"超时","2号设备":"2号设备","掉线":"掉线","3号设备":"3号设备","低级报警":"低级报警","4号设备":"4号设备","中级报警":"中级报警","5号设备":"5号设备","高级报警":"高级报警","6号设备":"6号设备","报警恢复":"报警恢复","颜色定义":"颜色定义","背景色":"背景色","报警低":"报警低","报警中":"报警中","报警高":"报警高","文字颜色":"文字颜色","颜色填充":"颜色填充","预览":"预览","提交":"提交","系统设置保存成功":"系统设置保存成功","类型名称":"类型名称","定义报警类型的名称":"定义报警类型的名称","报警声音":"报警声音","仅支持MP3、WAV格式":"仅支持MP3、WAV格式","报警提醒":"报警提醒","勾选后报警产生会进行声音提醒及数量增加":"勾选后报警产生会进行声音提醒及数量增加","勾选报警消息可进行报警确认及处理的操作":"勾选报警消息可进行报警确认及处理的操作","是否显示":"是否显示","勾选后报警类型显示在页面中，否则不显示":"勾选后报警类型显示在页面中，否则不显示","处理状态":"处理状态","不选择":"不选择","确认状态":"确认状态","作用范围":"作用范围","分组名称":"分组名称","提醒":"提醒","不提醒":"不提醒","需处理":"需处理","显示":"显示","不显示":"不显示","操作":"操作","内置种类不可删除":"内置种类不可删除","确认删除?":"确认删除?","添加成功":"添加成功","添加报警类型":"添加报警类型","添加报警分组":"添加报警分组","报警类型名称已存在":"报警类型名称已存在","报警分组名称已存在":"报警分组名称已存在","种类信息":"种类信息","分组信息":"分组信息","请选择级别":"请选择级别","显示实时报警弹窗":"显示实时报警弹窗","显示数量":"显示数量","停留时间":"停留时间","S，默认30s":"S，默认30s","显示报警数值":"显示报警数值","显示处理操作":"显示处理操作","显示确认操作":"显示确认操作","弹出位置":"弹出位置","左上":"左上","右上":"右上","左下":"左下","右下":"右下","显示配置":"显示配置","添加规则":"添加规则","报警分组":"报警分组","其他配置":"其他配置","报警状态":"报警状态","报警名称":"报警名称","报警声音地址":"报警声音地址","报警提醒消息的声音配置，仅支持MP3、WAV格式":"报警提醒消息的声音配置，仅支持MP3、WAV格式","报警声音启用状态":"报警声音启用状态","勾选后显示报警声音开关按钮":"勾选后显示报警声音开关按钮","显示全部报警页":"显示全部报警页","勾选后显示全部报警分类页":"勾选后显示全部报警分类页","显示需处理报警页":"显示需处理报警页","勾选后显示需处理报警分类页":"勾选后显示需处理报警分类页","显示报警恢复页":"显示报警恢复页","勾选后显示报警恢复分类页":"勾选后显示报警恢复分类页","实时报警卡片":"实时报警卡片","勾选后显示实时报警卡片":"勾选后显示实时报警卡片","实时报警列表数据过滤":"实时报警列表数据过滤","勾选后显示实时报警弹窗":"勾选后显示实时报警弹窗","表格配置":"表格配置","您确定要将全部报警信息确认？":"您确定要将全部报警信息确认？","确认全部报警信息":"确认全部报警信息","全部确认":"全部确认","您确定要将全部报警信息处理？":"您确定要将全部报警信息处理？","处理全部报警信息":"处理全部报警信息","全部处理":"全部处理","出错了":"出错了","开":"开","关":"关","报警声音开关":"报警声音开关","需处理报警条数":"需处理报警条数","报警信息总条数":"报警信息总条数","不同设备/报警规则报警条数":"不同设备/报警规则报警条数","未加载数据分析模块":"未加载数据分析模块","报警部门":"报警部门","报警设备":"报警设备","报警数据":"报警数据","确认报警":"确认报警","报警已确认":"报警已确认","上传成功":"上传成功","上传失败！":"上传失败！","上传报警声音":"上传报警声音","报警铃铛":"报警铃铛","页面元素":"页面元素","报警元素":"报警元素","报警数量":"报警数量","报警分类数":"报警分类数","需处理报警数":"需处理报警数","所有报警":"所有报警","无报警":"无报警","宽度":"宽度","高度":"高度","左右偏移":"左右偏移","上下偏移":"上下偏移","数字左右偏移":"数字左右偏移","数字上下偏移":"数字上下偏移","报警卡片":"报警卡片","处理报警":"处理报警","报警已处理":"报警已处理","天":"天","周":"周","小时":"小时","系统变量":"系统变量","系统时间":"系统时间","延时提醒时长(s)":"延时提醒时长(s)","若设置延时提醒时长，产生报警，经过设定时长后进行第一次报警提醒":"若设置延时提醒时长，产生报警，经过设定时长后进行第一次报警提醒","基础配置":"基础配置","提醒配置":"提醒配置","高级配置":"高级配置","报警设置":"报警设置","通用表功能":"通用表功能","【报警设置】表功能应用后，可实现复杂报警规则的定义。如当数据点的数据值超过某个范围或者设备掉线，需要产生报警时，可应用此功能。应用后，表的TAB会相应的增加一个":"【报警设置】表功能应用后，可实现复杂报警规则的定义。如当数据点的数据值超过某个范围或者设备掉线，需要产生报警时，可应用此功能。应用后，表的TAB会相应的增加一个","报警规则":"报警规则","可定义报警逻辑、报警描述、报警类型，上传报警声音等详细信息":"可定义报警逻辑、报警描述、报警类型，上传报警声音等详细信息","未填写..":"未填写..","报警规则名称不能重复":"报警规则名称不能重复","报警规则名称":"报警规则名称","按类型管理报警消息，类型支持用户在【通用配置】中自定义":"按类型管理报警消息，类型支持用户在【通用配置】中自定义","范围限定":"范围限定","黑名单":"黑名单","白名单":"白名单","黑名单设备":"黑名单设备","白名单设备":"白名单设备","播放次数":"播放次数","报警声音播放次数，不填为仅一次":"报警声音播放次数，不填为仅一次","开启后报警声音提醒及报警数据量的更新":"开启后报警声音提醒及报警数据量的更新","开启后可对报警信息进行报警确认及报警处理的操作":"开启后可对报警信息进行报警确认及报警处理的操作","若需要展示设备名称，请输入{{tableDataName}}":"若需要展示设备名称，请输入{{tableDataName}}","报警间隔(s)":"报警间隔(s)","在定义的时间范围内，对同一设备同一条报警规则产生的报警进行合并，只展示一条报警消息":"在定义的时间范围内，对同一设备同一条报警规则产生的报警进行合并，只展示一条报警消息","报警次数":"报警次数","配置报警次数后，触发报警条件产生的报警提示信息达到设定次数，将不会信的产生报警消息，当报警恢复后，重新计算次数":"配置报警次数后，触发报警条件产生的报警提示信息达到设定次数，将不会信的产生报警消息，当报警恢复后，重新计算次数","报警死区":"报警死区","定义报警恢复数值与报警数值之间的波动范围":"定义报警恢复数值与报警数值之间的波动范围","禁用":"禁用","禁用后当前报警规则不生效":"禁用后当前报警规则不生效","关注数据":"关注数据","用于保存除报警规则数据点外，报警产生时其他数据点的实时值":"用于保存除报警规则数据点外，报警产生时其他数据点的实时值","节点":"节点","报警触发周期":"报警触发周期","报警逻辑":"报警逻辑","请选择数据点或资产属性其中一个值":"请选择数据点或资产属性其中一个值","报警数值数据":"报警数值数据","自定义报警中报警数值列显示的数据点，默认显示报警逻辑中的所有数据点":"自定义报警中报警数值列显示的数据点，默认显示报警逻辑中的所有数据点","超时处理":"超时处理","报警有效期":"报警有效期","启用":"启用","配置有效期后，只会在有效期间产生报警信息":"配置有效期后，只会在有效期间产生报警信息","对设备的所有报警规则进行抑制，报警规则抑制后，设备不会产生报警":"对设备的所有报警规则进行抑制，报警规则抑制后，设备不会产生报警","从":"从","*星期":"*星期","每":"每","星期":"星期"}')},en:{translation:Ji}},Qi={name:"airiot.warning",icons:{name:"Warning",url:n(458)},locales:Xi,menuItems:[{title:_r("报警管理"),icon:"Warning",key:"warning",permission:"warning.view",children:[{title:_r("通用配置"),url:"/app/currency_setting",icon:"Warning",permission:"warning.view"},{title:_r("规则管理"),url:"/app/model/Rule/list",icon:"Warning",permission:"rule.view"},{title:_r("报警处理"),url:"/app/model/Warning/list",icon:"Warning",permission:"warning.view"}]}],frontMenuItems:[{title:_r("报警处理"),url:"/app/model/Warning/list",icon:"Warning",permission:"warning.view"}],components:Gi,dashboardWidgets:Lt,routers:{"/app/":[{path:"currency_setting",breadcrumbName:"通用配置",component:function(e){return d().createElement(Vt,null,d().createElement(pn,e))}},{path:"a",breadcrumbName:"通用配置",component:function(e){return React.createElement(Se.RecoilRoot,null,React.createElement(je,e))}}]},mappers:{"warnings.confirmall":{method:{confirmAll:function(e){e.model;var t=e.dispatch;return function(e){t({type:"@@oilive/CONFIRM_ALL_WARNING",where:{}})}},onProcessedAll:function(e){e.model;var t=e.dispatch;return function(e){t({type:"@@oilive/PROCESSED_ALL_WARNING",where:{type:"processed"}})}}}},"warnings.unread":{data:function(e){return{items:e.state.warning.unread}},event:{mount:function(e){return(0,e.dispatch)({type:"@@oilive/UNREAD_WARNING"})}}}},blocks:Zi,models:Lr,hooks:Hi,schema_converter:[function(e,t,n){return"array"===t.type&&"warningType"==t.fieldType&&(e.type="warning_type"),e}],form_fields:{warning_type:{component:R}},modelActions:Mr};function ea(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ta(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ea(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ea(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}v.Layout.Content,v.Layout.Sider;var na=function(t){var n=useI18n(),r=n.t,i=(n.i18n,t.size),o=void 0===i?"default":i,l=t.is_icon,c=t.type,u=void 0===c?"primary":c,m=a(d().useState(!1),2),f=m[0],h=m[1],y=(0,e.use)("model.save",t).saveItem,b=(0,e.use)("model.getItems",t).getItems,A=((0,e.use)("model").modelDispatch,sa.Rule),E=function(e,t){var n=e;return"m"==t&&(n=60*e),n};return d().createElement(wt.HasPermission,{FailureComponent:null,permission:"rule.add"},d().createElement(v.Button,{onClick:function(){return h(!0)},type:u,icon:d().createElement(p.Icon,{type:"plus"}),onClicksize:o},l?null:r("添加规则")),d().createElement(v.Modal,{title:r("添加规则"),destroyOnClose:!0,width:800,visible:f,footer:null,onCancel:function(){return h(!1)}},A?d().createElement(p.C,{is:"I18nSchemaForm",formKey:"creat-model",schema:A,onSubmit:function(e){var t,n,r,i,a,o,l="同数据报警"==(null==e?void 0:e.type)?"sameValueWarn":"长时间不上数报警"==(null==e?void 0:e.type)?"timeoutWarn":"",c={};l&&(c=s({},l,ta(ta({show:!0},e),{},{range:ta(ta({},null==e?void 0:e.range),{},{tags:null!=e&&null!==(r=e.range)&&void 0!==r&&null!==(i=r.tags)&&void 0!==i&&i.length?e.range.tags.map((function(e){return ta(ta({},e),{},{table:g().isPlainObject(null==e?void 0:e.table)?null==e?void 0:e.table:{id:null==e?void 0:e.table}})})):[]}),warnInterval:E(null==e||null===(a=e.warnIntervalObj)||void 0===a?void 0:a.count,null==e||null===(o=e.warnIntervalObj)||void 0===o?void 0:o.unit)})));var u=ta(ta({},e),{},{settings:c,range:ta(ta({},null==e?void 0:e.range),{},{tags:null!=e&&null!==(t=e.range)&&void 0!==t&&null!==(n=t.tags)&&void 0!==n&&n.length?e.range.tags.map((function(e){return ta(ta({},e),{},{table:g().isPlainObject(null==e?void 0:e.table)?null==e?void 0:e.table:{id:null==e?void 0:e.table}})})):[]})});y(u),h(!1),setTimeout((function(){return b()}),500)}}):null))};var ra;function ia(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function aa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ia(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ia(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var oa=function(t){var n,r=useI18n(),i=r.t,l=(r.i18n,t.input),c=l.value,s=(l.onChange,t.field),u=(s.name,s.schema),m=void 0===u?{}:u,f=a(d().useState({visible:!1,data:[]}),2),h=f[0],y=f[1];if(null!=m&&m.type)try{n=(0,e.use)("form",(function(e){var t,n;return{type:null==e||null===(t=e.values)||void 0===t||null===(n=t.range)||void 0===n?void 0:n.type}})).type}catch(e){console.log(e)}var b=[{title:i("数据点名称"),dataIndex:"name",key:"name"},{title:i("数据点标识"),dataIndex:"id",key:"id"}],A=function(e,t,n){var r,i,a,o=[],l=[];for(var c in e.length&&(r=null==e||null===(i=e[0])||void 0===i||null===(a=i[n])||void 0===a?void 0:a[t]),e){var s,u,d,m;null!=e&&null!==(s=e[c])&&void 0!==s&&null!==(u=s[n])&&void 0!==u&&u[t]&&((null==e||null===(d=e[c])||void 0===d||null===(m=d[n])||void 0===m?void 0:m[t])===r?l.push(e[c]):(r=e[c][n][t],o.push(l),l=[e[c]]))}return o.push(l),o};d().useEffect((function(){var e;if(!g().isEmpty(c)&&null!=c&&c.length&&n){var t=g().cloneDeep(c);"table"==n&&(e=A(t,"id","table")),"tableData"==n&&(e=A(t,"id","tableData"))}y(aa(aa({},h),{},{data:e}))}),[c,n]);var E=function(e){return h.data.map((function(t){var n,r;return d().createElement(v.Popover,{content:d().createElement(v.Table,{pagination:!1,dataSource:t,columns:b})},d().createElement("div",null,i("".concat(null==t||null===(n=t[0])||void 0===n||null===(r=n[e])||void 0===r?void 0:r.name,"数据点").concat(null==t?void 0:t.length,"个"))))}))};return d().createElement(d().Fragment,null,n?d().createElement(d().Fragment,null,d().createElement(v.Button,{onClick:function(){return y(aa(aa({},h),{},{visible:!0}))}},i("选择")),d().createElement(v.Modal,{visible:h.visible,width:"80%",onCancel:function(){return y(aa(aa({},h),{},{visible:!1}))},onOk:function(){return y(aa(aa({},h),{},{visible:!1}))}},"table"==n?d().createElement(p.C,o({is:"ModelPointTable",fullLable:!0,type:"checkbox",noComputed:!0},t)):null,"tableData"==n?d().createElement(p.C,o({is:"PointTable",fullLable:!0,type:"checkbox",noComputed:!0},t)):null),!g().isEmpty(h.data)&&h.data.length?d().createElement(v.Card,null,"table"==n?d().createElement(d().Fragment,null,E("table")):null,"tableData"==n?d().createElement(d().Fragment,null,E("tableData")):null):null):i("请先选择类型"))},la=function(e,t){var n=e;return"m"==t&&(n=60*e),n},ca=function(t){var n,r,i,a,o,l,c="同数据报警"==(null==t?void 0:t.type)?"sameValueWarn":"长时间不上数报警"==(null==t?void 0:t.type)?"timeoutWarn":"",u={};c&&(u=s({},c,aa(aa({show:!0},t),{},{range:aa(aa({},null==t?void 0:t.range),{},{tags:null!=t&&null!==(i=t.range)&&void 0!==i&&null!==(a=i.tags)&&void 0!==a&&a.length?t.range.tags.map((function(e){return aa(aa({},e),{},{table:g().isPlainObject(null==e?void 0:e.table)?null==e?void 0:e.table:{id:null==e?void 0:e.table}})})):[]}),warnInterval:la(null==t||null===(o=t.warnIntervalObj)||void 0===o?void 0:o.count,null==t||null===(l=t.warnIntervalObj)||void 0===l?void 0:l.unit)})));var d=aa(aa({},t),{},{settings:u,range:aa(aa({},null==t?void 0:t.range),{},{tags:null!=t&&null!==(n=t.range)&&void 0!==n&&null!==(r=n.tags)&&void 0!==r&&r.length?t.range.tags.map((function(e){return aa(aa({},e),{},{table:g().isPlainObject(null==e?void 0:e.table)?null==e?void 0:e.table:{id:null==e?void 0:e.table}})})):[]})});return(0,e.api)({name:"warning/rule/".concat(t.id)}).fetch("",{method:"PATCH",body:JSON.stringify(d)}).then((function(){return message.success("修改规则成功")}))};const sa={Rule:(ra={title:_r("报警规则管理"),type:"object",initQuery:!0,icon:d().createElement(p.Icon,{svg:n(817)}),name:"rule",resource:"warning/rule",permission:{view:!0},rolePermission:[{key:"rule.view",title:_r("查看")},{key:"rule.add",title:_r("添加")},{key:"rule.edit",title:_r("修改")},{key:"rule.delete",title:_r("删除")}],properties:{name:{type:"string",title:_r("规则名称"),width:180},type:{title:_r("规则类型"),type:"string",width:120,enum:["同数据报警","长时间不上数报警"]},description:{type:"string",title:_r("报警描述"),width:130},level:{type:"string",title:_r("报警级别"),enum:["低","中","高"]},warnType:{title:_r("报警类型")},warnIntervalObj:{title:_r("时长"),type:"object",properties:{count:{title:_r("数值"),type:"number"},unit:{title:_r("单位"),type:"string"}}},range:{title:_r("应用范围"),type:"object",properties:{type:{title:_r("数据点类型"),type:"string",enum:["table","tableData"],enum_title:[_r("设备表数据点"),_r("设备数据点")]},tags:{title:_r("数据"),type:"array",items:{}}},form:["*",{key:"type",component:function(e){var t=useI18n(),n=t.t,r=(t.i18n,e.input),i=r.onChange,a=r.value,o=(e.field,e.field),l=(o.key,o.option.form);return d().createElement(v.Radio.Group,{value:a,onChange:function(e){i(e.target.value),l.change("range",{type:e.target.value,tags:[]})},style:{marginRight:10}},d().createElement(v.Radio,{value:"table"},n("设备表")),d().createElement(v.Radio,{value:"tableData"},n("设备")))}},{key:"tags",component:function(e){return d().createElement(oa,o({},e,{field:aa(aa({},e.field),{},{schema:aa(aa({},e.field.schema),{},{logic:"type"})})}))}}]}},listFields:["name","type","range","description","level","warnType","warnIntervalObj","settings"],orders:{time:"DESC"},filters:{submenu:["name"]},fieldRender:{range:function(e){e.item;var t,n,r=e.value,i=e.inList,a=e.wrap,o=useI18n(),l=o.t,c=(o.i18n,[{title:l("数据点名称"),dataIndex:"name",key:"name"},{title:l("数据点标识"),dataIndex:"id",key:"id"}]);return"table"==(null==r?void 0:r.type)&&c.unshift({title:l("设备表名称"),dataIndex:"table",key:"table",render:function(e){return d().createElement(d().Fragment,null,null==e?void 0:e.name)}}),"tableData"==(null==r?void 0:r.type)&&c.unshift({title:l("设备名称"),dataIndex:"tableData",key:"tableData",render:function(e){return d().createElement(d().Fragment,null,null==e?void 0:e.name)}}),d().createElement(a,null,i?d().createElement(v.Popover,{placement:"topLeft",content:d().createElement(v.Table,{pagination:!1,dataSource:null==r?void 0:r.tags,columns:c})},d().createElement("div",null,l("数据点"),null==r||null===(t=r.tags)||void 0===t?void 0:t.length,l("个"))):d().createElement("div",null,l("数据点"),null==r||null===(n=r.tags)||void 0===n?void 0:n.length,l("个")))},warnType:function(t){var n=t.value,r=useI18n(),i=r.t,a=(r.i18n,(0,e.use)("settings").settings.warning),o=a&&a.warningkind||[];if(!n)return i("空");if(g().isString(n)){var l=o.filter((function(e){return e.id==n}))||[],c=l&&l.length>0?l[0].name:n;return c&&c.indexOf("-")>0?"":c||""}if(g().isArray(n)&&g().isArray(o)){var s=o.filter((function(e){return n.some((function(t){return t===e.id}))}));return null!=s&&s.length?s.map((function(e){return null==e?void 0:e.name})).join(","):""}},warnIntervalObj:function(e){var t=e.value,n=useI18n(),r=n.t,i=(n.i18n,{m:r("分钟"),s:r("秒")});return null!=t&&t.count&&null!=t&&t.unit?"".concat(null==t?void 0:t.count).concat(i[null==t?void 0:t.unit]):""}},components:{DataEmpty:function(e){return d().createElement(v.Empty,{description:_t1("暂无数据"),image:n(753)})},ListPage:function(t){var r=useI18n(),i=r.t,a=(r.i18n,(0,e.use)("model").model),o=(0,e.use)("model.transI18n",{model:a}).modelI18n;return d().createElement(Te.Model,{modelKey:"Rule",schema:o},d().createElement(p.Page,{title:d().createElement("span",null," ",d().createElement(p.Icon,{svg:n(817)}),i("报警规则管理")),actions:d().createElement(na,null)},d().createElement(Te.ModelBlock,{name:"model.list.submenu"}),d().createElement("div",{key:"model-list-subnav",style:{display:"flex",justifyContent:"space-between",marginBottom:".5rem"}},d().createElement(p.C,{is:"Model.Pagination"})," ",d().createElement(p.C,{is:"Model.ListSubMenu"})),d().createElement(p.C,{is:"Model.DataTable"}),d().createElement("div",{key:"model-list-downnav",style:{display:"flex",justifyContent:"space-between",marginTop:".5rem"}},d().createElement(p.C,{is:"Model.ActionBar"}),d().createElement(p.C,{is:"Model.Pagination"}))))},DataForm:function(t){return(0,e.use)("model.save",t).saveItem,t.id?d().createElement(p.C,o({is:"Model.TabsForm"},t,{saveItem:ca})):null}}},s(ra,"permission",{view:!0,add:!0,edit:!0,delete:!0}),s(ra,"projectFields",["name"]),s(ra,"required",["name","type","description","level","warnType","warnIntervalObj","range"]),s(ra,"form",["*","name","type","description","level",{key:"warnType",component:function(t){var n,r=t.field.schema,i=t.input,a=i.value,o=i.onChange,l=e.app.context.store.getState().settings,c=(null==l||null===(n=l.warning)||void 0===n?void 0:n.warningkind)||[];return d().createElement(v.Select,{mode:"multiple",value:a||void 0,style:{width:"100%"},placeholder:_t1(r.title)+"...",onChange:function(e){o(e)},options:c.map((function(e){return{label:e.name,value:e.id}}))})}},{key:"warnIntervalObj",component:function(e){var t=useI18n(),n=t.t,r=(t.i18n,e.input),i=r.value,a=r.onChange,o=[{key:n("分"),value:"m"},{key:n("秒"),value:"s"}];return d().createElement(v.Space,null,d().createElement(v.Input,{type:"number",min:1,style:{width:160},placeholder:n("数值"),onChange:function(e){return a(aa(aa({},i),{},{count:Number(e.target.value)}))},value:(null==i?void 0:i.count)||null,addonAfter:d().createElement(v.Select,{style:{width:75},onChange:function(e){return a(aa(aa({},i),{},{unit:e}))},value:null==i?void 0:i.unit},o.map((function(e){return d().createElement(v.Select.Option,{value:e.value},e.key)})))}))}},"range"]),s(ra,"itemActions",["edit","delete"]),ra)};var ua=["emptyComponent","items","activePage","maxButtons","changePage"];function da(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ma(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?da(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):da(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var pa=v.Layout.Content,fa=v.Layout.Sider,ga=function(e){var t=e.onAdd,n=e.children;return d().createElement(v.Button,{type:"primary",onClick:t},n)},va=function(t){var n,r=t.activeKey,i=t.setLevel,o=t.level,l=(t.types,t.typeObj,useI18n()),c=l.t,s=(l.i18n,(0,e.use)("model").atoms),u=a((0,Se.useRecoilState)(s.wheres),2),m=u[0],p=u[1],f=(null==m||null===(n=m.tabs)||void 0===n||n.filters,a(d().useState(o||"全部"),2)),h=f[0],y=f[1];return d().createElement(v.Radio.Group,{value:h,buttonStyle:"solid",onChange:function(e){y(e.target.value),i(e.target.value);var t="全部"==e.target.value?g().omit({type:{$regex:r}},["level"]):{level:e.target.value,type:{$regex:r}};"xcl"==r&&(t=g().omit(ma(ma({},t),{},{handle:!0}),["type"])),"quanbu"==r&&(t=g().omit(ma({},t),["type","handle"])),p({tabs:t})}},["全部","高","中","低"].map((function(e){return d().createElement(v.Radio.Button,{value:e},c(e))})))},ha=function(t){var n,r=(0,e.use)("model").model,i=(0,e.use)("model.permission").canAdd,a=(0,e.use)("model.event").onAdd,o=(0,e.use)("settings").settings,l=null==o?void 0:o.warning,c=(null==o||null===(n=o.warning)||void 0===n?void 0:n.warningkind)||[],s=g().clone(c);s.unshift({name:"需处理报警",id:"xcl",show:!0}),l&&l.show_all&&s.unshift({name:"全部报警",id:"quanbu",show:!0}),l&&l.show_recovery&&s.splice(1,0,{name:"报警恢复",id:"huifu",show:!0});var u,m=r.title,f=r.icon||r.name;return g().isString(f)&&(f=d().createElement(p.Icon,{name:f})),d().createElement(p.Page,{className:"xadmin-model-list-".concat(r.key),title:d().createElement("span",null,f," ",m),subTitle:d().createElement(Te.ModelBlock,{name:"model.list.nav"}),actions:(u=r.components&&r.components.AddButton||(0,p.C)("Model.AddButton")||ga,d().createElement(d().Fragment,null,d().createElement(Te.ModelBlock,{name:"model.list.navbtn"}),i?d().createElement(u,{onAdd:a},d().createElement(p.Icon,{name:"plus"})," ",(0,hn._t)("Add {{object}}",{object:r.title})):null))},d().createElement(Te.ModelBlock,{name:"model.list.submenu"}),s&&s.length>0?d().createElement(Aa,{types:s}):d().createElement(Te.Model,{name:"Warning",modelKey:"Warning"},d().createElement(Te.ModelBlock,{name:"model.list.sidemenu"},(function(e){return d().createElement(Te.ModelBlock,{name:"model.list.sidepanel"},(function(t){return e||t?d().createElement(v.Layout,null,e?d().createElement(fa,{width:200,style:{backgroundColor:"transparent",marginRight:".5rem"}},e):null,d().createElement(pa,null,ba),t?d().createElement(fa,{width:200,style:{backgroundColor:"transparent",marginLeft:".5rem"}},t):null):ba}))}))))},ya=function(t){var n=(0,e.use)("model.pagination",t),r=(n.emptyComponent,n.items),i=n.activePage,a=(n.maxButtons,n.changePage),l=x(n,ua);return 0==r?null:d().createElement(v.Pagination,o({showQuickJumper:r>10,current:i,size:"sm"==t.size?"small":"",className:t.className,pageSize:1,total:r,onChange:a},l))},ba=function(e){var t=e.types,n=e.level,r=e.activeKey,i=e.setLevel,a=e.typeObj;return[d().createElement("div",{key:"model-list-subnav",style:{display:"flex",justifyContent:"space-between",marginBottom:".5rem"}},d().createElement(va,{style:{marginLeft:20},typeObj:a,types:t,level:n,activeKey:r,setLevel:i}),d().createElement(p.C,{is:"Model.ListSubMenu"})),d().createElement(_n,null),d().createElement("div",{key:"model-list-downnav",style:{display:"flex",justifyContent:"space-between",marginTop:".5rem"}},d().createElement(p.C,{is:"Model.ActionBar"}),d().createElement(ya,{showSizeChanger:!1}))]},Aa=function(t){var n,r=t.types,i=a(d().useState(null),2),o=(i[0],i[1],a(d().useState(r[0].id||null),2)),l=o[0],c=o[1],s=(0,e.use)("model"),u=s.atoms,m=s.model,f=a((0,Se.useRecoilState)(u.wheres),2),h=f[0],y=f[1],b=a((0,Se.useRecoilState)(u.fields),2),A=b[0],E=b[1],w=(0,Se.useSetRecoilState)(u.limit),C=(0,Se.useSetRecoilState)(u.order),x=(0,Se.useSetRecoilState)(u.skip);A=A||(null==m?void 0:m.listFields);var B=null==h||null===(n=h.tabs)||void 0===n?void 0:n.filters,k=a(d().useState("全部"),2),O=k[0],S=k[1],_=a(d().useState(r[0]),2),j=_[0],P=_[1],D=a(d().useState(r.filter((function(e){return e&&e.show}))),2),I=D[0];return D[1],d().useEffect((function(){var e={};h&&"{}"==JSON.stringify(h)?(e={tabs:{handle:!0}},j&&"全部报警"==j.name?e={tabs:{}}:j&&"需处理报警"==j.name?e={tabs:{handle:!0}}:j&&"报警恢复"==j.name&&(e={tabs:{recoveryTime:{$exists:!0}}})):((e=h||{})&&e.tabs&&e.tabs.level&&S(e.tabs.level),e&&e.tabs&&e.tabs.handle&&c("xcl"),e&&e.tabs&&e.tabs.type&&c(e.tabs.type));var t=g().cloneDeep(A),n=t.indexOf("recoveryTime");"huifu"!=l?n>-1&&t.splice(n,1):-1==n&&t.splice(1,0,"recoveryTime"),x(0),w(15),C({time:"DESC"}),E(t),y(ma({},e))}),[]),I?d().createElement(v.Tabs,{activeKey:l,onChange:function(e){if(e){var t=g().omit(ma(ma({},B||{}),{},{type:{$regex:e}}),["level"])||{},n=g().find(I,(function(t){return t.id==e})),r=g().cloneDeep(A),i=r.indexOf("recoveryTime");"huifu"!=e?i>-1&&(r.splice(i,1),delete t.recoveryTime):-1==i&&r.splice(1,0,"recoveryTime"),S("全部"),P(n),c(e),n&&"需处理报警"==n.name?y({tabs:g().omit(ma(ma({},t),{},{handle:!0}),["type"])}):n&&"全部报警"==n.name?y({tabs:g().omit(ma({},t),["type","handle"])}):n&&"报警恢复"==n.name?y({tabs:g().omit(ma(ma({},t),{},{recoveryTime:{$exists:!0}}),["type"])}):y({tabs:g().omit(ma({},t),["handle"])})}}},I&&I.map((function(e,t){return d().createElement(v.Tabs.TabPane,{key:e&&e.id,tab:e&&e.name},d().createElement(Te.ModelBlock,{name:"model.list.sidemenu"},(function(e){return d().createElement(Te.ModelBlock,{name:"model.list.sidepanel"},(function(t){return e||t?d().createElement(v.Layout,null,e?d().createElement(fa,{width:200,style:{backgroundColor:"transparent",marginRight:".5rem"}},e):null,d().createElement(pa,null,d().createElement(ba,{typeObj:j,types:I,level:O,activeKey:l,setLevel:S})),t?d().createElement(fa,{width:200,style:{backgroundColor:"transparent",marginLeft:".5rem"}},t):null):d().createElement(ba,{typeObj:j,types:I,activeKey:l,level:O,setLevel:S})}))})))}))):d().createElement(p.Loading,null)};var Ea=function(t){var n=t.item,r=(0,e.use)("model"),i=(r.modelDispatch,r.atoms,(0,e.use)("model.getItems").getItems),a=useI18n(),o=a.t;return a.i18n,d().createElement(v.Button,{type:"primary",onClick:function(){n&&n.id&&(0,e.api)({name:"warning"}).fetch("/warning/archive/restore/".concat(n.id),{method:"PATCH"}).then((function(e){e.json,v.message.success(o("恢复成功")),i()}))}},o("恢复"))},wa=function(t){var n=(0,e.use)("model"),r=(n.modelDispatch,n.atoms),i=(0,e.use)("model.select").selected,a=(0,Se.useSetRecoilState)(r.selected),o=(0,e.use)("model.getItems").getItems,l=i&&!g().isEmpty(i);return d().createElement(v.Button,{type:"primary",onClick:function(){l&&Promise.all(i.map((function(t){return(0,e.api)({name:"warning"}).fetch("/warning/archive/restore/".concat(t.id),{method:"PATCH"}).then((function(e){return e.json}))}))).then((function(e){v.message.success(_t1("批量恢复成功")),a([]),o()}))},style:{margin:"5px 10%",width:"80%"},disabled:!l},_t1("批量恢复报警"))},Ca=function(t){var n=useI18n(),r=n.t,i=(n.i18n,(0,e.use)("model")),a=(i.modelDispatch,i.atoms),o=(0,e.use)("model.select").selected,l=(0,Se.useSetRecoilState)(a.selected),c=(0,e.use)("model.getItems").getItems,s=o&&!g().isEmpty(o);return d().createElement(v.Button,{type:"primary",onClick:function(){s&&Promise.all(o.map((function(t){return(0,e.api)({name:"warning"}).fetch("/warning/".concat(t.id,"?archive=true"),{method:"DELETE"}).then((function(e){return e.json}))}))).then((function(e){v.message.success(r("批量删除成功")),l([]),c()}))},style:{margin:"5px 10%",width:"80%"},disabled:!s},r("批量删除报警"))};const xa={WarningArchive:{title:_r("报警归档信息"),type:"object",initQuery:!1,userPageFields:!0,noLocalStorageFilter:!0,forceGetItem:!0,icon:d().createElement(d().Fragment,null,d().createElement(J.ArrowLeftOutlined,{onClick:function(){return history.back()}}),d().createElement(p.Icon,{svg:n(458)})),name:"warningarchive",resource:"warning/warning/archive",permission:{view:!0},rolePermission:[{key:"warningarchive.view",title:_r("查看")},{key:"warningarchive.add",title:_r("添加")},{key:"warningarchive.edit",title:_r("修改")},{key:"warningarchive.delete",title:_r("删除")},{key:"warningarchive.onearchive",title:_r("一键归档")}],properties:{id:{type:"string",title:_r("报警ID"),width:180},table:{title:_r("设备表"),type:"object",fieldType:"table",properties:{title:{type:"string",title:_r("表名称")}},width:120},department:{type:"array",title:_r("所属部门"),fieldType:"tableData",field:{func:"dataAuth",style:{minWidth:130},placeholder:_r("选择部门")},items:{},width:130,related:"department"},tableData:{title:_r("设备"),type:"object",fieldType:"tableData",properties:{warning:{type:"object",properties:{}},name:{type:"string",title:_r("名称"),fieldType:"node-link"},uid:{type:"string",title:_r("编号"),fieldType:"node-link"}},width:130},time:{type:"string",format:"date-time",title:_r("报警时间"),width:180},tableDataId:{type:"string",title:_r("设备编号"),width:100},type:{type:"string",title:_r("报警类型"),width:100},processed:{type:"string",title:_r("处理动作"),enum:["未处理","已处理"],enumColor:["warning","success"],width:95},status:{type:"string",title:_r("确认动作"),enum:["未确认","已确认"],enumColor:["warning","success"],width:95},desc:{type:"string",title:_r("报警描述"),width:200},remark:{type:"string",title:_r("报警处理"),width:250},level:{type:"string",title:_r("级别"),enum:["低","中","高"],width:70},confirmTime:{type:"string",format:"date-time",title:_r("确认时间"),width:200},confirmUser:{type:"object",title:_r("确认人"),relateTo:"User",properties:{},width:100},handleTime:{type:"string",format:"date-time",title:_r("处理时间"),width:200},handleUser:{type:"object",title:_r("处理人"),relateTo:"User",properties:{},width:100},fields:{type:"array",title:_r("报警数值"),items:{title:_r("数值"),type:"object",properties:{}},width:180}},listFields:["time","table","tableData","department","fields","level","type","confirmUser","confirmTime","handleTime","handleUser","desc","remark"],orders:{time:"DESC"},filters:{nav:["id","time","table","department","tableData","tableDataId","confirmUser","desc"],submenu:["id","level","status","processed","time","tableDataId","desc"]},fieldRender:{fields:st,type:function(t){var n,r=t.value,i=(0,e.use)("settings").settings,a=useI18n(),o=a.t,l=(a.i18n,(null==i||null===(n=i.warning)||void 0===n?void 0:n.warningkind)||[]);if(!r)return o("空");if(g().isString(r)){var c=l.filter((function(e){return e.id==r}))||[],s=c&&c.length>0?c[0].name:r;return s&&s.indexOf("-")>0?"":s||""}if(g().isArray(r)&&g().isArray(l)){var u=l.filter((function(e){return r.some((function(t){return t===e.id}))}));return null!=u&&u.length?u.map((function(e){return null==e?void 0:e.name})).join(","):""}},table:function(e){var t,n,r,i=e.item,a=useI18n(),o=a.t;return a.i18n,(null==i||null===(t=i.table)||void 0===t?void 0:t.title)||(null==i||null===(n=i.table)||void 0===n?void 0:n.name)||(null==i||null===(r=i.table)||void 0===r?void 0:r.id)||o("空")},department:function(e){var t,n=e.item,r=null==n||null===(t=n.tableData)||void 0===t?void 0:t._department;return g().isEmpty(r)||!g().isPlainObject(r)||g().isEmpty(Object.values(r))?_t1("空"):g().flattenDeep(Object.values(r)).map((function(e){return null==e?void 0:e.name})).join("")},tableDataId:function(e){var t,n,r=e.item,i=useI18n(),a=i.t;i.i18n,(null==r||null===(t=r.tableData)||void 0===t?void 0:t.uid)||(null==r||null===(n=r.tableData)||void 0===n?void 0:n.id)||a("空")}},components:{DataEmpty:function(e){return d().createElement(v.Empty,{description:_t1("暂无数据"),image:n(753)})},ListPage:function(e){return d().createElement(Vt,null,d().createElement(ha,e))},AddButton:function(){return null}},projectFields:["tableData._settings","status","processed","tableDataId","handle"],form:["*"],itemActions:[function(e){var t=e.item;return d().createElement(Ea,{item:t})},function(e){var t=e.item;return d().createElement($n,{item:t})},function(t){var n=t.item,r=useI18n(),i=r.t;return r.i18n,!!n.tableData&&d().createElement(v.Button,{onClick:function(){var t,r;return e.app.go("/app/table/".concat(null==n||null===(t=n.table)||void 0===t?void 0:t.id,"/").concat(null==n||null===(r=n.tableData)||void 0===r?void 0:r.id,"/edit"))}},i("设备"))}],batchActions:[function(e){return d().createElement(wa,e)},function(e){return d().createElement(Ca,e)}],batchChangeFields:["status","processed"],refresh:{submenu:[3,5,10]},defaultPageSize:15}},Ba={tRecord:{title:_r("设备配置信息"),type:"object",initQuery:!1,userPageFields:!0,noLocalStorageFilter:!0,icon:React.createElement(p.Icon,{svg:n(458)}),name:"record",resource:"core/t/record",properties:{tableInfo:{title:_r("设备表"),type:"object",fieldType:"table",properties:{}},tableData:{title:_r("设备"),type:"object",fieldType:"tableData",properties:{}},status:{title:_r("状态"),type:"string",width:80},connectTime:{title:_r("通信时间"),type:"string",width:250,format:"date-time"},online:{title:_r("在线"),type:"boolean",width:80,boolLabel:["在线","掉线"]}},listFields:["tableInfo","tableData","status","connectTime","online"],orders:{time:"DESC"},fieldRender:{tableData:function(e){var t,n,r=e.item,i=useI18n(),a=i.t;return i.i18n,(null==r||null===(t=r.tableData)||void 0===t?void 0:t.name)||(null==r||null===(n=r.tableData)||void 0===n?void 0:n.id)||a("空")},tableInfo:function(e){var t,n,r,i=e.item,a=useI18n(),o=a.t;return a.i18n,(null==i||null===(t=i.tableInfo)||void 0===t?void 0:t.title)||(null==i||null===(n=i.tableInfo)||void 0===n?void 0:n.name)||(null==i||null===(r=i.tableInfo)||void 0===r?void 0:r.id)||o("空")}},form:["*"],itemActions:["delete"]}};t().use(Qi).use(Oe).use({models:sa}).use({models:xa}).use({models:Ba})})()})();
//# sourceMappingURL=index.js.map